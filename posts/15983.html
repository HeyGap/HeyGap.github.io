<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Angr Learning Note | HeyGap's_Blog</title><meta name="author" content="HeyGap"><meta name="copyright" content="HeyGap"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="è¿ˆå‘è‡ªåŠ¨åŒ–çš„ç¬¬äºŒæ­¥â€”â€”">
<meta property="og:type" content="article">
<meta property="og:title" content="Angr Learning Note">
<meta property="og:url" content="http://heygap.github.io/posts/15983.html">
<meta property="og:site_name" content="HeyGap&#39;s_Blog">
<meta property="og:description" content="è¿ˆå‘è‡ªåŠ¨åŒ–çš„ç¬¬äºŒæ­¥â€”â€”">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://heygap.github.io/img/cover8.jpg">
<meta property="article:published_time" content="2023-10-20T04:16:00.000Z">
<meta property="article:modified_time" content="2025-02-12T10:09:13.098Z">
<meta property="article:author" content="HeyGap">
<meta property="article:tag" content="SymbolicExecution">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://heygap.github.io/img/cover8.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Angr Learning Note",
  "url": "http://heygap.github.io/posts/15983.html",
  "image": "http://heygap.github.io/img/cover8.jpg",
  "datePublished": "2023-10-20T04:16:00.000Z",
  "dateModified": "2025-02-12T10:09:13.098Z",
  "author": [
    {
      "@type": "Person",
      "name": "HeyGap",
      "url": "http://heygap.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/avatar.jpg"><link rel="canonical" href="http://heygap.github.io/posts/15983.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"æœªæ‰¾åˆ°ç¬¦åˆæ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}","hits_stats":"å…±æ‰¾åˆ° ${hits} ç¯‡æ–‡ç« "}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ä¸­"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"å·²åˆ‡æ¢ä¸ºç¹ä½“ä¸­æ–‡","cht_to_chs":"å·²åˆ‡æ¢ä¸ºç®€ä½“ä¸­æ–‡","day_to_night":"å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Angr Learning Note',
  isHighlightShrink: true,
  isToc: true,
  pageType: 'post'
}</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">åŠ è½½ä¸­...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load', preloader.endLoading)

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/background1.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">33</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">25</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">12</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> æˆ‘çš„æ–‡ç« </span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> å½’æ¡£</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/air-conditioner/"><i class="fa-fw anzhiyu-icon-fan"></i><span> å°ç©ºè°ƒ</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-user"></i><span> å…³äºæœ¬äºº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/cover8.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">HeyGap's_Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Angr Learning Note</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> æˆ‘çš„æ–‡ç« </span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> å½’æ¡£</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/air-conditioner/"><i class="fa-fw anzhiyu-icon-fan"></i><span> å°ç©ºè°ƒ</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-user"></i><span> å…³äºæœ¬äºº</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Angr Learning Note</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-10-20T04:16:00.000Z" title="å‘è¡¨äº 2023-10-20 12:10:00">2023-10-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2025-02-12T10:09:13.098Z" title="æ›´æ–°äº 2025-02-12 18:02:09">2025-02-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Software-analysis-technology/">Software analysis technology</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">æ€»å­—æ•°:</span><span class="word-count">2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>7åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><blockquote class="blockquote-center">
è¿ˆå‘è‡ªåŠ¨åŒ–çš„ç¬¬äºŒæ­¥â€”â€”
</blockquote>
<span id="more"></span>
<h1 id="xff-reference">0xFF Reference</h1>
<p><a href="https://heygap.github.io/2023/09/30/blog9/#more">1. Symbolic
Execution Leaning Note (1) -- Basis</a><br />
<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/7117#toc-22">2.
2020å¹´Angr-Apiéå®˜æ–¹ä»‹ç»</a><br />
<a
target="_blank" rel="noopener" href="https://github.com/jakespringer/angr_ctf/blob/master/SymbolicExecution.pptx">3.
angr_ctfé‡Œä»‹ç»angrçš„ppt(è®²çš„çœŸçš„æŒºå¥½çš„)</a></p>
<h1 id="x00-recall-symbolic-execution">0x00 Recall-Symbolic
Execution</h1>
<p>ç¬”è€…æ°´å¹³æœ‰é™ï¼Œå¦‚æœ‰é”™è¯¯è¯·æŒ‡å‡º ;-)</p>
<p>æˆ‘ä»¬å…ˆå›é¡¾ä¸€ä¸‹ä»€ä¹ˆæ˜¯ç¬¦å·æ‰§è¡Œï¼š<br />
æˆ‘ä»¬åœ¨é€†å‘ä¸€ä¸ªç¨‹åºã€å»æ‰¾ä¸€ä¸ªç¨‹åºçš„æ¼æ´æ—¶ï¼Œæˆ‘ä»¬ä¼šå¸Œæœ›æ‰¾åˆ°ä¸€ä¸ª<code>input</code>,æ¥è§¦å‘æˆ‘ä»¬éœ€è¦çš„æ¼æ´æˆ–è€…æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„flagï¼Œè€Œç¬¦å·æ‰§è¡Œçš„åŠŸèƒ½å°±æ˜¯<strong>é€šè¿‡éå†ç¨‹åºæ‰€æœ‰å¯èƒ½çš„â€œçŠ¶æ€(State)â€ï¼Œæ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„Stateï¼Œè¿›è€Œé€šè¿‡çº¦æŸæ±‚è§£å™¨ï¼Œæ±‚è§£å‡ºæˆ‘ä»¬æœ€åéœ€è¦çš„input</strong></p>
<p>å®è§‚ä¸Šçœ‹ï¼Œç¬¦å·æ‰§è¡Œå¯ä»¥åˆ†ä¸º<code>ä¸‰æ­¥</code><br />
1. æ³¨å…¥ç¬¦å· 2. åˆ†æ”¯ 3. æ‰§è¡Œåˆ†æ”¯</p>
<p>æˆ‘ä»¬ç”¨ä¸€ä¸ªç®€å•çš„å‡½æ•°æ¥åˆ†åˆ«çœ‹ä¸€ä¸‹è¿™ä¸‰æ­¥æ˜¯ä»€ä¹ˆ <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// demo func</span><br><span class="line"></span><br><span class="line">Line1  void check_func(char* passwd)</span><br><span class="line">Line2  &#123;</span><br><span class="line">Line3      if(passwd == &quot;HeyGap&quot;)</span><br><span class="line">Line4          printf(&quot;Access granted&quot;);</span><br><span class="line">Line5      else</span><br><span class="line">Line6          printf(&quot;Access denied&quot;);</span><br><span class="line">Line7  &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="æ³¨å…¥ç¬¦å·inject-symbols">1. æ³¨å…¥ç¬¦å·(Inject Symbols)</h3>
<ul>
<li>ä»€ä¹ˆæ˜¯æ³¨å…¥ç¬¦å·ï¼Ÿ<br />
æˆ‘ä»¬åœ¨<code>å…·ä½“æ‰§è¡Œ</code>çš„æ—¶å€™ï¼Œä¼ å…¥çš„passwdæ˜¯ä¸€ä¸ªå…·ä½“çš„å­—ç¬¦ä¸²ï¼›å¯æˆ‘ä»¬åœ¨<code>ç¬¦å·æ‰§è¡Œ</code>æ—¶ï¼Œä¼ å…¥çš„æ˜¯ä¸€ä¸ª<code>ç¬¦å·</code>ã€‚</li>
<li>ä»€ä¹ˆæ˜¯ç¬¦å·ï¼Ÿ
ç±»æ¯”äºæˆ‘ä»¬å°å­¦å­¦çš„æ–¹ç¨‹<code>x + 1 = 2</code>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™æ ·ä¸€ä¸ªæ–¹ç¨‹æ¥æ±‚è§£å‡ºå˜é‡xï¼Œæˆ‘ä»¬ä¹Ÿç§°â€œè¿™ä¸ªæ–¹ç¨‹çº¦æŸäº†è¿™ä¸ªå˜é‡xâ€ï¼›è€Œ<code>ç¬¦å·</code>å°±æ˜¯æ–¹ç¨‹ä¸­çš„<code>å˜é‡</code>ï¼Œç”¨æ¥çº¦æŸç¬¦å·çš„<code>æ‰§è¡Œè·¯å¾„</code>å°±å¯ä»¥ç±»æ¯”æˆ<code>æ–¹ç¨‹</code></li>
<li>ä»€ä¹ˆæ˜¯æ‰§è¡Œè·¯å¾„ï¼Ÿ<br />
ä»State_Aåˆ°State_Bçš„<code>æ‰§è¡Œè·¯å¾„</code>å°±æ˜¯<strong>ä»èµ·ç‚¹Aå¯ä»¥æ‰§è¡Œåˆ°ç»ˆç‚¹Bçš„ä¸€æ¡æŒ‡ä»¤(instructions)è·¯å¾„</strong>,åœ¨æ¯æ¡æ‰§è¡Œè·¯å¾„ä¸­éƒ½ä¼šç»´æŠ¤ä¸€ä¸ªç¬¦å·å˜é‡<code>pc</code>ï¼Œpcè®°å½•äº†â€œä»Aç‚¹å‡ºå‘ï¼Œè¦åˆ°è¾¾Bçš„å…¨éƒ¨æ¡ä»¶â€ï¼Œè¿™ä¸ªç¬¦å·å˜é‡çš„ç±»å‹æ˜¯é€»è¾‘è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªç¬¦å·å˜é‡æ‰”åˆ°SMTæ±‚è§£å™¨ï¼ˆæ¯”å¦‚z3ï¼‰ä¸­å»æ±‚è§£æ»¡è¶³è¿™ä¸ªç¬¦å·å˜é‡ä¸­æ‰€æœ‰çº¦æŸæ¡ä»¶çš„1~nä¸ªè§£</li>
<li>Example<br />
åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ªç¬¦å·ä¼ å…¥passwdä¸­ï¼Œå°±æ˜¯æ³¨å…¥ç¬¦å·ã€‚</li>
</ul>
<h3 id="åˆ†æ”¯branching">2. åˆ†æ”¯(Branching)</h3>
<ul>
<li>ä»€ä¹ˆæ˜¯branching<br />
ç”±äºæˆ‘ä»¬çš„ç¬¦å·æ˜¯ä¸€ä¸ªå¾…ç¡®å®šçš„å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨é‡åˆ°<code>åˆ¤æ–­è¯­å¥</code>æ—¶ï¼Œå½“å‰çš„Stateä¼šè®¾ç½®ä¸ºæ‰§è¡Œå®Œæ¯•(already
executed)ï¼Œç„¶åæ¿€æ´»(active)ä¸¤ä¸ªæ–°çš„stateï¼Œç”±äºè¦éå†å…¨éƒ¨stateï¼Œç¬¦å·åœ¨åˆ¤æ–­è¯­å¥ä¸­å¾—åˆ°ä¸åŒè¿”å›å€¼ï¼Œè€Œè¿™ä¸¤ä¸ªstateå°±æ˜¯ä¸åŒè¿”å›å€¼è¿›å…¥çš„ä¸åŒåˆ†æ”¯çš„èµ·å§‹çŠ¶æ€</li>
<li>Example
åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œå¯ä»¥ç†è§£ä¸ºLine1-2ä¸ºstate1ï¼Œå½“æ‰§è¡Œåˆ°Line3æ—¶ï¼Œstate1è®¾ç½®ä¸ºæ‰§è¡Œå®Œæ¯•ï¼ŒåŒæ—¶æ¿€æ´»state2å’Œstate3ï¼Œstate2ä¸ºLine4ï¼Œstate3ä¸ºLine6</li>
</ul>
<h3 id="è¯„ä¼°åˆ†æ”¯evaluate-each-branches">3. è¯„ä¼°åˆ†æ”¯(Evaluate Each
Branches)</h3>
<ul>
<li>ä»€ä¹ˆæ˜¯Evaluate Branchesï¼Ÿ<br />
æˆ‘ä»¬ä¼šè¯„ä¼°(Evaluate)æ¯ä¸€ä¸ªactiveçš„stateï¼Œåˆ¤æ–­ä»–ä»¬æ˜¯å¦ç¬¦åˆæˆ‘ä»¬çš„éœ€æ±‚ï¼Œå¦‚æœä¸æ»¡è¶³å°±è®¾ç½®terminatedï¼Œå¦‚æœé‡åˆ°åˆ¤æ–­è¯­å¥å°±è¿›å…¥ç¬¬äºŒæ­¥</li>
<li>Example
å‡è®¾å½“å‰æ¿€æ´»çš„stateä¸º2å’Œ3ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦â€œæ ‡å‡†è¾“å‡ºä¸­åŒ…å«'granted'â€ï¼Œé‚£ç¬¦å·æ‰§è¡Œå™¨å°±ä¼šè¯„ä¼°state2ï¼Œå‘ç°è¿™ä¸ªstateç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ï¼Œäºæ˜¯å°†state2åŠ åˆ°foundæ•°ç»„ä¸­ï¼›ç„¶åå†è¯„ä¼°state3ï¼Œå‘ç°ä¸ç¬¦åˆï¼Œè®¾ç½®ä¸ºterminated</li>
</ul>
<h1 id="x01-an-introduction-to-angr">0x01 An Introduction to Angr</h1>
<h3 id="å‡ºç°çš„class">1. å‡ºç°çš„class</h3>
<p>ç¬”è€…åœ¨æ­¤è®°å½•ç›¸å¯¹é‡è¦çš„classï¼Œè¯»è€…å¯ä»¥é€šè¿‡é˜…è¯»æºç æˆ–å®˜æ–¹æ‰‹å†Œç­‰æ–¹å¼ï¼Œå…ˆå¼„æ¸…æ¥šè¿™äº›classçš„ä½œç”¨
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SimState</span><br><span class="line">Simulation Manager(simgr)</span><br></pre></td></tr></table></figure></p>
<h3 id="symbolic-execution-in-angr">2. Symbolic Execution In Angr</h3>
<p>é€šè¿‡0x00ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨ç¬¦å·æ‰§è¡Œä¸­ï¼Œ<code>æ‰§è¡Œè·¯å¾„</code>å’Œ<code>ç¬¦å·</code>æ˜¯æœ€é‡è¦çš„ä¸¤ä¸ªä¸œè¥¿
- Angrä¸­çš„æ‰§è¡Œè·¯å¾„<br />
1.
æˆ‘ä»¬çŸ¥é“æ¯branchä¸€æ¬¡ï¼Œå°±ä¼šæ·»åŠ ä¸¤ä¸ªstateï¼Œè€Œåœ¨Angrä¸­ï¼Œç»´æŠ¤è·¯å¾„ä¿¡æ¯çš„pcç”±<code>SimState</code>
Objectç»„æˆï¼ŒSimStateç”¨âˆ©é“¾åœ¨ä¸€èµ·å°±ç»„æˆäº†pc 2.
ç”±äºæˆ‘ä»¬è¦éå†å…¨éƒ¨stateï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªç®¡ç†å™¨æ¥ç®¡ç†å…¨éƒ¨æ‰§è¡Œè·¯å¾„(a
Set of
Path)ï¼Œè¿™ä¸ªç®¡ç†å™¨å°±æ˜¯<code>Simulation Manager (simgr)</code>,ä¸‹å›¾ä¸ºAngrä¸­ç”Ÿæˆå…¨éƒ¨è·¯å¾„çš„è¿‡ç¨‹
<img src="/pic/1.png" /> 3.
ä¸Šå›¾æåˆ°<code>until we find what we want</code>ï¼Œsimgræä¾›äº†å‡½æ•°<code>explore</code>ï¼Œå¯ä»¥è®©æˆ‘ä»¬é€šè¿‡ä¸¤ç§æ–¹å¼æ¥æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„state<br />
1. é€šè¿‡æŒ‡ä»¤åœ¨textæ®µçš„åœ°å€ 2. é€šè¿‡ä»»æ„ä½“ç°stateç‰¹å¾çš„å‡½æ•°</p>
<ul>
<li>State Explosion
<ol type="1">
<li>ä½†æ˜¯å•çº¯çš„éå†æ¯ä¸€æ¡è·¯å¾„ä¼šå­˜åœ¨çŠ¶æ€çˆ†ç‚¸(State
Explosionï¼Œæœ‰äº›åœ°æ–¹ä¹Ÿå«è·¯å¾„çˆ†ç‚¸)çš„é—®é¢˜ï¼Œæ¥çœ‹ä¸‹é¢è¿™ä¸ªå¾ªç¯
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> xï¼›</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="number">0</span>;i&lt;<span class="number">100</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(x &gt; <span class="number">10</span>)</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;Good&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;Wrong&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>å½“i=1æ—¶ï¼Œç®¡ç†å™¨ä¼šåˆ›å»ºä¸¤ä¸ªstateï¼Œè€Œi=2æ—¶ï¼Œå…ˆå‰çš„ä¸¤ä¸ªstateæœ‰åˆ†åˆ«ä¼šåˆ›å»ºä¸¤ä¸ªstateï¼Œå½“i=100æ—¶ï¼Œæˆ‘ä»¬å°±ä¼šå‡ºç°2^100ä¸ªstateï¼Œè¿™å°±æ˜¯çŠ¶æ€çˆ†ç‚¸é—®é¢˜</li>
<li>è€Œexploreä¹Ÿä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå‚æ•°avoidï¼Œæ•ˆæœå°±æ˜¯<code>å‰ªæ</code>ï¼Œåœ¨exploreä¸­æ·»åŠ avoidå‚æ•°ä¼šå¸®åŠ©æˆ‘ä»¬æå‰terminateé‚£äº›æˆ‘ä»¬ä¸éœ€è¦çš„stateï¼Œå› æ­¤è¿™ä¸ªstateåç»­çš„branchå°±ä¸ä¼šå†è·Ÿè¿›</li>
</ol></li>
</ul>
<h1 id="x01-åº“æ¶æ„åˆ†æ">0x01 åº“æ¶æ„åˆ†æ</h1>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">angr</span><br><span class="line"> | - Project()</span><br><span class="line">		 | - factory</span><br><span class="line">				 | - state</span><br><span class="line">					   | - entry_state()</span><br><span class="line">					   | - blank_state(addr)</span><br><span class="line"></span><br><span class="line">					   | - regs.eax/ebx/...</span><br><span class="line">					   | - solver</span><br><span class="line">							  | - BVS</span><br><span class="line">							  | - eval</span><br><span class="line">					   | - fs</span><br><span class="line">						    | - insert(string filename,angr.storage.SimFile())</span><br><span class="line">				 | - simulation_manager(init_state)</span><br><span class="line">						 | - explore(find,avoid)</span><br><span class="line">						 | - found[]</span><br><span class="line"></span><br><span class="line"> | - storage</span><br><span class="line">		 | - SimFile(filename,content,size)</span><br><span class="line"> | - sim_options</span><br><span class="line">		 | - SYMBOL_FILL_UNCONSTRAINED_MEMORY</span><br><span class="line">		 | - SYMBOL_FILL_UNCONSTRAINED_REGISTERS</span><br><span class="line"></span><br><span class="line">found_state</span><br><span class="line">	 | - posix</span><br><span class="line">		   | - dumps(std)</span><br><span class="line">	 | - solver</span><br><span class="line">		   | - eval(claripy.BVS pass,cast_to)</span><br></pre></td></tr></table></figure>
<h1 id="x02-apiæ‰‹å†Œ">0x02 APIæ‰‹å†Œ</h1>
<ul>
<li><strong>Projectç±»(å‚æ•°ã€åŠŸèƒ½ã€é‡è½½ã€è¿”å›å€¼)</strong>
<ol type="1">
<li>æ„é€ å‡½æ•°å‚æ•°ï¼šâ€œå‘½ä»¤è¡Œä¸­è¿è¡Œç¨‹åºçš„æŒ‡ä»¤â€(eg: "./00_angr_find")</li>
<li>åŠŸèƒ½ï¼šâ€œæ„å»ºä¸€ä¸ªç¬¦å·æ‰§è¡Œé¡¹ç›®â€</li>
<li>é™„å±æˆå‘˜
<ul>
<li><strong>factory</strong>
<ol type="1">
<li>é™„å±æˆå‘˜
<ul>
<li><strong>state</strong>
<ol type="1">
<li>é‡è½½å‡½æ•°
<ul>
<li><strong>entry_state()</strong>
<ol type="1">
<li>è¿”å›å€¼ï¼šç¨‹åºå…¥å£ç‚¹</li>
</ol></li>
<li><strong>blank_state(addr)</strong>
<ol type="1">
<li>å‚æ•°ï¼šæ¨¡æ‹Ÿæ‰§è¡Œå¼€å§‹çš„åœ°å€</li>
</ol></li>
</ul></li>
<li>é™„å±æˆå‘˜
<ul>
<li><strong>regs</strong>
<ol type="1">
<li>é™„å±æˆå‘˜: å„ç§å¯„å­˜å™¨</li>
</ol></li>
<li><strong>fs</strong>
<ol type="1">
<li>å…¨ç§°: filesystem</li>
<li>é™„å±æˆå‘˜ï¼š
<ul>
<li><strong>insert(string filename,angr.storage.simFile)</strong>
<ol type="1">
<li>å‚æ•°1ï¼šæ–‡ä»¶åç§°</li>
<li>å‚æ•°2ï¼šåˆ›å»ºè¿‡çš„ç¬¦å·åŒ–æ–‡ä»¶å¯¹è±¡</li>
</ol></li>
</ul></li>
</ol></li>
</ul></li>
</ol></li>
<li><strong>simulation_managerç±»</strong>
<ol type="1">
<li>æ„é€ å‡½æ•°å‚æ•°ï¼šèµ·å§‹çŠ¶æ€</li>
<li>åŠŸèƒ½ï¼šè®¾ç½®æ¨¡æ‹Ÿæ‰§è¡Œçš„èµ·å§‹åœ°å€ï¼Œå¹¶è¿”å›å®ä¾‹åŒ–å¯¹è±¡</li>
<li>é™„å±æˆå‘˜
<ul>
<li><strong>explore(find, avoid)</strong>
<ol type="1">
<li>å‚æ•°findï¼šå¸Œæœ›ç¨‹åºæŠµè¾¾çš„åœ°å€</li>
<li>å‚æ•°avoidï¼šå¸Œæœ›ç¨‹åºä¸æŠµè¾¾çš„åœ°å€</li>
<li>åŠŸèƒ½ï¼šç”¨ç¬¦å·æ¢ç´¢åˆ°findæŒ‡å‘çš„åœ°å€ï¼Œå¹¶é¿å…avoidæŒ‡å‘çš„åœ°å€</li>
<li>é‡è½½ï¼šexplore(find=func1,avoid=func2) <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def func1(state):</span><br><span class="line">	return b&quot;Good Job!&quot; in state.posix.dumps(1)</span><br><span class="line">def func2(state):</span><br><span class="line">	return b&quot;Try Again!&quot; in state.posix.dumps(1)</span><br></pre></td></tr></table></figure>
<ol type="1">
<li>åŠŸèƒ½ï¼šæ¢ç´¢å…·æœ‰func1ç‰¹å¾çš„çš„å‡½æ•°åˆ†æ”¯ï¼Œå›é¿å…·æœ‰func2ç‰¹å¾çš„å‡½æ•°åˆ†æ”¯</li>
</ol></li>
</ol></li>
<li><strong>foundæ•°ç»„</strong>
<ol type="1">
<li>found_stateçš„å®ä¾‹åŒ–æ•°ç»„</li>
</ol></li>
</ul></li>
</ol></li>
</ul></li>
</ol></li>
</ul></li>
</ol></li>
<li><strong>found_stateç±»</strong>
<ul>
<li><strong>posix</strong>
<ul>
<li><strong>dumps(int std)</strong>
<ol type="1">
<li>å‚æ•°std: stdin(0)/stdout(1)/stderr(2)</li>
<li>åŠŸèƒ½: å°†stdæŒ‡å‘çš„å†…å®¹æ‰“å°å‡ºæ¥</li>
</ol></li>
</ul></li>
<li>solver
<ul>
<li>eval(claripy.BVS arg1)
<ol type="1">
<li>å‚æ•°ï¼šè¦æ±‚è§£çš„çº¦æŸå…¬å¼</li>
<li>åŠŸèƒ½ï¼šæ±‚è§£arg1å¹¶è¿”å›ç»“æœ</li>
</ol></li>
</ul></li>
</ul></li>
<li><strong>claripyç±»</strong>
<ul>
<li><strong>BVSç±»</strong>
<ol type="1">
<li>æ„é€ å‡½æ•°å‚æ•°ï¼šarg1: åˆ«å | arg2: ç¬¦å·å‘é‡å å¤šå°‘ä½</li>
<li>åŠŸèƒ½ï¼šæ„å»ºä¸€ä¸ªç©ºçš„çº¦æŸå…¬ç¤º</li>
</ol></li>
</ul></li>
<li><strong>storageç±»</strong>
<ul>
<li>SimFile(filename,content,size)
<ol type="1">
<li>å‚æ•°filenameï¼šè¦å¼•å…¥çš„filename</li>
<li>å‚æ•°contentï¼šç¬¦å·åŒ–å‘é‡</li>
<li>å‚æ•°sizeï¼šè¦ä»æ–‡ä»¶ä¸­è¯»å–çš„å­—èŠ‚æ•°*8ï¼ˆå•ä½ï¼šbitsï¼‰</li>
<li>åŠŸèƒ½ï¼šåˆ›å»ºä¸€ä¸ªç¬¦å·åŒ–çš„æ–‡ä»¶å¯¹è±¡</li>
</ol></li>
</ul></li>
<li><strong>sim_optionsç±»</strong>
<ul>
<li>SYMBOL_FILL_UNCONSTRAINED_MEMORY
<ul>
<li>åŠŸèƒ½ï¼šè‡ªåŠ¨ç”¨ç¬¦å·å¡«å……æœªçº¦æŸçš„å†…å­˜ï¼ˆæ¨¡æ‹Ÿè¿‡ç¨‹ä¸­æ²¡æœ‰æ˜ç¡®å€¼çš„å†…å­˜ä½ç½®ï¼‰</li>
</ul></li>
<li>SYMBOL_FILL_UNCONSTRAINED_REGISTERS
<ul>
<li>åŠŸèƒ½ï¼šè‡ªåŠ¨ç”¨ç¬¦å·å¡«å……æœªçº¦æŸçš„å¯„å­˜å™¨</li>
</ul></li>
</ul></li>
</ul>
<h1 id="x01-angrè¯­æ³•">0x01 Angrè¯­æ³•</h1>
<h3 id="å‡†å¤‡é˜¶æ®µ">1. å‡†å¤‡é˜¶æ®µ</h3>
<ul>
<li><p><strong>å¼•å…¥ä¸åˆå§‹åŒ–</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"></span><br><span class="line">p = angr.Project(exec_path)</span><br><span class="line"></span><br><span class="line">init_state = p.factory.entry_state()</span><br><span class="line"><span class="comment"># init_state = p.factory.blank_state(addr) # addr = 0xbeef</span></span><br><span class="line"></span><br><span class="line">sm = p.factory.simulation_manager(init_state)</span><br></pre></td></tr></table></figure></p></li>
<li><p><strong>å‘½ä»¤è¡Œå¼•å…¥å‚æ•°</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">argv</span>):</span><br><span class="line">	arg1 = argv[<span class="number">1</span>]</span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	main(sys.argv)</span><br></pre></td></tr></table></figure></p></li>
<li><p><strong>ç¬¦å·å‘é‡</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> claripy</span><br><span class="line"></span><br><span class="line">pass1 = claripy.BVS(<span class="string">&#x27;pass1&#x27;</span>, <span class="number">32</span>)</span><br></pre></td></tr></table></figure></p></li>
<li><p><strong>ç¬¦å·åŒ–å¯„å­˜å™¨</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">init_state.regs.eax = pass1</span><br></pre></td></tr></table></figure></p></li>
<li><p><strong>ç¬¦å·åŒ–æ–‡ä»¶</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">filename = <span class="string">&quot;&quot;</span></span><br><span class="line">filesize = </span><br><span class="line"></span><br><span class="line">password = init_state.solver.BVS(<span class="string">&#x27;password&#x27;</span>,filesize*<span class="number">8</span>)</span><br><span class="line">sim_file = angr.storage.SimFile(filename,content=password,size=filesize)</span><br><span class="line"></span><br><span class="line">init_state.fs.insert(sim_file)</span><br></pre></td></tr></table></figure></p></li>
</ul>
<h3 id="æ¢ç´¢é˜¶æ®µ">2. æ¢ç´¢é˜¶æ®µ</h3>
<ul>
<li><p><strong>æ¢ç´¢æŒ‡å®šåœ°å€å¹¶æŸ¥çœ‹æ ‡å‡†æµ</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sm.explore(find = addr_to_find)</span><br></pre></td></tr></table></figure></p></li>
<li><p><strong>åˆ©ç”¨å‡½æ•°exploreåˆ†æ”¯</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">is_good</span>(<span class="params">state</span>):</span><br><span class="line">	<span class="keyword">return</span> <span class="string">b&quot;Good Job!&quot;</span> <span class="keyword">in</span> state.posix.dumps(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_bad</span>(<span class="params">state</span>):</span><br><span class="line">	<span class="keyword">return</span> <span class="string">b&quot;Try Again!&quot;</span> <span class="keyword">in</span> state.posix.dumps(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">sm.explore(find=is_good, avoid=is_bad)</span><br><span class="line"><span class="comment"># sm.explore(find=addr_find, avoid=addr_avoid)</span></span><br></pre></td></tr></table></figure></p></li>
</ul>
<h3 id="è¾“å‡ºé˜¶æ®µ">3. è¾“å‡ºé˜¶æ®µ</h3>
<ul>
<li><p><strong>æŸ¥çœ‹ç»“æœ</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> sm.found:</span><br><span class="line">	found_state = sm.found[<span class="number">0</span>]</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;[x] Solution: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(found_state.posix.dumps(<span class="number">0</span>)))</span><br></pre></td></tr></table></figure></p></li>
<li><p><strong>æ±‚è§£å¯„å­˜å™¨çš„ç¬¦å·å‘é‡</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result = init_state.solver.<span class="built_in">eval</span>(BVS)</span><br></pre></td></tr></table></figure></p></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="http://heygap.github.io">HeyGap</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://heygap.github.io/posts/15983.html">http://heygap.github.io/posts/15983.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="http://heygap.github.io" target="_blank">HeyGap's_Blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/SymbolicExecution/">SymbolicExecution</a></div><div class="post-share"><div class="social-share" data-image="/img/cover8.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/7380.html" title="comp - 2023é¦™å±±æ¯Pwn &amp; RE-wp"><img class="cover" src="/img/cover2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">ä¸Šä¸€ç¯‡</div><div class="info-item-2">comp - 2023é¦™å±±æ¯Pwn & RE-wp</div></div><div class="info-2"><div class="info-item-1"> é¦™å±±æ¯ï¼Pwn ak + RE å·®å‡ åˆ†é’Ÿå°±å†™å®ŒxxTEAå•¦ğŸ˜­   RE urlä»å“ªå„¿æ¥  æ–­ç‚¹ä¸‹åœ¨è¿™ï¼ŒçŸ¥é“ä»–ä¼šåœ¨bufferæŒ‡å‘çš„åœ°å€ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶ï¼Œè®©ç¨‹åºè·‘å®Œï¼Œèƒ½çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶  idaæ‰“å¼€ï¼Œå› ä¸ºå®ƒé—®urlæ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥çœ‹szurl  ç»“æœè¿™ä¸ªä¸æ˜¯flagï¼Œçœ‹åˆ°urlé—®æˆ‘ä»¬æ˜¯å¦‚ä½•è§£å¯†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å›åˆ°ä¸Šé¢é‚£ä¸€å †æ•°æ®é‡Œé¢ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹v13  flagå°±åœ¨è¿™...</div></div></div></a><a class="pagination-related" href="/posts/42047.html" title="IOT - æŸè·¯ç”±å™¨mipså›ºä»¶è§£å¯†è„šæœ¬å¤ç°"><img class="cover" src="/img/cover1.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">IOT - æŸè·¯ç”±å™¨mipså›ºä»¶è§£å¯†è„šæœ¬å¤ç°</div></div><div class="info-2"><div class="info-item-1"> æœŸä¸­ç»ˆäºç»“æŸäº†ğŸ˜­å¤ç°ä¸€ä¸‹bç«™Wker666çš„å›ºä»¶è§£å¯†    ç¬¬ä¸€æ¬¡åˆ†æIOTå›ºä»¶ï¼Œä¸å½“ä¹‹å¤„è¯·æŒ‡å‡ºğŸ˜­  0xFF å‰ç½®çŸ¥è¯†  å¤šæ•°æƒ…å†µä¸‹ï¼Œè·¯ç”±å™¨å›ºä»¶è§£åŒ…ä»¥åæˆ‘ä»¬ä¼šæ‹¿åˆ°ä¸€ä¸ªç±»ä¼¼äº Linux æ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶å¤¹ï¼Œè¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿä¼šè·‘ä¸€äº›ä¸‰ç¯ç¨‹åºï¼Œè€Œä¸‰ç¯ç¨‹åºæœ‰éå¸¸å¤šçš„ç³»ç»Ÿè°ƒç”¨ï¼Œå› æ­¤æˆ‘ä»¬å¸Œæœ›é€šè¿‡è¿™äº›ä¸‰ç¯ç¨‹åºæ¥ææƒã€‚ ç°åœ¨å¾ˆå¤šå‚å•†ä¼šè®¤ä¸ºï¼Œè‡ªå·±çš„è·¯ç”±å™¨èƒ½è¢«è§£åŒ…å¤ªä¸å®‰å…¨äº†ï¼Œå› æ­¤ä»–ä»¬ä¼šé€šè¿‡åŠ å¯†ï¼Œä½†æ˜¯æ¯æ¬¡æ›´æ–°æ¢ä»£æ—¶ï¼Œåä¸€ä»£çš„å›ºä»¶åŒ…éƒ½æ˜¯é€šè¿‡å‰ä¸€ä»£çš„å›ºä»¶ä¸­çš„æŸä¸ªè§£å¯†ç®—æ³•æ¥è§£å¯†çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨æŒ–æ˜ IOT æ¼æ´æ—¶ï¼Œä¼šå…ˆæ‰¾åˆ°æ¯”è¾ƒè€çš„ä¸€äº›ç‰ˆæœ¬ï¼Œåˆ†æè§£å¯†ç®—æ³•ï¼Œè¿›è€Œè‡ªå·±å†™å‡ºè§£å¯†è„šæœ¬æ¥è§£å¯†æ–°ä¸€ä»£çš„å›ºä»¶åŒ…ã€‚ (å»ºè®®çœ‹åˆ°0x01åå†æ¥é˜…è¯»æœ¬æ¡)æˆ‘ä»¬åœ¨è·¯ç”±å™¨çš„ web user ä¸Šå‘é€ä¸€ä¸ªæ›´æ–°è¯·æ±‚çš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯ä¼šå…ˆå‘ç»™æœåŠ¡å™¨ä¸€ä¸ª http è¯·æ±‚ï¼Œç„¶åè¢«æœåŠ¡å™¨çš„ httpd äºŒè¿›åˆ¶æ–‡ä»¶æ¥æ”¶ï¼Œhttpd ä¼š fork ä¸€ä¸ªæ–°çš„è¿›ç¨‹æ¥å¯ç”¨äºŒè¿›åˆ¶æ–‡ä»¶ cgibin ï¼Œå¹¶æŠŠç¯å¢ƒå˜é‡å’Œ http çš„è¯·æ±‚å‘ç»™ cgi ï¼Œ...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/18908.html" title="Symbolic Execution Leaning Note (1) -- Basis"><img class="cover" src="/img/cover4.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-30</div><div class="info-item-2">Symbolic Execution Leaning Note (1) -- Basis</div></div><div class="info-2"><div class="info-item-1"> è¿ˆå‘è‡ªåŠ¨åŒ–çš„ç¬¬ä¸€æ­¥â€”â€”   0x00 åŸºæœ¬æ¨¡å‹  æ¦‚è¿° 1234561  void sum(a,b)&#123;2    int x = a;3    int y = b;4    int z = x + y;5    return z;6  &#125;...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">HeyGap</div><div class="author-info-description">An undergraduate student of Cybersecurity at SDU.</div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">33</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">25</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">12</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/HeyGap"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/HeyGap" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:2310769056@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢ï¼Œä¸»è¦ç”¨æ¥è®°å½•ä¸€äº›å­¦ä¹ ç¬”è®°å’Œç”Ÿæ´»æ„Ÿæ‚Ÿã€‚</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#xff-reference"><span class="toc-text">0xFF Reference</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#x00-recall-symbolic-execution"><span class="toc-text">0x00 Recall-Symbolic
Execution</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E5%85%A5%E7%AC%A6%E5%8F%B7inject-symbols"><span class="toc-text">1. æ³¨å…¥ç¬¦å·(Inject Symbols)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%94%AFbranching"><span class="toc-text">2. åˆ†æ”¯(Branching)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%84%E4%BC%B0%E5%88%86%E6%94%AFevaluate-each-branches"><span class="toc-text">3. è¯„ä¼°åˆ†æ”¯(Evaluate Each
Branches)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#x01-an-introduction-to-angr"><span class="toc-text">0x01 An Introduction to Angr</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BA%E7%8E%B0%E7%9A%84class"><span class="toc-text">1. å‡ºç°çš„class</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#symbolic-execution-in-angr"><span class="toc-text">2. Symbolic Execution In Angr</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#x01-%E5%BA%93%E6%9E%B6%E6%9E%84%E5%88%86%E6%9E%90"><span class="toc-text">0x01 åº“æ¶æ„åˆ†æ</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#x02-api%E6%89%8B%E5%86%8C"><span class="toc-text">0x02 APIæ‰‹å†Œ</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#x01-angr%E8%AF%AD%E6%B3%95"><span class="toc-text">0x01 Angrè¯­æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E9%98%B6%E6%AE%B5"><span class="toc-text">1. å‡†å¤‡é˜¶æ®µ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A2%E7%B4%A2%E9%98%B6%E6%AE%B5"><span class="toc-text">2. æ¢ç´¢é˜¶æ®µ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%E9%98%B6%E6%AE%B5"><span class="toc-text">3. è¾“å‡ºé˜¶æ®µ</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/65231.html" title="kernel - syzkaller"><img src="/img/cover7.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="kernel - syzkaller"/></a><div class="content"><a class="title" href="/posts/65231.html" title="kernel - syzkaller">kernel - syzkaller</a><time datetime="2025-03-14T03:58:00.000Z" title="å‘è¡¨äº 2025-03-14 11:03:00">2025-03-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/25823.html" title="kernel - æµ…æ kernel drivers ä¸ç®€å•å®æ“"><img src="/img/cover3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="kernel - æµ…æ kernel drivers ä¸ç®€å•å®æ“"/></a><div class="content"><a class="title" href="/posts/25823.html" title="kernel - æµ…æ kernel drivers ä¸ç®€å•å®æ“">kernel - æµ…æ kernel drivers ä¸ç®€å•å®æ“</a><time datetime="2025-02-21T05:06:00.000Z" title="å‘è¡¨äº 2025-02-21 13:02:00">2025-02-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/34368.html" title="fuzz - æµ…æåŸç†ä¸ AFLpp ä½¿ç”¨"><img src="/img/cover9.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="fuzz - æµ…æåŸç†ä¸ AFLpp ä½¿ç”¨"/></a><div class="content"><a class="title" href="/posts/34368.html" title="fuzz - æµ…æåŸç†ä¸ AFLpp ä½¿ç”¨">fuzz - æµ…æåŸç†ä¸ AFLpp ä½¿ç”¨</a><time datetime="2025-02-14T05:46:00.000Z" title="å‘è¡¨äº 2025-02-14 13:02:00">2025-02-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/18184.html" title="blockchain - openzeppelin æºç é˜…è¯»"><img src="/img/cover4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="blockchain - openzeppelin æºç é˜…è¯»"/></a><div class="content"><a class="title" href="/posts/18184.html" title="blockchain - openzeppelin æºç é˜…è¯»">blockchain - openzeppelin æºç é˜…è¯»</a><time datetime="2025-02-05T10:15:00.000Z" title="å‘è¡¨äº 2025-02-05 18:02:00">2025-02-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/13129.html" title="blockchain - Uniswap V2"><img src="/img/cover7.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="blockchain - Uniswap V2"/></a><div class="content"><a class="title" href="/posts/13129.html" title="blockchain - Uniswap V2">blockchain - Uniswap V2</a><time datetime="2025-02-04T06:09:00.000Z" title="å‘è¡¨äº 2025-02-04 14:02:00">2025-02-04</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/cover8.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2025 By HeyGap</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ä¸­</button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"></div><script data-pjax src="/self/btf.js"></script><script data-pjax src="/self/ch_en.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('å·²æŒ‚è½½butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><!-- hexo injector body_end end --></body></html>