<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Web - 网络安全概述 | HeyGap's_Blog</title><meta name="author" content="HeyGap"><meta name="copyright" content="HeyGap"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="12.24网络安全期末，用这篇文章来梳理一下对相关知识的理解">
<meta property="og:type" content="article">
<meta property="og:title" content="Web - 网络安全概述">
<meta property="og:url" content="http://heygap.github.io/en/posts/27202.html">
<meta property="og:site_name" content="HeyGap&#39;s_Blog">
<meta property="og:description" content="12.24网络安全期末，用这篇文章来梳理一下对相关知识的理解">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://heygap.github.io/en/img/cover10.jpg">
<meta property="article:published_time" content="2024-12-20T08:27:00.000Z">
<meta property="article:modified_time" content="2025-02-12T10:09:13.110Z">
<meta property="article:author" content="HeyGap">
<meta property="article:tag" content="web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://heygap.github.io/en/img/cover10.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Web - 网络安全概述",
  "url": "http://heygap.github.io/en/posts/27202.html",
  "image": "http://heygap.github.io/en/img/cover10.jpg",
  "datePublished": "2024-12-20T08:27:00.000Z",
  "dateModified": "2025-02-12T10:09:13.110Z",
  "author": [
    {
      "@type": "Person",
      "name": "HeyGap",
      "url": "http://heygap.github.io/en/"
    }
  ]
}</script><link rel="shortcut icon" href="/en/img/avatar.jpg"><link rel="canonical" href="http://heygap.github.io/en/posts/27202.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/en/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/en/',
  algolia: undefined,
  localSearch: {"path":"/en/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"中"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"You have switched to Traditional Chinese","cht_to_chs":"You have switched to Simplified Chinese","day_to_night":"You have switched to Dark Mode","night_to_day":"You have switched to Light Mode","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Web - 网络安全概述',
  isHighlightShrink: true,
  isToc: true,
  pageType: 'post'
}</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load', preloader.endLoading)

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/en/img/background1.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/en/img/avatar.jpg" onerror="this.onerror=null;this.src='/en/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/en/archives/"><div class="headline">Articles</div><div class="length-num">31</div></a><a href="/en/tags/"><div class="headline">Tags</div><div class="length-num">24</div></a><a href="/en/categories/"><div class="headline">Categories</div><div class="length-num">11</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 我的文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/en/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/en/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/en/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/en/air-conditioner/"><i class="fa-fw anzhiyu-icon-fan"></i><span> 小空调</span></a></div><div class="menus_item"><a class="site-page" href="/en/about/"><i class="fa-fw fa fa-user"></i><span> 关于本人</span></a></div><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> home</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> articles</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/en/archives/"><i class="fa-fw fa fa-archive"></i><span> archives</span></a></li><li><a class="site-page child" href="/en/tags/"><i class="fa-fw fa fa-tags"></i><span> tags</span></a></li><li><a class="site-page child" href="/en/categories/"><i class="fa-fw fa fa-folder-open"></i><span> categories</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/en/air-conditioner/"><i class="fa-fw anzhiyu-icon-fan"></i><span> air-conditioner</span></a></div><div class="menus_item"><a class="site-page" href="/en/about/"><i class="fa-fw fa fa-user"></i><span> about</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/cover10.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/en/"><span class="site-name">HeyGap's_Blog</span></a><a class="nav-page-title" href="/en/"><span class="site-name">Web - 网络安全概述</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 我的文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/en/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/en/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/en/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/en/air-conditioner/"><i class="fa-fw anzhiyu-icon-fan"></i><span> 小空调</span></a></div><div class="menus_item"><a class="site-page" href="/en/about/"><i class="fa-fw fa fa-user"></i><span> 关于本人</span></a></div><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> home</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> articles</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/en/archives/"><i class="fa-fw fa fa-archive"></i><span> archives</span></a></li><li><a class="site-page child" href="/en/tags/"><i class="fa-fw fa fa-tags"></i><span> tags</span></a></li><li><a class="site-page child" href="/en/categories/"><i class="fa-fw fa fa-folder-open"></i><span> categories</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/en/air-conditioner/"><i class="fa-fw anzhiyu-icon-fan"></i><span> air-conditioner</span></a></div><div class="menus_item"><a class="site-page" href="/en/about/"><i class="fa-fw fa fa-user"></i><span> about</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Web - 网络安全概述</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-12-20T08:27:00.000Z" title="Created 2024-12-20 16:12:00">2024-12-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-02-12T10:09:13.110Z" title="Updated 2025-02-12 18:02:11">2025-02-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/en/categories/WEB/">WEB</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">9.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>30mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><blockquote class="blockquote-center">
12.24网络安全期末，用这篇文章来梳理一下对相关知识的理解
</blockquote>
<span id="more"></span>
<figure>
<img src="/pic/5cddd5eea2e4549ee0b1252922577350.png" alt="导图" />
<figcaption aria-hidden="true">导图</figcaption>
</figure>
<p>这篇文章主要从TCP/IP五层模型的层次来比较宽泛地讲一些常见的网络攻击。众所周知，TCP/IP五层模型将网络架构分为物理层、数据链路层、网络层、运输层和应用层。针对物理层的攻击我不是很懂，因此不在本篇文章的描述范围内，而应用层出现的app漏洞和防御技术比较广泛，会用几章分别叙述。</p>
<blockquote>
<p>每一章大概分为"协议-攻击方式-防御措施"三部分。常见攻击可以分为"DoS,投毒,劫持"，其中，劫持一般是劫持有状态的协议。</p>
</blockquote>
<p>下面是一些用于应试的背诵点，不考试的读者直接跳过即可。</p>
<p>分层带来的功能是：拆分与重组、封装、连接控制、顺序递交、流控制、出错控制和复用</p>
<p>bugs指的是软件程序中的错误或缺陷，vuln指的是系统需求、设计、实现或运行中的缺陷或弱点，
exploit指的是一段软件、一系列命令或一组数据利用vuln或bugs来引发计算机软件或硬件上的非预期行为</p>
<p>网络攻击可以分为：面向报文头的攻击、面向认证的攻击、面向协议的攻击和面向网络流的攻击。</p>
<h1 id="比较容易遗忘的点">[0] 比较容易遗忘的点：</h1>
<ol type="1">
<li><p>分层带来的功能</p></li>
<li><p>bugs,vuln,==exp==</p></li>
<li><p>==网络攻击分类方式==</p></li>
<li><p>==IPSec的enchidala怎么来的==</p></li>
<li><p>==传输层:TCP攻击方式 + manimon==</p></li>
<li><p>==DNS报文解析，什么样的报文会被递归DNS接收，劫持型DNS
poison，响应型服务器做什么检查？DNS有哪些攻击方式？==</p></li>
<li><p>==web系统安全：css/js有哪些安全风险？服务器的风险（缓存没记住），web系统风险，cookieparams，第三方插件安全，tls工作阶段==</p></li>
<li><p>==邮件安全：绕过身份验证攻击，DKIM重放，根本原因==</p></li>
<li><p>防火墙：功能、缺陷、三种防火墙的原理和优缺点、其他类型防火墙、WAF、内部防火墙的部署</p></li>
<li><p>IDS：HIDS/NIDS的原理及优缺点，常见入侵，P2DR，IDS技术</p></li>
<li><p>arp投毒如何防护</p></li>
<li><p>缓存：①被注入②未授权的访问数据③字段错误导致访问问题④窃取行为习惯</p></li>
<li><p>web系统的风险有：①身份冒充②网络监听和中间人③DOS④针对应用的攻击</p></li>
<li><p>包过滤防火墙优点：高效开销小+透明，缺点：粒度粗容易误报漏报、不防御应用层漏洞、不防御IP伪造、日志提供有限</p></li>
<li><p>状态检测防火墙优点：建立连接跟踪，检测会话，减少虚假报警；缺点：配置复杂、开销大、不防御应用层漏洞、不适合UDP</p></li>
<li><p>应用层防火墙优点：能防御应用层、日志详细，缺点：配置复杂因地制宜+开销大+错误拦截多+第三方漏洞</p></li>
<li><p>WAF：基于特征、基于行为、基于语义分析</p></li>
<li><p>其他类型防火墙：</p></li>
<li><p>HIDS优点：检测加密前解密后的数据、不受交换网络影响、检测NIDS无法检测的内容、检测软件完整性破坏
缺点：开销大、因地制宜配置复杂、可能背攻击禁用</p></li>
<li><p>NIDS优点：被动捕获、扩展性好、OS独立、抗DoS。缺点：①受交换空间影响②无法检测加密内容③难以处理高速网络</p></li>
<li><p>常见入侵：蠕虫木马、钓鱼邮件、勒索病毒、APT、DoS</p></li>
<li><p>基于误用：模式匹配，静态只匹配静态表，动态还分析时间序列或状态变化等</p></li>
<li><p>静态mac表，开启路由器和网关的arp防护，用软件或中间件来检测arp</p></li>
</ol>
<h1 id="数据链路层局域网">[1] 数据链路层(局域网)</h1>
<h2 id="协议">[1-1] 协议</h2>
<p>这部分讲述的协议不只是设计数据链路层的协议，而是涉及到局域网通信的协议。</p>
<p>由于物理媒介的不同，我们可以把网络分为有线网络和无线网络。无线网络涉及AP、信道等内容，不利于基础攻防技术的学习，因此本文主要基于有线网络进行讲述。根据IEEE
802.3 的规定，有线网络使用的数据传输策略是CSMA/CD(carrier sensation
multiple access/collision
detection)，即带有碰撞检测的载波监听多点接入技术，该技术的细节就不在这里过多描述，
我们只需要知道因为该协议的存在，数据链路层的数据包的data部分必须控制在46byte-1500byte，被称为MTU。在数据链路层中，我们为每一个网络设备分配了唯一的标识符，即MAC地址(media
access control
address)。多个网络设备可以通过交换机连接成一个局域网。</p>
<h3 id="arp">[1-1-1] ARP</h3>
<p>如果设备A要与设备B通信，那么A需要先通过ARP协议得知B的MAC地址。ARP其实是通过IP地址找MAC地址的一种协议，如果发送方A不知道接受方B的MAC地址，A会先广播一条消息"我是A(MAC:aaa,IP:aaa)，我想知道bbb这个IP对应的MAC地址是什么"，这条消息叫做ARP
Request。用同一台交换机相连的所有网络设备都会接收到这条消息，当B发现A在找自己的时候，B就会记录下A的MAC地址，然后给A回复一条消息告诉A"bbb这个IP地址指的是我，我的MAC地址是bbb"</p>
<p>在数据传输的过程中，交换机也会不断学习这个数据包的源MAC地址和目的MAC地址，记录在交换机的缓存当中，这个过程叫做交换机的逆学习过程。</p>
<h3 id="dhcp">[1-1-2] DHCP</h3>
<p>如果设备A想要跟互联网通信，那么设备A必须要获取自己的IP地址和所在子网，除此之外，它还需要知道递归DNS服务器和默认网关的IP地址，这些都是DHCP服务器为设备A分配的。</p>
<h2 id="常见攻击">[1-2] 常见攻击</h2>
<h3 id="arp-1">[1-2-1] ARP</h3>
<h4 id="arp-dosmac地址洪泛">[1-2-1-1] ARP DoS(MAC地址洪泛)</h4>
<p>交换机的MAC表有老化机制，当一条MAC记录生存期结束之后才会被新的MAC记录替换；而MAC表的容量又是有限的，如果MAC表满了，并且当前表中所有记录都尚未过期，那此时交换机将对它无法找到MAC地址的所有数据包进行泛洪，也就是将这个数据包广播到它的所有接口(除了收到数据包的接口)。</p>
<p>如果攻击者伪造大量的MAC地址将交换机填满，再发送大量不在表中的MAC地址给交换机，交换机就会广播大量数据包给局域网，给网络造成压力。</p>
<h4 id="arp-缓存投毒">[1-2-1-2] ARP 缓存投毒</h4>
<ul>
<li>ARP Reply</li>
</ul>
<p>攻击者伪造reply包，欺骗受害者的目的MAC地址</p>
<ul>
<li>ARP Request</li>
</ul>
<p>攻击者伪造request包，欺骗受害者的源MAC地址</p>
<p>这两种攻击可以欺骗客户端/网关/服务器，获取他们发送/接收的数据包。</p>
<h3 id="dhcp-1">[1-2-2] DHCP</h3>
<h4 id="dhcp-dos">[1-2-2-1] DHCP DoS</h4>
<p>攻击者伪造大量"从不同MAC发来的DHCP
req"数据包，消耗DHCP服务器分配的资源 #### [1-2-2-2] DHCP 投毒
攻击者伪装成DHCP服务器向受害者发送DHCP Reply</p>
<h1 id="网络层">[2] 网络层</h1>
<h2 id="协议-1">[2-1] 协议</h2>
<h3 id="ip">[2-1-1] IP</h3>
<p>由于MAC地址唯一且不可随意更改，我们需要用IP地址来灵活管理接入网络的设备。IP协议规定了数据包
的头部(比如源IP目的IP，是否分片)，同时IP协议规定了最大数据包大小(MTU,1500bytes)，其中IP头占据20字节</p>
<h3 id="icmp">[2-1-2] ICMP</h3>
<p>ICMP协议用于报告网络通信中的错误情况和诊断信息，ICMP头部包含type(类型)、code(子类型)、checksum和其余字段，通过改变type/code等内容，可以报告不同的错误类型，
比如目标不可达、超时和源抑制等，ICMP头一般占据8byte</p>
<h2 id="常见攻击-1">[2-2] 常见攻击</h2>
<h3 id="ip-1">[2-2-1] IP</h3>
<h4 id="ping-of-death">[2-2-1-1] Ping of Death</h4>
<p>ICMP协议规定 ICMP Echo Request 的数据包最大不超过 65535
字节，去掉IP和ICMP头部的28字节， 还剩 65507
byte。如果我们构造的数据包数据部分大于这个数目，可能会导致缓冲区溢出。
比如我们构造一个75000byte的数据包，MTU大小为1500，去掉头部还剩1472byte，所以我们需要
构造 <span class="math inline">\(\lceil 75000 / 1472 \rceil =
51\)</span> 个分片，当这些分片被组合起来的时候就会造成缓冲区溢出。</p>
<h3 id="icmp-1">[2-2-2] ICMP</h3>
<h4 id="smurf攻击icmp-dos">[2-2-2-1] Smurf攻击(ICMP DoS)</h4>
<p>攻击者向某个含有大量网络设备的广播域发送一个 ICMP Echo Request
包，这个包的
源IP地址伪造为受害者的IP，这样该广播域所有接收到request包的设备都会向受害者
发送reply包，导致流量放大，使受害者网络资源耗尽。</p>
<h4 id="icmp-redirecticmp-poisoning">[2-2-2-2] ICMP Redirect(ICMP
Poisoning)</h4>
<p>ICMP包中Type=5叫做重定向包，路由器A在接收到用户的数据包后，
发现用户将该数据包转发到B可以更有效地到达目标，就会用 ICMP
重定向包告知用户更改默认网关。
如果在用户发出一个数据包后，攻击者伪造一个IMCP重定向包，将用户的默认网关修改为自己可以控制的IP，
用户发出的所有流量就会被攻击者获得。</p>
<h2 id="防护措施-ipsec">[2-3] 防护措施-IPSec</h2>
<p>通过常见攻击手段，我们可以发现利用网络层发起的攻击都有以下特点：①报头会被伪造②数据包
可以被修改后转发或重放。因此，我们设计的防御措施可以从以下安全目标出发：
①加密数据包，防止中间人查看数据②加入序列号，防止重放攻击③加入哈希函数和数字签名，
防止数据包伪造。</p>
<h3 id="组件">[2-3-1] 组件</h3>
<p>ESP: 封装安全载荷，提供数据完整性、不可抵赖性和保密性</p>
<p>AH: 认证报头协议，提供数据完整性、不可抵赖性</p>
<p>IKE: 互联网密钥交换协议</p>
<h4 id="密钥管理系统">[2-3-1-1] 密钥管理系统</h4>
<p>Security Association(SA):
一组用于保护通信的安全参数，定义了数据包如何传入传出
SA是单向的，因此双向通信需要用到2个SA。
SA一般由IKE自动维护，SA中包括一个参数叫做Security Parameter
Index，用于在数据库中索引和匹配SA</p>
<p>Security Association Database(SAD):
端点用于存储SA的数据库，发送方发送数据包前首先检查SAD确认发送方式，
接收方接收到数据包后，根据数据包中的SPI匹配SAD中的SA，来确认用什么方式处理数据包。</p>
<p>Security Policy Database(SPD):
端点通过源IP、目的IP和协议号来匹配SPD，查看此次通话是否需要用到IPSec，
如果要用的话就去查找SAD，确认使用哪个SA。</p>
<p>IKE工作流程：IKE的工作分为两阶段，第一阶段协商一个辅助的端到端安全信道IKE
SA，第二阶段用于协商范围更小的IPSec SA。
IKE经常分为用户IKE守护进程，或者是内核IKE。当IKE进程启动时就会协商IKE
SA，后续每个应用程序使用IKE的话，
IKE就会进入第二阶段，为每个进程协商IPSec SA</p>
<h3 id="传输模式">[2-3-2] 传输模式</h3>
<p>传输模式：不加密IP头，适用于端到端</p>
<p>隧道模式：加密IP头，适用于网关到网关</p>
<h3 id="esp-tun-mode-工作流程">[2-3-3] ESP TUN Mode 工作流程</h3>
<p>①在原始数据包前后加入ESP头和ESP尾形成新数据包，ESP头包含SPI和序列号，ESP尾用于padding</p>
<p>②加密新数据包，形成enchidala，注意头部是不加密的，要不然接收方无法确认SPI，也就无法选择SA。</p>
<p>③对enchidala进行mac计算，将结果拼接到enchidala尾部</p>
<p>④最终数据包: 新IP头 + enchidala + MAC认证</p>
<h1 id="运输层">[3] 运输层</h1>
<h2 id="协议-2">[3-1] 协议</h2>
<h3 id="udp">[3-1-1] UDP</h3>
<p>UDP类似于IP协议，在底层数据包的基础上加入一个8字节的头部，包含源端口、目的端口、长度和checksum。
UDP协议是无状态的。</p>
<h3 id="tcp">[3-1-2] TCP</h3>
<p>TCP协议是有状态的，通过三次握手建立连接，通过四次挥手释放连接。</p>
<p>三次握手过程为： ①A随机挑选一个序列号seq=x，向B发送seq=x的数据包
②B随机挑选一个序列号ack=y，向A发送seq=y,ack=x+1的数据包，同时将SYN和ACK标志位设置为1
同时服务器分配一个端口给该TCP连接，此时B称为半连接状态
③A接收到数据包之后，向B发送seq=x+1，ack=y+1的数据包，该数据包ACK标志为1，第三次握手已经可以携带其他数据。</p>
<p>四次挥手考察的比较少，用人话来说可以模拟成如下场景：</p>
<p>A:我数据发完了，连接可以关闭了</p>
<p>B:我知道了，连接先留着，等我数据发完再关</p>
<p>B:我发完了，TCP连接可以关了</p>
<p>A:我知道了，那就关吧</p>
<h2 id="主要攻击方式">[3-2] 主要攻击方式</h2>
<h3 id="端口扫描与资产探查">[3-2-1] 端口扫描与资产探查</h3>
<p>资产探查就是利用不同操作系统、app等对IP、ICMP等协议数据包处理细节的不同，来判断该主机使用的是什么OS或app。
比如windows和linux对TTL设置就不相同。</p>
<p>按连接状态分，端口扫描有两种方式，全连接扫描和半连接扫描，全连接比较完善，但是半连接更隐蔽一些。</p>
<p>按协议分，端口扫描也可以分为TCP和UDP扫描两种方式。UDP扫描比较简单，就是给一台主机的全部端口发送空的UDP包，
如果收到ICMP目的不可达说明端口关闭，收到响应报文则说明端口开放。</p>
<p>TCP扫描有四种基本方式：Manimon(SYN+ACK),NULL(标志位全0),FIN(FIN),Xmas(FIN,URG,PSH)，
开放的端口对这些错误包都是不予理睬的，FIN扫描最多会回显一个ICMP错误，但是未开放的端口会响应一个RST包</p>
<h4 id="隐蔽扫描">[3-2-1-1] 隐蔽扫描</h4>
<p>攻击者通过伪造数据包srcIP为A的IP，利用主机A来扫描主机B的端口，然后通过ICMP包来查看A的IPID增加数目来判断B的端口是否开放。</p>
<h3 id="tcp-syn-floodtcp-dos">[3-2-2] TCP SYN Flood(TCP DoS)</h3>
<p>攻击者不断发起第一次握手，等服务器第二次握手结束后不发送第三次握手，这样就会大量占据服务器的端口资源</p>
<h3 id="tcp-会话劫持重置">[3-2-3] TCP 会话劫持/重置</h3>
<p>攻击者通过预测TCP序列号，向该TCP连接注入恶意数据包。比如向telnet服务器注入反弹shell命令，或者单纯发一个RST数据包重置TCP连接，都会造成较大的影响。</p>
<blockquote>
<p>如何预测 TCP 序列号？</p>
</blockquote>
<p>RFC标准中规定，如果一台主机收到TCP报文但报文中含有错误的序列号或确认号时，会回复一个ACK报文来明确正确的序列号和确认号。
那么攻击者只要在预测序列号前后都查看一次IPID，如果IPID+1则正确，+2则不正确</p>
<h3 id="tcp反射放大攻击">[3-2-4] TCP反射放大攻击</h3>
<p>防火墙在阻拦TCP连接时往往第一次握手就会回复一个比请求包大的多的阻断包。攻击者可以利用该特性实施反射放大攻击</p>
<blockquote>
<p>补充：CDN反射放大攻击</p>
</blockquote>
<p>当客户向CDN请求资源时，CDN可能会向源站请求完整资源，然后只回复客户所需的资源。攻击者可以构造较小的资源请求，使CDN向源站请求较大的完整资源，从而造成反射放大。</p>
<h2 id="防御措施">[3-3] 防御措施</h2>
<h3 id="针对syn-flood">[3-3-1] 针对SYN Flood</h3>
<ol type="1">
<li>增大半连接等待队列</li>
<li>降低资源回收时间</li>
<li>TCP Cookie，在验证第三次握手cookie正确前不分配资源</li>
</ol>
<h1 id="应用层">[4] 应用层</h1>
<h2 id="域名系统">[4-1] 域名系统</h2>
<h3 id="域名系统概述">[4-1-1] 域名系统概述</h3>
<p>整个域名系统可以由如下部分构成：根域名服务器-顶级域名服务器-权威域名服务器-递归域名服务器-客户端。
客户端如果想要查询一个域名对应的IP地址，只需要向递归域名服务器发起询问，递归域名服务器会向根域名服务器查询顶级域名服务器的位置，
然后向顶级域名服务器查询二级、三级域名服务器的位置，最后向权威域名服务器查询这个域名对应的IP地址。
当递归域名服务器得到IP地址之后，就会向客户返回这个资源条目。</p>
<p>一个资源条目一般包括：域名-缓存时间-资源类别-资源类型-IP地址。资源类型一般包含A(ipv4地址)、AAAA(ipv6地址)、NS(权威DNS名称)、
MX(邮件服务器名称)、CNAME(域名别名)和SOA(起始授权信息)</p>
<p>同时，为了减轻网络压力，递归域名服务器和客户主机一般会缓存一部分DNS条目。</p>
<p>另外，DNS报文体对应报文头中的四个数量字段，它们分别是:</p>
<ol type="1">
<li>问题区域：指定用户查询的目标域名和资源记录类型</li>
<li>应答区域：直接回答查询请求，即满足目标域名和资源记录类型的权威应答</li>
<li>授权区域：一般包含类型为NS的资源记录，指向域名的权威服务器名称</li>
<li>附加区域：包含域名服务器返回的在查询过程中可能用到的其他资源记录，比如权威服务器对应的IP地址等</li>
</ol>
<h3 id="主要攻击方式-1">[4-1-2] 主要攻击方式</h3>
<h4 id="poisoning">[4-1-2-1] Poisoning</h4>
<ol type="1">
<li>应答型</li>
</ol>
<p>客户在发起DNS请求后，攻击者抢在递归域名服务器之前向客户发起响应，不过只有IP地址匹配、端口匹配、TXID匹配和问题区域匹配，
response包才会被递归DNS接收，问题区域可以通过自问自答的方式解决，IP地址填自己就行，
但TXID和目的端口需要攻击者爆破去猜测。</p>
<ol start="2" type="1">
<li>劫持型</li>
</ol>
<h4 id="绕过同源策略dns-重绑定攻击">[4-1-2-2] 绕过同源策略(DNS
重绑定攻击)</h4>
<p>同源策略是指JS脚本只能访问同源资源，同源指的是"协议://域名:端口"相同。绕过同源策略需要攻击者控制递归域名服务器。</p>
<p>当客户向域名服务器查询域名A的IP时，攻击者可以返回一个恶意IP，客户会在这个IP被注入恶意脚本，该恶意脚本每隔一段时间访问域名A。
同时，攻击者控制的DNS服务器将这个域名-IP的缓存时间设置的极短，当该DNS缓存条目过期之后，恶意脚本再访问域名A就会再次向攻击者DNS服务器查询域名，
此时攻击者返回用户的内网IP，恶意脚本就绕过同源策略，可以访问到这个内网IP的资源了。</p>
<h4 id="dns-反射放大">[4-1-2-3] DNS 反射放大</h4>
<p>攻击者伪造DNS请求的srcIP，并向网络中大量递归域名服务器发送请求，这些DNS服务器收到请求后都会返回一个响应包到srcIP，大量占用srcIP网络的资源</p>
<h4 id="dns-劫持">[4-1-2-4] DNS 劫持</h4>
<p>只要攻击者控制了域名系统中包含信道的任何一个关键节点，攻击者就可以将用户访问的域名绑定到恶意IP</p>
<h3 id="防护措施">[4-1-3] 防护措施</h3>
<h4 id="基于随机化">[4-1-3-1] 基于随机化</h4>
<p>事务ID随机化、域名大小写随机化、DNS Cookie(64位随机值)</p>
<h4 id="基于加密">[4-1-3-2] 基于加密</h4>
<p>DNS on TLS</p>
<p>DNS on
HTTPS：与HTTPS协议共享443端口来执行域名解析，防止被防火墙监控和拦截。</p>
<p>DNS on QUIC：基于UDP的协议，传输速度快但尚未普及</p>
<p>DNSSEC：在加密的同时使用签名机制</p>
<h2 id="web系统安全">[4-2] Web系统安全</h2>
<h3 id="web系统概述">[4-2-1] web系统概述</h3>
<p>web系统主要由客户端浏览器、服务器和中间交互的协议组成。</p>
<h3 id="主要攻击">[4-2-2] 主要攻击</h3>
<h4 id="客户端浏览器">[4-2-2-1] 客户端浏览器</h4>
<p>从客户端浏览器出发，我们首先考虑到的风险是前端三件套的风险：html是框架可以暂且不谈；
攻击者可以用css本身诱骗用户进行一些点击操作从而访问恶意网站，比如构建一个透明的样式图，
同时css解析出错也会导致一些问题，比如导致渲染错误，或者利用反斜杠等解析错误来注入某些恶意代码；
再就是javascript，攻击者可以注入恶意js代码，造成信息泄露、会话劫持、DoS等破坏。而除去前端三件套，
第三方插件也会带来隐私泄露和额外引入的安全漏洞，同时第三方插件也可能是恶意软件，泄露用户隐私或者诱骗用户访问恶意网站等。</p>
<h4 id="服务器">[4-2-2-2] 服务器</h4>
<p>从服务器端出发，主要风险可以来源于①持续对话②认证③缓存④分段数据传输</p>
<p>HTTP协议可以基于TCP协议，因此可以通过Connection:
keep-alive来实现持续对话，双方可以在这个持久连接上发送多个HTTP包，减少资源浪费。
但如果服务器发出的一个HTTP包中设置了多个Content-Length字段，web客户端可能会将该对话与多个不同对话对应起来，导致客户端显示混乱，
如果是代理服务器可能还会导致全局缓存错误，分发错误的缓存内容给其他用户。</p>
<p>HTTP协议支持分段数据传输，但过多的数据分段或者content-length设置错误可能会导致整数溢出或者浏览器显示混乱。</p>
<p>HTTP协议有一个认证字段，当认证字段被攻击者修改为明文认证而不是摘要认证时，攻击者就可以获得用户的明文敏感信息。</p>
<p>web缓存器也称为代理服务器，可以是距离用户较近的网关服务器，也可以是较大的CDN。缓存有可能会有非授权的数据访问，也可能保存用户的隐私数据，
当访问缓存参数失当可能也会导致浏览器处理异常，此外，缓存可能被污染。</p>
<h4 id="整个web系统">[4-2-2-3] 整个Web系统</h4>
<ol type="1">
<li>身份假冒攻击：HTTP最开始没有身份认证，攻击者可以伪装成正常的web服务器欺骗用户访问</li>
<li>网络流量监听和中间人：未授权的网络监听被称为被动攻击；主动攻击是指攻击者不仅未授权监听流量，还主动注入恶意流量</li>
</ol>
<h3 id="防护措施-1">[4-2-3] 防护措施</h3>
<h4 id="同源策略">[4-2-3-1] 同源策略</h4>
<h4 id="浏览器插件安全规则">[4-2-3-2] 浏览器插件安全规则</h4>
<p>①最小权限②数据保护③更新机制④使用安全的第三方库</p>
<h4 id="http-cookie安全策略">[4-2-3-3] HTTP Cookie安全策略</h4>
<p>通过设置不同的安全字段，保证cookie的安全。</p>
<p>Secure：cookie只通过HTTPS传输。HTTPOnly：拒绝JS代码访问cookie。SameSite：设置第三方站点何时可以在跨站点请求中携带cookie。
除了这些字段以外，还可以设置cookie过期时间，以及Domain和Path的限制。</p>
<h4 id="https">[4-2-3-4] HTTPS</h4>
<p>HTTPS是指 HTTP on
TLS，TLS可以分为握手协议、记录协议和告警协议。其中记录协议可以看作外壳协议，专门用来加解密数据包、验证、完整性检验和压缩解压缩的。
告警协议是指收到不正确的数据包时如何通知会话对方。下面着重描述记录协议。</p>
<p>首先，客户端发送ClientHello消息，其中包括客户端的安全能力。然后服务器发送Serverhello消息，其中包括服务器选择的各个参数。
然后服务器发送证书，该证书包含证书链的多个证书，包括服务器证书、签发该服务器证书的CA证书，注意该证书可能不包括根CA证书，因为浏览器可能预装了所有的根CA证书。
之后，服务器发送ServerKeyExchange消息，这条消息包含的是密钥协商所需要的额外数据，有些算法不需要就不用发，比如RSA。
之后，服务器发送certificateRequest消息，只有服务器要求客户端用公钥证书证明身份时才会发送这一条消息。
之后，服务器发送ServerHelloDone消息，告知客户端服务器这边的消息已经全部发送完毕。</p>
<p>如果收到CertificateRequest消息，客户端首先发送自己的证书给服务器。之后，为了完成密钥协商，客户端发送ClientKeyExchange消息。
之后，如果收到CertificateRequest消息，客户端还会发送CertificateVerify消息，发送一条包含客户端证书对应的私钥对握手消息的数字签名，
通过这条消息，服务器可以验证从握手开始到现在所有消息未被篡改并且没有被重放，因为握手消息中包含客户端和服务器生成的随机数，保证不被重放。
之后，客户端和服务器都向对方发送ChangeCipherSpec，表明自己已经完成密钥协商，之后所有消息都是加密的，这条消息是独立协议，并不属于握手子协议。
最后，双方发送Finished消息，这条消息是加密数据的第一条消息，包含了握手阶段所有消息的哈希值，主要意义在于验证握手的完整性，防止中间人攻击。</p>
<h4 id="cdn">[4-2-3-5] CDN</h4>
<p>CDN(Content Distribution
Network)内容分发网络是在不同地理位置设置代理服务器，
把web网站的内容分散到更接近用户的地方。</p>
<p>CDN的功能：①均衡网络负载②抗DoS攻击③保证网络更加稳定④降低网络延迟⑤过滤恶意web访问</p>
<h2 id="邮件系统">[4-3] 邮件系统</h2>
<h3 id="概述">[4-3-1] 概述</h3>
<p>用户通过MUA(Mail User
Agent)编写、发送、接收和管理邮件，当用户X通过MUA发送邮件给用户Y时，
邮件会先被提交给X的MSA(Mail Sending Agent),MSA再把邮件推送到X的MTA(Mail
Transition Agent)中，
X的MTA会将邮件发送给Y的MTA，Y的MTA再将邮件交给MDA(Mail Delivery
Agent)来投递给Y的MUA。</p>
<p>总结一下，每个用户都有自己的MUA，发件人邮件供应商会配置一个MSA一个MTA，收件人邮件供应商会配置一个MDA一个MTA。
另外，MTA往往是域名的邮件服务器。</p>
<h3 id="协议-3">[4-3-2] 协议</h3>
<h4 id="smtp">[4-3-2-1] SMTP</h4>
<p>对每一条命令，服务器都会回复相应信息</p>
<h4 id="pop3">[4-3-2-2] POP3</h4>
<p>离线邮件协议，对每一条命令服务器都会回复相应信息</p>
<h4 id="imap4">[4-3-2-3] IMAP4</h4>
<p>分布式存储存储邮件保证服务器与客户端的同步，在线操作和阅读服务器上的邮件</p>
<h3 id="常见攻击-2">[4-3-3] 常见攻击</h3>
<p>垃圾邮件、钓鱼邮件</p>
<blockquote>
<p>造成下列攻击的根本原因是：多协议之间的薄弱环节、多角色之间的薄弱环节和多服务之间的薄弱环节。</p>
</blockquote>
<h4 id="身份验证标识符不一致">[4-3-3-1] 身份验证标识符不一致</h4>
<blockquote>
<p>建议学习[4-3-4]后再来学习本节</p>
</blockquote>
<p>通常情况下，MUA显示的是FROM字段的内容。</p>
<ol type="1">
<li><p>空 Mail FROM
攻击：SPF检验的是一个服务器是否可以代替其服务器发送，当MAIL FROM为空时，
SPF协议要通过HELO字段来完成SPF验证，因此攻击者可以将HELO字段设置为恶意域名，然后FROM字段设置为正常邮箱，
这样受害者看到的发件人是FROM字段，HELO字段还能绕过SPF。</p></li>
<li><p>多FROM标头：攻击者可以在一个FROM写上自己的邮箱，然后在另一个FROM写上正常邮箱，最后用自己的签名完成DMARC验证。
这样不仅可以完成DMARC验证，还能让受害者看到FROM是正常邮箱。</p></li>
<li><p>多邮件地址攻击：攻击者在同一个FROM写入合法邮箱和自己的邮箱，同时用自己的签名签署邮件，可以达到与多FROM攻击一样的效果</p></li>
<li><p>不存在子域名攻击：当域名没有MX记录时，会使用域名的A记录。这意味着所有的A记录都是合法的域名，
又因为知名网站大多都会配置带有通配符的DNS
A记录，因此这种攻击较为广泛。这种邮件会被SPF打上none标签，
但往往不会被MTA邮件直接拒收。</p></li>
</ol>
<h4 id="身份验证结果注入攻击">[4-3-3-2] 身份验证结果注入攻击</h4>
<blockquote>
<p>建议学习[4-3-4]后再来学习本节</p>
</blockquote>
<p>DKIM注入是利用"b="字段将左括号认为是注释的原理来绕过，SPF注入是利用MAIL
FROM字段将单引号认为是注释的原理来绕过。</p>
<h4 id="dkim签名重放">[4-3-3-3] DKIM签名重放</h4>
<blockquote>
<p>建议学习[4-3-4]后再来学习本节</p>
</blockquote>
<p>DKIM不防重放，并且允许攻击者将额外的电子邮件标头甚至正文添加到被签名保护的消息中。</p>
<ol type="1">
<li><p>"h=":
DKIM对于邮件标头的签名是可选的，如果h=中包含的标头不完整，重放攻击者可以修改那些未受保护的标头而不会使DKIM签名失效。</p></li>
<li><p>如果不同组件以不同方式解析额外的邮件标头，攻击者可以通过在签名邮件中添加新标头来制造混淆。比如如果DKIM使用原subject，那MUA显示的就是恶意Subject。</p></li>
<li><p>"l=":
该标签允许向电子邮件列表中的不同地址发送不同内容，另外该标签允许攻击者在原始邮件正文添加新的而已内容而不会破坏签名。</p></li>
<li><p>利用转发功能：通常知名的邮件转发服务器不会被过滤</p></li>
</ol>
<h4 id="身份验证绕过攻击">[4-3-3-4] 身份验证绕过攻击</h4>
<blockquote>
<p>建议学习[4-3-4]后再来学习本节</p>
</blockquote>
<p>共享MTA场景：多个域名共享一个合法MTA，如果接收方只验证MTA
IP则会有安全风险</p>
<p>直接MTA场景：攻击者不通过发送方MTA，而是直接连接到接收方MTA来发送邮件，这样接收方MTA可能不会验证邮件。</p>
<p>转发MTA场景：攻击者利用受信任的转发MTA来发送。</p>
<h3 id="常见防护">[4-3-4] 常见防护</h3>
<h4 id="spf">[4-3-4-1] SPF</h4>
<p>通过SPF记录指明哪些服务器可以代表域名发送电子邮件到MSA，SPF记录以DNS
TXT记录的形式发布， 一个域名只能发布一条记录。举个例子：</p>
<p><code>v=spf1 ip4:192.168.1.0/24 mx include:spf.example.net ~all</code>这条记录的含义是：</p>
<p>ip4:192.168.1.0/24：允许来自 192.168.1.0/24
子网的IP地址发送邮件。</p>
<p>mx：允许来自 example.com 域的MX记录指向的IP地址发送邮件。</p>
<p>include:spf.example.net：允许 spf.example.net
域的SPF记录中的IP地址发送邮件。</p>
<p>~all：如果邮件来源不符合这些规则，则标记为软失败（通常会被标记为垃圾邮件）。</p>
<p>当MUA接收到一封邮件时，SPF协议会提取MAIL
FROM字段中的域名，通过DNS查询来确认是否匹配。</p>
<h4 id="dkim">[4-3-4-2] DKIM</h4>
<p>DKIM协议会在邮件的标头添加一个数字签名，这个签名是这样计算的：</p>
<p>首先计算邮件正文的哈希值、选定邮件标头的哈希值以及整个邮件的哈希值。然后发件人的MTA会对哈希值进行签名，
生成DKIM-Signature。</p>
<h4 id="dmarc">[4-3-4-3] DMARC</h4>
<p>引入多认证标识符对齐机制，将FROM命令里的身份信息与SPF和DKIM的认证关联起来</p>
<h4 id="共享直接转发-mta-场景">[4-3-4-4] 共享/直接/转发 MTA 场景</h4>
<h1 id="防御技术">[5] 防御技术</h1>
<h2 id="防火墙">[5-1] 防火墙</h2>
<h3 id="概述-1">[5-1-1] 概述</h3>
<p>功能：①包过滤、入侵检测、监控和日志②负载均衡、应用程序代理服务器、数据缓存③网络地址转换</p>
<p>缺陷：①无法对抗旁路攻击②不完全透明，可能会带来延迟③不防范端到端加密通信④有时会拦截有用的服务</p>
<p>内部防火墙的部署：①内部防火墙提供更严格的过滤能力②在DMZ之间提供双向保护③多个防火墙保护内部网络的不同区域</p>
<h3 id="分类">[5-1-2] 分类</h3>
<blockquote>
<p>优缺点大一统:①应用层？②开销③配置难易④日志</p>
</blockquote>
<h4 id="包过滤防火墙">[5-1-2-1] 包过滤防火墙</h4>
<p>拦截依据：协议类型/IP地址/端口/流向的接口/IP选项/TCP选项/其他协议选项/流动方向</p>
<p>优点：①便于配置，检查效率高②对于用户是透明的</p>
<p>缺点：①粒度过粗②无法防御针对特定app漏洞的攻击③无法防御IP伪造攻击④日志信息有限</p>
<h4 id="状态检查防火墙">[5-1-2-2] 状态检查防火墙</h4>
<p>拦截依据：TCP等协议建立的状态+包过滤防火墙的拦截依据</p>
<p>优点：①建立连接跟踪，跟踪网络连接的状态，以便返回流量能通过防火墙②会话感知过滤，可以根据会话信息进行更细粒度的过滤③减少虚假报警，不会将合法的响应流量误以为是未经授权的入侵
-&gt; 其实就是粒度更细了、更适合TCP了、更精确了</p>
<p>缺点：①配置复杂②资源开销大③无法防御针对特定app漏洞的攻击④UDP效果较差</p>
<h4 id="应用层防火墙">[5-1-2-3] 应用层防火墙</h4>
<p>拦截依据：数据包头+数据包内容（模式匹配+正则匹配+协议分析）</p>
<p>优点：①过滤规则容易配置和测试②进行内容过滤、复杂访问控制、精细注册和审核等
③防御针对应用层的攻击④提供详细的日志和审计功能</p>
<p>缺点：①性能开销大②特定协议特定检查机制③可能引入新漏洞④配置复杂⑤误报误阻会封堵正常业务流程，需要额外测试和配置。</p>
<p>WAF：Web Application
Firewall，基于特征、行为和语义分析来检测恶意行为，可以作为独立硬件或虚拟设备部署在web前端，
可以通过云端waf在云中保护web应用，可以作为浏览器插件或应用，也能以反向代理模式部署</p>
<h4 id="其他类型">[5-1-2-4] 其他类型</h4>
<p>下一代防火墙</p>
<p>网络分割防火墙</p>
<p>云防火墙</p>
<h2 id="idsintrusion-detection-system">[5-2] IDS(Intrusion Detection
System)</h2>
<h3 id="p2dr模型">[5-2-1] <span
class="math inline">\(P^2DR模型\)</span></h3>
<p>策略：模型核心，其他方面围绕策略展开</p>
<p>防护：阻止侵入系统或延长侵入系统的时间，为检测和反应提供时间。主要包括：安全规章制定（在安全策略的基础上指定安全细则）、
系统安全配置（安装各种必要补丁，进行仔细配置）、采用安全措施（安装防火墙、IDS、VPN软件或设备）</p>
<p>检测：异常监视（发现系统异常行为，如异常登录）+模式发现（对已知的攻击模式进行匹配）</p>
<p>响应：报告（让管理员知道风险）+记录（记录入侵细节与系统反应）+反应（进行处理并防止进一步入侵，比如修复漏洞+增加防护措施）+
恢复（清楚入侵影响，让系统恢复正常）</p>
<h3 id="分类-1">[5-2-2] 分类</h3>
<h4 id="hids">[5-2-2-1] HIDS</h4>
<p>HIDS是基于主机的IDS，信息一般来源于操作系统的日志等。</p>
<p>优点：①检测NIDS无法察觉的攻击②HIDS的信息源不会被网络传输中的加密干扰③不受网络环境变化的影响④当HIDS运行在OS的审计线上时，可以检测特洛伊木马等针对软件完整性破坏的攻击</p>
<p>缺点：①必须为每个受监控的主机配置HIDS②HIDS可能被攻击禁用③性能损耗</p>
<h4 id="nids">[5-2-2-2] NIDS</h4>
<p>通常由一组放置在网络各个点的单一用途传感器组成，这些单元监控流量分析问题并向中央报告问题，他们用途单一更难被破坏，并且通常被设置为隐形的，难以被攻击者发现</p>
<p>优点：①使用被动接口捕获网络数据包②可扩展性好③OS独立的④提供更好的DoS防御</p>
<p>缺点：①如果流量被加密则无法检测②在现代交换网络上，NIDS变得困难③无法处理高速网络</p>
<h3 id="ids技术">[5-2-3] IDS技术</h3>
<h4 id="基于误用的入侵检测">[5-2-3-1] 基于误用的入侵检测</h4>
<p>将传入的网络流量特征与特征数据库中已经存在的先前入侵的特征进行匹配，分为静态签名检测和动态监测。
静态签名检测就是直接与数据库中的模式进行匹配，动态检测还关注行为的时间序列和状态变化。</p>
<h4 id="基于异常的检测">[5-2-3-2] 基于异常的检测</h4>
<p>根据系统行为或资源使用状态的正常程度来进行判断。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://heygap.github.io/en">HeyGap</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://heygap.github.io/en/posts/27202.html">http://heygap.github.io/en/posts/27202.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/en/tags/web/">web</a></div><div class="post-share"><div class="social-share" data-image="/en/img/cover10.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/en/posts/27164.html" title="Web - DNS Poisoning"><img class="cover" src="/en/img/cover5.jpg" onerror="onerror=null;src='/en/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Web - DNS Poisoning</div></div><div class="info-2"><div class="info-item-1"> 记录一下这学期最难的一次网络安全实验，恰逢期末，之后回来填坑   [1] 虚拟机 virtualbox 配置 如何便捷地 copy 虚拟机(直到写这篇 wp 才想起来可以 STFW，我最开始用的 vdi...还需要用 VBoxManage internalcommands sethduuid /path/to/your.vdi 重新解绑uuid) 由于此次打开的虚拟机较多，所以每个虚拟机内存只分配2GB即可 之后，把双向粘贴板和双向拖放打开，再把“显示 -&gt; 屏幕”中扩展特性的“启用3D加速”打开（要不然会花屏） 之后再在“网络 -&gt; 网卡1”栏目中，将连接方式改为“内部网络”，然后名称改为intnet0/1/2（这里根据自己需求来写，比如我配的权威DNS就是intnet1） 最后进入虚拟机中，在上方栏目的“设备”中点击安装增强功能，它会自动打开一个文件夹，在终端里运行autorun.sh即可自动安装，之后重启虚拟机就可以启用双向粘贴板和拖放了 [2] 虚拟机网络配置 IP...</div></div></div></a><a class="pagination-related" href="/en/posts/9333.html" title="2024年终总结"><img class="cover" src="/en/img/cover7.jpg" onerror="onerror=null;src='/en/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">2024年终总结</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/en/img/avatar.jpg" onerror="this.onerror=null;this.src='/en/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">HeyGap</div><div class="author-info-description">An undergraduate student of Cybersecurity at SDU.</div><div class="site-data"><a href="/en/archives/"><div class="headline">Articles</div><div class="length-num">31</div></a><a href="/en/tags/"><div class="headline">Tags</div><div class="length-num">24</div></a><a href="/en/categories/"><div class="headline">Categories</div><div class="length-num">11</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/HeyGap"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/HeyGap" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:2310769056@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">欢迎来到我的博客，主要用来记录一些学习笔记和生活感悟。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E5%AE%B9%E6%98%93%E9%81%97%E5%BF%98%E7%9A%84%E7%82%B9"><span class="toc-text">[0] 比较容易遗忘的点：</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82%E5%B1%80%E5%9F%9F%E7%BD%91"><span class="toc-text">[1] 数据链路层(局域网)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%8F%E8%AE%AE"><span class="toc-text">[1-1] 协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#arp"><span class="toc-text">[1-1-1] ARP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dhcp"><span class="toc-text">[1-1-2] DHCP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E6%94%BB%E5%87%BB"><span class="toc-text">[1-2] 常见攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#arp-1"><span class="toc-text">[1-2-1] ARP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#arp-dosmac%E5%9C%B0%E5%9D%80%E6%B4%AA%E6%B3%9B"><span class="toc-text">[1-2-1-1] ARP DoS(MAC地址洪泛)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#arp-%E7%BC%93%E5%AD%98%E6%8A%95%E6%AF%92"><span class="toc-text">[1-2-1-2] ARP 缓存投毒</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dhcp-1"><span class="toc-text">[1-2-2] DHCP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#dhcp-dos"><span class="toc-text">[1-2-2-1] DHCP DoS</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%B1%82"><span class="toc-text">[2] 网络层</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%8F%E8%AE%AE-1"><span class="toc-text">[2-1] 协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ip"><span class="toc-text">[2-1-1] IP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#icmp"><span class="toc-text">[2-1-2] ICMP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E6%94%BB%E5%87%BB-1"><span class="toc-text">[2-2] 常见攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ip-1"><span class="toc-text">[2-2-1] IP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ping-of-death"><span class="toc-text">[2-2-1-1] Ping of Death</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#icmp-1"><span class="toc-text">[2-2-2] ICMP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#smurf%E6%94%BB%E5%87%BBicmp-dos"><span class="toc-text">[2-2-2-1] Smurf攻击(ICMP DoS)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#icmp-redirecticmp-poisoning"><span class="toc-text">[2-2-2-2] ICMP Redirect(ICMP
Poisoning)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%98%B2%E6%8A%A4%E6%8E%AA%E6%96%BD-ipsec"><span class="toc-text">[2-3] 防护措施-IPSec</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6"><span class="toc-text">[2-3-1] 组件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%86%E9%92%A5%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F"><span class="toc-text">[2-3-1-1] 密钥管理系统</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E8%BE%93%E6%A8%A1%E5%BC%8F"><span class="toc-text">[2-3-2] 传输模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#esp-tun-mode-%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="toc-text">[2-3-3] ESP TUN Mode 工作流程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%90%E8%BE%93%E5%B1%82"><span class="toc-text">[3] 运输层</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%8F%E8%AE%AE-2"><span class="toc-text">[3-1] 协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#udp"><span class="toc-text">[3-1-1] UDP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tcp"><span class="toc-text">[3-1-2] TCP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E6%94%BB%E5%87%BB%E6%96%B9%E5%BC%8F"><span class="toc-text">[3-2] 主要攻击方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F%E4%B8%8E%E8%B5%84%E4%BA%A7%E6%8E%A2%E6%9F%A5"><span class="toc-text">[3-2-1] 端口扫描与资产探查</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9A%90%E8%94%BD%E6%89%AB%E6%8F%8F"><span class="toc-text">[3-2-1-1] 隐蔽扫描</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tcp-syn-floodtcp-dos"><span class="toc-text">[3-2-2] TCP SYN Flood(TCP DoS)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tcp-%E4%BC%9A%E8%AF%9D%E5%8A%AB%E6%8C%81%E9%87%8D%E7%BD%AE"><span class="toc-text">[3-2-3] TCP 会话劫持&#x2F;重置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tcp%E5%8F%8D%E5%B0%84%E6%94%BE%E5%A4%A7%E6%94%BB%E5%87%BB"><span class="toc-text">[3-2-4] TCP反射放大攻击</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%98%B2%E5%BE%A1%E6%8E%AA%E6%96%BD"><span class="toc-text">[3-3] 防御措施</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%92%88%E5%AF%B9syn-flood"><span class="toc-text">[3-3-1] 针对SYN Flood</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%B1%82"><span class="toc-text">[4] 应用层</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%9F%E5%90%8D%E7%B3%BB%E7%BB%9F"><span class="toc-text">[4-1] 域名系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%9F%E5%90%8D%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0"><span class="toc-text">[4-1-1] 域名系统概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E6%94%BB%E5%87%BB%E6%96%B9%E5%BC%8F-1"><span class="toc-text">[4-1-2] 主要攻击方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#poisoning"><span class="toc-text">[4-1-2-1] Poisoning</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5dns-%E9%87%8D%E7%BB%91%E5%AE%9A%E6%94%BB%E5%87%BB"><span class="toc-text">[4-1-2-2] 绕过同源策略(DNS
重绑定攻击)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dns-%E5%8F%8D%E5%B0%84%E6%94%BE%E5%A4%A7"><span class="toc-text">[4-1-2-3] DNS 反射放大</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dns-%E5%8A%AB%E6%8C%81"><span class="toc-text">[4-1-2-4] DNS 劫持</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E6%8A%A4%E6%8E%AA%E6%96%BD"><span class="toc-text">[4-1-3] 防护措施</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E9%9A%8F%E6%9C%BA%E5%8C%96"><span class="toc-text">[4-1-3-1] 基于随机化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E5%8A%A0%E5%AF%86"><span class="toc-text">[4-1-3-2] 基于加密</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8"><span class="toc-text">[4-2] Web系统安全</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#web%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0"><span class="toc-text">[4-2-1] web系统概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E6%94%BB%E5%87%BB"><span class="toc-text">[4-2-2] 主要攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B5%8F%E8%A7%88%E5%99%A8"><span class="toc-text">[4-2-2-1] 客户端浏览器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-text">[4-2-2-2] 服务器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B4%E4%B8%AAweb%E7%B3%BB%E7%BB%9F"><span class="toc-text">[4-2-2-3] 整个Web系统</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E6%8A%A4%E6%8E%AA%E6%96%BD-1"><span class="toc-text">[4-2-3] 防护措施</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5"><span class="toc-text">[4-2-3-1] 同源策略</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8F%92%E4%BB%B6%E5%AE%89%E5%85%A8%E8%A7%84%E5%88%99"><span class="toc-text">[4-2-3-2] 浏览器插件安全规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#http-cookie%E5%AE%89%E5%85%A8%E7%AD%96%E7%95%A5"><span class="toc-text">[4-2-3-3] HTTP Cookie安全策略</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#https"><span class="toc-text">[4-2-3-4] HTTPS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#cdn"><span class="toc-text">[4-2-3-5] CDN</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-text">[4-3] 邮件系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-text">[4-3-1] 概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%8F%E8%AE%AE-3"><span class="toc-text">[4-3-2] 协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#smtp"><span class="toc-text">[4-3-2-1] SMTP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pop3"><span class="toc-text">[4-3-2-2] POP3</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#imap4"><span class="toc-text">[4-3-2-3] IMAP4</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E6%94%BB%E5%87%BB-2"><span class="toc-text">[4-3-3] 常见攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E6%A0%87%E8%AF%86%E7%AC%A6%E4%B8%8D%E4%B8%80%E8%87%B4"><span class="toc-text">[4-3-3-1] 身份验证标识符不一致</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%93%E6%9E%9C%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB"><span class="toc-text">[4-3-3-2] 身份验证结果注入攻击</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dkim%E7%AD%BE%E5%90%8D%E9%87%8D%E6%94%BE"><span class="toc-text">[4-3-3-3] DKIM签名重放</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87%E6%94%BB%E5%87%BB"><span class="toc-text">[4-3-3-4] 身份验证绕过攻击</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E9%98%B2%E6%8A%A4"><span class="toc-text">[4-3-4] 常见防护</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#spf"><span class="toc-text">[4-3-4-1] SPF</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dkim"><span class="toc-text">[4-3-4-2] DKIM</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dmarc"><span class="toc-text">[4-3-4-3] DMARC</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B1%E4%BA%AB%E7%9B%B4%E6%8E%A5%E8%BD%AC%E5%8F%91-mta-%E5%9C%BA%E6%99%AF"><span class="toc-text">[4-3-4-4] 共享&#x2F;直接&#x2F;转发 MTA 场景</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%98%B2%E5%BE%A1%E6%8A%80%E6%9C%AF"><span class="toc-text">[5] 防御技术</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%98%B2%E7%81%AB%E5%A2%99"><span class="toc-text">[5-1] 防火墙</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-1"><span class="toc-text">[5-1-1] 概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%B1%BB"><span class="toc-text">[5-1-2] 分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%85%E8%BF%87%E6%BB%A4%E9%98%B2%E7%81%AB%E5%A2%99"><span class="toc-text">[5-1-2-1] 包过滤防火墙</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%8A%B6%E6%80%81%E6%A3%80%E6%9F%A5%E9%98%B2%E7%81%AB%E5%A2%99"><span class="toc-text">[5-1-2-2] 状态检查防火墙</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%B1%82%E9%98%B2%E7%81%AB%E5%A2%99"><span class="toc-text">[5-1-2-3] 应用层防火墙</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E7%B1%BB%E5%9E%8B"><span class="toc-text">[5-1-2-4] 其他类型</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#idsintrusion-detection-system"><span class="toc-text">[5-2] IDS(Intrusion Detection
System)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#p2dr%E6%A8%A1%E5%9E%8B"><span class="toc-text">[5-2-1] \(P^2DR模型\)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%B1%BB-1"><span class="toc-text">[5-2-2] 分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#hids"><span class="toc-text">[5-2-2-1] HIDS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#nids"><span class="toc-text">[5-2-2-2] NIDS</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ids%E6%8A%80%E6%9C%AF"><span class="toc-text">[5-2-3] IDS技术</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E8%AF%AF%E7%94%A8%E7%9A%84%E5%85%A5%E4%BE%B5%E6%A3%80%E6%B5%8B"><span class="toc-text">[5-2-3-1] 基于误用的入侵检测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E5%BC%82%E5%B8%B8%E7%9A%84%E6%A3%80%E6%B5%8B"><span class="toc-text">[5-2-3-2] 基于异常的检测</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/en/posts/34368.html" title="fuzz - 原理学习"><img src="/en/img/cover3.jpg" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="fuzz - 原理学习"/></a><div class="content"><a class="title" href="/en/posts/34368.html" title="fuzz - 原理学习">fuzz - 原理学习</a><time datetime="2025-02-14T05:46:00.000Z" title="Created 2025-02-14 13:02:00">2025-02-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/posts/18184.html" title="blockchain - openzeppelin 源码阅读"><img src="/en/img/cover5.jpg" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="blockchain - openzeppelin 源码阅读"/></a><div class="content"><a class="title" href="/en/posts/18184.html" title="blockchain - openzeppelin 源码阅读">blockchain - openzeppelin 源码阅读</a><time datetime="2025-02-05T10:15:00.000Z" title="Created 2025-02-05 18:02:00">2025-02-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/posts/13129.html" title="blockchain - Uniswap V2"><img src="/en/img/cover6.jpg" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="blockchain - Uniswap V2"/></a><div class="content"><a class="title" href="/en/posts/13129.html" title="blockchain - Uniswap V2">blockchain - Uniswap V2</a><time datetime="2025-02-04T06:09:00.000Z" title="Created 2025-02-04 14:02:00">2025-02-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/posts/38292.html" title="blockchain - All Your Tokens are Belong to Us Demystifying Address Verification Vulnerabilities in Solidity Smart Contracts论文阅读笔记"><img src="/en/img/cover2.jpg" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="blockchain - All Your Tokens are Belong to Us Demystifying Address Verification Vulnerabilities in Solidity Smart Contracts论文阅读笔记"/></a><div class="content"><a class="title" href="/en/posts/38292.html" title="blockchain - All Your Tokens are Belong to Us Demystifying Address Verification Vulnerabilities in Solidity Smart Contracts论文阅读笔记">blockchain - All Your Tokens are Belong to Us Demystifying Address Verification Vulnerabilities in Solidity Smart Contracts论文阅读笔记</a><time datetime="2025-01-13T12:01:00.000Z" title="Created 2025-01-13 20:01:00">2025-01-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/posts/9333.html" title="2024年终总结"><img src="/en/img/cover7.jpg" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="2024年终总结"/></a><div class="content"><a class="title" href="/en/posts/9333.html" title="2024年终总结">2024年终总结</a><time datetime="2025-01-12T04:55:00.000Z" title="Created 2025-01-12 12:01:00">2025-01-12</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/cover10.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2025 By HeyGap</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Toggle Between Traditional and Simplified Chinese">EN</button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/en/js/utils.js"></script><script src="/en/js/main.js"></script><script src="/en/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"></div><script data-pjax src="/en/self/btf.js"></script><script data-pjax src="/en/self/ch_en.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/en/js/search/local-search.js"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('已挂载butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><!-- hexo injector body_end end --></body></html>